[0m11:18:44.203726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c9b98590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c9b9b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c9bccfd0>]}


============================== 11:18:44.212342 | 0dcc7d8b-49a3-40ea-a790-2c0a4ef3d5ee ==============================
[0m11:18:44.212342 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:18:44.218481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/ovp/.dbt', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:18:44.556468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dcc7d8b-49a3-40ea-a790-2c0a4ef3d5ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c995a2d0>]}
[0m11:18:44.578790 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:18:44.595440 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:18:44.614062 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5212138, "process_user_time": 3.551052, "process_kernel_time": 0.260811, "process_mem_max_rss": "104232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:18:44.619184 [debug] [MainThread]: Command `cli deps` succeeded at 11:18:44.618860 after 0.53 seconds
[0m11:18:44.623019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45ca6252d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c9bbf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c9d639d0>]}
[0m11:18:44.627085 [debug] [MainThread]: Flushing usage events
[0m11:21:53.332620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f854c8b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f86035890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8550b650>]}


============================== 11:21:53.358179 | 76957087-e1a3-4a33-9434-04d32f5a9301 ==============================
[0m11:21:53.358179 [info ] [MainThread]: Running with dbt=1.7.8
[0m11:21:53.374708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ovp/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:21:54.214336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76957087-e1a3-4a33-9434-04d32f5a9301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f85341c50>]}
[0m11:21:54.279810 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:21:54.442923 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:21:54.514232 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.4048098, "process_user_time": 2.856043, "process_kernel_time": 0.18831, "process_mem_max_rss": "103920", "process_in_blocks": "592", "process_out_blocks": "0"}
[0m11:21:54.542091 [debug] [MainThread]: Command `cli deps` succeeded at 11:21:54.541606 after 1.43 seconds
[0m11:21:54.574979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f85a90f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f85ab73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f85aa6b50>]}
[0m11:21:54.598552 [debug] [MainThread]: Flushing usage events
[0m13:57:22.275451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c16b8b210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c16b7c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c165baf10>]}


============================== 13:57:22.299155 | 69c64cce-ed42-4a8d-98d2-ec4741a9cac7 ==============================
[0m13:57:22.299155 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:57:22.311300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ovp/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:23.105554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69c64cce-ed42-4a8d-98d2-ec4741a9cac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c16497e10>]}
[0m13:57:23.165852 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:57:23.316451 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:57:23.381630 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.332481, "process_user_time": 3.070282, "process_kernel_time": 0.164296, "process_mem_max_rss": "104200", "process_in_blocks": "304", "process_out_blocks": "0"}
[0m13:57:23.402922 [debug] [MainThread]: Command `cli deps` succeeded at 13:57:23.402111 after 1.35 seconds
[0m13:57:23.421863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c16ba0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c165bbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c16bb14d0>]}
[0m13:57:23.437122 [debug] [MainThread]: Flushing usage events
[0m09:06:16.279832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9134f43510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9134f0ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9134c34e10>]}


============================== 09:06:16.306676 | 30bad0f3-76c1-42fa-ab6c-eab06ae5ef67 ==============================
[0m09:06:16.306676 [info ] [MainThread]: Running with dbt=1.7.8
[0m09:06:16.316161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ovp/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m09:06:16.945096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30bad0f3-76c1-42fa-ab6c-eab06ae5ef67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9134853690>]}
[0m09:06:16.968014 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:06:17.012604 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:06:17.038869 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.5290118, "process_user_time": 17.009296, "process_kernel_time": 2.263283, "process_mem_max_rss": "102816", "process_in_blocks": "872", "process_out_blocks": "0"}
[0m09:06:17.044845 [debug] [MainThread]: Command `cli deps` succeeded at 09:06:17.044443 after 1.54 seconds
[0m09:06:17.049189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91349a9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9135073c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91390d8850>]}
[0m09:06:17.054603 [debug] [MainThread]: Flushing usage events
[0m14:21:14.057820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7202e56b7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7202e5cd85d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7202e5a60090>]}


============================== 14:21:14.063237 | 514c0fd2-b451-425e-82cc-95952f84a2ab ==============================
[0m14:21:14.063237 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:21:14.065419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ovp/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:21:14.262957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '514c0fd2-b451-425e-82cc-95952f84a2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7202e56be390>]}
[0m14:21:14.274015 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:21:14.298749 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:21:14.308533 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.32686853, "process_user_time": 2.058905, "process_kernel_time": 0.207889, "process_mem_max_rss": "103780", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:21:14.312383 [debug] [MainThread]: Command `cli deps` succeeded at 14:21:14.312161 after 0.33 seconds
[0m14:21:14.314881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7202e5c64a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7202e567a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7202e591eed0>]}
[0m14:21:14.317875 [debug] [MainThread]: Flushing usage events
[0m08:16:16.940332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c87dcef3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c87e28ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c87e298b10>]}


============================== 08:16:16.943821 | 8a7d1177-3744-4b22-be39-0aeba74f3481 ==============================
[0m08:16:16.943821 [info ] [MainThread]: Running with dbt=1.7.8
[0m08:16:16.946816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/ovp/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:16:17.092740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a7d1177-3744-4b22-be39-0aeba74f3481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c87e298c50>]}
[0m08:16:17.099575 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:16:17.118643 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:16:17.128441 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.24764086, "process_user_time": 2.167669, "process_kernel_time": 0.185684, "process_mem_max_rss": "103232", "process_in_blocks": "872", "process_out_blocks": "0"}
[0m08:16:17.130015 [debug] [MainThread]: Command `cli deps` succeeded at 08:16:17.129868 after 0.25 seconds
[0m08:16:17.131729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c87e14acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c87dd25d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c87dca6210>]}
[0m08:16:17.134066 [debug] [MainThread]: Flushing usage events
[0m08:16:27.148451 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m15:06:32.939444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761944b78290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761944b6ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761944bdc050>]}


============================== 15:06:32.958395 | 0f3ab73c-1d10-4014-b32e-d1dc52cec2bb ==============================
[0m15:06:32.958395 [info ] [MainThread]: Running with dbt=1.7.8
[0m15:06:32.973375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'profiles_dir': '/home/ovp/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:33.790895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f3ab73c-1d10-4014-b32e-d1dc52cec2bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7619445c4c50>]}
[0m15:06:33.881728 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:06:34.023383 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:06:34.092347 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3754224, "process_user_time": 3.13436, "process_kernel_time": 0.276561, "process_mem_max_rss": "103324", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:06:34.105556 [debug] [MainThread]: Command `cli deps` succeeded at 15:06:34.104786 after 1.39 seconds
[0m15:06:34.116511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76194459d890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761944b59c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76194525a790>]}
[0m15:06:34.124099 [debug] [MainThread]: Flushing usage events
[0m08:28:11.711129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a2876cccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a28773fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a28766f790>]}


============================== 08:28:11.719335 | ff2f56b4-63f9-49e0-ad58-bde82530d026 ==============================
[0m08:28:11.719335 [info ] [MainThread]: Running with dbt=1.7.8
[0m08:28:11.722712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ovp/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:28:12.053841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff2f56b4-63f9-49e0-ad58-bde82530d026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a287578990>]}
[0m08:28:12.078605 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:28:12.121415 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:28:12.136431 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5450498, "process_user_time": 4.074362, "process_kernel_time": 0.3574, "process_mem_max_rss": "103356", "process_in_blocks": "536", "process_out_blocks": "0"}
[0m08:28:12.139816 [debug] [MainThread]: Command `cli deps` succeeded at 08:28:12.139488 after 0.55 seconds
[0m08:28:12.142984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a28711e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a287312b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79a2870e9f10>]}
[0m08:28:12.146017 [debug] [MainThread]: Flushing usage events
[0m20:01:48.293690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a858a5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a858a6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a858c3610>]}


============================== 20:01:48.300470 | fba7b39e-223e-4d0a-811a-2f0568acdef3 ==============================
[0m20:01:48.300470 [info ] [MainThread]: Running with dbt=1.7.8
[0m20:01:48.305167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/ovp/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m20:01:48.589120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fba7b39e-223e-4d0a-811a-2f0568acdef3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a859282d0>]}
[0m20:01:48.603739 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:01:48.632550 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:01:48.650062 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.45712066, "process_user_time": 1.976139, "process_kernel_time": 0.227096, "process_mem_max_rss": "103672", "process_in_blocks": "640", "process_out_blocks": "0"}
[0m20:01:48.654337 [debug] [MainThread]: Command `cli deps` succeeded at 20:01:48.654061 after 0.46 seconds
[0m20:01:48.658828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a858a7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a85e92810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712a860837d0>]}
[0m20:01:48.662203 [debug] [MainThread]: Flushing usage events
[0m20:19:22.618555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2f1ca890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2f7c0090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2f4df750>]}


============================== 20:19:22.623346 | 981681ea-b46b-406d-80ba-0d4fb3bace3a ==============================
[0m20:19:22.623346 [info ] [MainThread]: Running with dbt=1.7.8
[0m20:19:22.625735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'profiles_dir': '/home/ovp/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:19:22.788212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '981681ea-b46b-406d-80ba-0d4fb3bace3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2f092b10>]}
[0m20:19:22.796187 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:19:22.816330 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:19:22.825628 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2723157, "process_user_time": 1.848363, "process_kernel_time": 0.207144, "process_mem_max_rss": "103948", "process_in_blocks": "872", "process_out_blocks": "0"}
[0m20:19:22.827888 [debug] [MainThread]: Command `cli deps` succeeded at 20:19:22.827696 after 0.27 seconds
[0m20:19:22.830126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2f6354d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2f1be090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734d2f793950>]}
[0m20:19:22.832972 [debug] [MainThread]: Flushing usage events
[0m12:35:53.278138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f250b67390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f250b67290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f250b66090>]}


============================== 12:35:53.296220 | 7c627b54-ca8c-41f4-aeb7-cb36e8cace2c ==============================
[0m12:35:53.296220 [info ] [MainThread]: Running with dbt=1.7.8
[0m12:35:53.306441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ovp/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m12:35:54.054162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c627b54-ca8c-41f4-aeb7-cb36e8cace2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f250835690>]}
[0m12:35:54.099105 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:35:54.187305 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:35:54.230388 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.099393, "process_user_time": 3.06611, "process_kernel_time": 0.316217, "process_mem_max_rss": "103576", "process_in_blocks": "200", "process_out_blocks": "0"}
[0m12:35:54.242392 [debug] [MainThread]: Command `cli deps` succeeded at 12:35:54.241502 after 1.11 seconds
[0m12:35:54.254300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f250b12f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f250b12790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f250587fd0>]}
[0m12:35:54.267267 [debug] [MainThread]: Flushing usage events
[0m12:36:04.301199 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m16:55:43.361150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737262e67730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737261155630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737261157100>]}


============================== 16:55:43.374982 | cf111d2a-dc07-4d77-baf5-54a62beb544a ==============================
[0m16:55:43.374982 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:55:43.378830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:55:43.385851 [info ] [MainThread]: dbt version: 1.7.4
[0m16:55:43.389216 [info ] [MainThread]: python version: 3.10.7
[0m16:55:43.391679 [info ] [MainThread]: python path: /usr/local/bin/python
[0m16:55:43.394357 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m16:55:43.640885 [info ] [MainThread]: Using profiles dir at /usr/app/profiles
[0m16:55:43.642933 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles/profiles.yml
[0m16:55:43.644252 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m16:55:43.645820 [info ] [MainThread]: adapter type: postgres
[0m16:55:43.647335 [info ] [MainThread]: adapter version: 1.7.4
[0m16:55:43.734771 [info ] [MainThread]: Configuration:
[0m16:55:43.736397 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:55:43.738040 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:55:43.739826 [info ] [MainThread]: Required dependencies:
[0m16:55:43.741263 [debug] [MainThread]: Executing "git --help"
[0m16:55:43.769319 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:55:43.771639 [debug] [MainThread]: STDERR: "b''"
[0m16:55:43.773423 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:55:43.775277 [info ] [MainThread]: Connection:
[0m16:55:43.776689 [info ] [MainThread]:   host: postgres
[0m16:55:43.778178 [info ] [MainThread]:   port: 5432
[0m16:55:43.779499 [info ] [MainThread]:   user: admin
[0m16:55:43.781093 [info ] [MainThread]:   database: postgres_metabase1
[0m16:55:43.782506 [info ] [MainThread]:   schema: raw
[0m16:55:43.783743 [info ] [MainThread]:   connect_timeout: 10
[0m16:55:43.784981 [info ] [MainThread]:   role: None
[0m16:55:43.786727 [info ] [MainThread]:   search_path: None
[0m16:55:43.788015 [info ] [MainThread]:   keepalives_idle: 0
[0m16:55:43.789369 [info ] [MainThread]:   sslmode: None
[0m16:55:43.791755 [info ] [MainThread]:   sslcert: None
[0m16:55:43.793783 [info ] [MainThread]:   sslkey: None
[0m16:55:43.795121 [info ] [MainThread]:   sslrootcert: None
[0m16:55:43.796891 [info ] [MainThread]:   application_name: dbt
[0m16:55:43.799100 [info ] [MainThread]:   retries: 1
[0m16:55:43.801248 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m16:55:43.803573 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:55:43.805562 [debug] [MainThread]: Using postgres connection "debug"
[0m16:55:43.807129 [debug] [MainThread]: On debug: select 1 as id
[0m16:55:43.808430 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:43.832883 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.18.0.2), port 5432 failed: FATAL:  database "postgres_metabase1" does not exist

[0m16:55:43.839598 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m16:55:43.841055 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m16:55:43.842607 [debug] [MainThread]: On debug: No close available on handle
[0m16:55:43.844379 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m16:55:43.846054 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:55:43.847764 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "postgres" (172.18.0.2), port 5432 failed: FATAL:  database "postgres_metabase1" does not exist
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m16:55:43.850945 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.6021169, "process_user_time": 2.324992, "process_kernel_time": 0.870815, "process_mem_max_rss": "95992", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m16:55:43.852998 [debug] [MainThread]: Command `dbt debug` failed at 16:55:43.852740 after 0.60 seconds
[0m16:55:43.854898 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:55:43.856396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737262e67730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73726113c430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737261156bf0>]}
[0m16:55:43.858005 [debug] [MainThread]: Flushing usage events
[0m17:00:35.831945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c0493ff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c0476fab30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c0476faad0>]}


============================== 17:00:35.863857 | 1a034cc2-fd3f-42c4-be51-98c6024402a1 ==============================
[0m17:00:35.863857 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:00:35.868811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:00:35.891968 [info ] [MainThread]: dbt version: 1.7.4
[0m17:00:35.903395 [info ] [MainThread]: python version: 3.10.7
[0m17:00:35.909031 [info ] [MainThread]: python path: /usr/local/bin/python
[0m17:00:35.915662 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m17:00:35.968173 [error] [MainThread]: Encountered an error:
Runtime Error
  Syntax error near line 7
  ------------------------------
  4  |     dev:
  5  |       type: postgres
  6  |       host: postgres
  7  |       user: {{POSTGRES_USER}}
  8  |       password: {{POSTGRES_PASSWORD}}
  9  |       port: 5432
  10 |       dbname: {{POSTGRES_DB}}
  
  Raw Error:
  ------------------------------
  while constructing a mapping
    in "<unicode string>", line 7, column 13
  found unhashable key
    in "<unicode string>", line 7, column 14
[0m17:00:35.992747 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.43809512, "process_user_time": 2.168315, "process_kernel_time": 1.003001, "process_mem_max_rss": "88656", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m17:00:35.998602 [debug] [MainThread]: Command `dbt debug` failed at 17:00:35.998394 after 0.45 seconds
[0m17:00:36.001698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c0493ff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c04761f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c04761f8b0>]}
[0m17:00:36.009103 [debug] [MainThread]: Flushing usage events
[0m17:05:34.672609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0886a7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0869ae380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0869af9a0>]}


============================== 17:05:34.680283 | 6803283a-0193-4ecc-9b1b-2026723247a2 ==============================
[0m17:05:34.680283 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:05:34.683358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/profiles', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:34.687085 [info ] [MainThread]: dbt version: 1.7.4
[0m17:05:34.689865 [info ] [MainThread]: python version: 3.10.7
[0m17:05:34.693130 [info ] [MainThread]: python path: /usr/local/bin/python
[0m17:05:34.695724 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m17:05:34.749399 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'POSTGRES_USER'
[0m17:05:34.752235 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.15659596, "process_user_time": 2.038031, "process_kernel_time": 0.322447, "process_mem_max_rss": "88936", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m17:05:34.754381 [debug] [MainThread]: Command `dbt debug` failed at 17:05:34.754228 after 0.16 seconds
[0m17:05:34.756232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0886a7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d0869393f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d08693a3e0>]}
[0m17:05:34.758869 [debug] [MainThread]: Flushing usage events
[0m17:15:39.645905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ed77cff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ed75fb5180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ed75fb7100>]}


============================== 17:15:39.656752 | 104e2b37-6a14-427b-8658-dc93ad3d8158 ==============================
[0m17:15:39.656752 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:15:39.659542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:39.663373 [info ] [MainThread]: dbt version: 1.7.4
[0m17:15:39.665661 [info ] [MainThread]: python version: 3.10.7
[0m17:15:39.667814 [info ] [MainThread]: python path: /usr/local/bin/python
[0m17:15:39.669993 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m17:15:39.852858 [info ] [MainThread]: Using profiles dir at /usr/app/profiles
[0m17:15:39.855003 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles/profiles.yml
[0m17:15:39.857107 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m17:15:39.860039 [info ] [MainThread]: adapter type: postgres
[0m17:15:39.862375 [info ] [MainThread]: adapter version: 1.7.4
[0m17:15:39.952410 [info ] [MainThread]: Configuration:
[0m17:15:39.956913 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:15:39.959881 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:15:39.962033 [info ] [MainThread]: Required dependencies:
[0m17:15:39.963990 [debug] [MainThread]: Executing "git --help"
[0m17:15:39.974352 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:15:39.976895 [debug] [MainThread]: STDERR: "b''"
[0m17:15:39.979039 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:15:39.981143 [info ] [MainThread]: Connection:
[0m17:15:39.984167 [info ] [MainThread]:   host: postgres
[0m17:15:39.986058 [info ] [MainThread]:   port: 5432
[0m17:15:39.988217 [info ] [MainThread]:   user: admin
[0m17:15:39.990508 [info ] [MainThread]:   database: postgres_metabase1
[0m17:15:39.992799 [info ] [MainThread]:   schema: raw
[0m17:15:39.994512 [info ] [MainThread]:   connect_timeout: 10
[0m17:15:39.996141 [info ] [MainThread]:   role: None
[0m17:15:39.997806 [info ] [MainThread]:   search_path: None
[0m17:15:40.000693 [info ] [MainThread]:   keepalives_idle: 0
[0m17:15:40.003133 [info ] [MainThread]:   sslmode: None
[0m17:15:40.005137 [info ] [MainThread]:   sslcert: None
[0m17:15:40.007318 [info ] [MainThread]:   sslkey: None
[0m17:15:40.009208 [info ] [MainThread]:   sslrootcert: None
[0m17:15:40.011290 [info ] [MainThread]:   application_name: dbt
[0m17:15:40.012999 [info ] [MainThread]:   retries: 1
[0m17:15:40.014736 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m17:15:40.018280 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:15:40.020346 [debug] [MainThread]: Using postgres connection "debug"
[0m17:15:40.022056 [debug] [MainThread]: On debug: select 1 as id
[0m17:15:40.023909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:40.053498 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:15:40.056158 [debug] [MainThread]: On debug: Close
[0m17:15:40.058275 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:15:40.060095 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:15:40.063099 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.49452972, "process_user_time": 2.221245, "process_kernel_time": 0.967383, "process_mem_max_rss": "96000", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m17:15:40.065763 [debug] [MainThread]: Command `dbt debug` succeeded at 17:15:40.065544 after 0.50 seconds
[0m17:15:40.068393 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:15:40.070361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ed77cff730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ed7473af80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ed746ab5b0>]}
[0m17:15:40.072700 [debug] [MainThread]: Flushing usage events
[0m17:17:01.772796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746eb3d13730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746eb1f3e170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746eb1f3e110>]}


============================== 17:17:01.777878 | a8c02f7e-19a4-43fe-9b01-919ed7f67e65 ==============================
[0m17:17:01.777878 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:17:01.779762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app/profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:17:02.019463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8c02f7e-19a4-43fe-9b01-919ed7f67e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746eb1f3e260>]}
[0m17:17:02.105769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8c02f7e-19a4-43fe-9b01-919ed7f67e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746eb06e7c70>]}
[0m17:17:02.108836 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m17:17:02.148175 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:17:02.168755 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:17:02.170205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a8c02f7e-19a4-43fe-9b01-919ed7f67e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746eb20bfe80>]}
[0m17:17:03.635286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m17:17:03.641486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8c02f7e-19a4-43fe-9b01-919ed7f67e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ead7f9ea0>]}
[0m17:17:03.684752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8c02f7e-19a4-43fe-9b01-919ed7f67e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746eb06b4250>]}
[0m17:17:03.686775 [info ] [MainThread]: Found 4 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:17:03.688728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8c02f7e-19a4-43fe-9b01-919ed7f67e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746eb0351300>]}
[0m17:17:03.692132 [info ] [MainThread]: 
[0m17:17:03.694914 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:03.697801 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m17:17:03.710074 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m17:17:03.712270 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m17:17:03.714181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:03.730331 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:17:03.732914 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m17:17:03.736462 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1_raw'
[0m17:17:03.743664 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m17:17:03.745652 [debug] [ThreadPool]: On list_postgres_metabase1_raw: BEGIN
[0m17:17:03.747116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:03.755517 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:17:03.757359 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m17:17:03.758878 [debug] [ThreadPool]: On list_postgres_metabase1_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1_raw"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m17:17:03.765078 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:17:03.767856 [debug] [ThreadPool]: On list_postgres_metabase1_raw: ROLLBACK
[0m17:17:03.769927 [debug] [ThreadPool]: On list_postgres_metabase1_raw: Close
[0m17:17:03.776111 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:03.777847 [debug] [MainThread]: On master: BEGIN
[0m17:17:03.779605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:03.790543 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:03.792491 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:03.794342 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:17:03.803314 [debug] [MainThread]: SQL status: SELECT 31 in 0.0 seconds
[0m17:17:03.806231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8c02f7e-19a4-43fe-9b01-919ed7f67e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ead802830>]}
[0m17:17:03.808347 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:03.810393 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:03.812120 [debug] [MainThread]: On master: BEGIN
[0m17:17:03.814206 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:03.815750 [debug] [MainThread]: On master: COMMIT
[0m17:17:03.817293 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:03.818787 [debug] [MainThread]: On master: COMMIT
[0m17:17:03.820487 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:03.822122 [debug] [MainThread]: On master: Close
[0m17:17:03.824134 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:17:03.826052 [info ] [MainThread]: 
[0m17:17:03.837198 [debug] [Thread-1 (]: Began running node model.superstore_project.stg_orders
[0m17:17:03.837718 [debug] [Thread-2 (]: Began running node model.superstore_project.stg_returns
[0m17:17:03.838175 [debug] [Thread-3 (]: Began running node model.superstore_project.stg_users
[0m17:17:03.839579 [info ] [Thread-1 (]: 1 of 4 START sql view model raw.stg_orders ..................................... [RUN]
[0m17:17:03.841280 [info ] [Thread-2 (]: 2 of 4 START sql view model raw.stg_returns .................................... [RUN]
[0m17:17:03.843061 [info ] [Thread-3 (]: 3 of 4 START sql view model raw.stg_users ...................................... [RUN]
[0m17:17:03.845162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1_raw, now model.superstore_project.stg_orders)
[0m17:17:03.847353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now model.superstore_project.stg_returns)
[0m17:17:03.849824 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_project.stg_users'
[0m17:17:03.851553 [debug] [Thread-1 (]: Began compiling node model.superstore_project.stg_orders
[0m17:17:03.853191 [debug] [Thread-2 (]: Began compiling node model.superstore_project.stg_returns
[0m17:17:03.854882 [debug] [Thread-3 (]: Began compiling node model.superstore_project.stg_users
[0m17:17:03.863780 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.stg_orders"
[0m17:17:03.867885 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.stg_returns"
[0m17:17:03.871874 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.stg_users"
[0m17:17:03.896669 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (compile): 17:17:03.869565 => 17:17:03.896230
[0m17:17:03.898550 [debug] [Thread-3 (]: Began executing node model.superstore_project.stg_users
[0m17:17:03.899091 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (compile): 17:17:03.865118 => 17:17:03.898810
[0m17:17:03.905763 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (compile): 17:17:03.856583 => 17:17:03.905462
[0m17:17:03.922879 [debug] [Thread-2 (]: Began executing node model.superstore_project.stg_returns
[0m17:17:03.934356 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.stg_users"
[0m17:17:03.935683 [debug] [Thread-1 (]: Began executing node model.superstore_project.stg_orders
[0m17:17:03.941101 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.stg_returns"
[0m17:17:03.948766 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.stg_orders"
[0m17:17:03.971983 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m17:17:03.973801 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: BEGIN
[0m17:17:03.975374 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m17:17:03.976040 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:17:03.978093 [debug] [Thread-3 (]: On model.superstore_project.stg_users: BEGIN
[0m17:17:03.979002 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m17:17:03.981678 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:17:03.984688 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: BEGIN
[0m17:17:03.986537 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:17:03.988821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:03.990822 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m17:17:03.994090 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */

  create view "postgres_metabase1"."raw"."stg_returns__dbt_tmp"
    
    
  as (
    WITH raw_returns AS (
    SELECT
        order_id,
        status
    FROM "postgres_metabase1"."raw"."returns"
)
SELECT *
FROM raw_returns;
  );
[0m17:17:03.995171 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:17:03.997316 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m17:17:03.998332 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 14: FROM raw_returns;
                         ^

[0m17:17:03.999526 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */

  create view "postgres_metabase1"."raw"."stg_users__dbt_tmp"
    
    
  as (
    WITH raw_users AS (
    SELECT
        region,
        manager
    FROM "postgres_metabase1"."raw"."managers"
)
SELECT *
FROM raw_users;
  );
[0m17:17:04.000480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:17:04.001476 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: ROLLBACK
[0m17:17:04.003821 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 14: FROM raw_users;
                       ^

[0m17:17:04.004788 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m17:17:04.006753 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (execute): 17:17:03.937306 => 17:17:04.006535
[0m17:17:04.007827 [debug] [Thread-3 (]: On model.superstore_project.stg_users: ROLLBACK
[0m17:17:04.009308 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */

  create view "postgres_metabase1"."raw"."stg_orders__dbt_tmp"
    
    
  as (
    WITH raw_orders AS (
    SELECT
        row_id,
        order_id,
        order_date,
        ship_date,
        ship_mode,
        order_priority,
        product_container,
        customer_name,
        customer_segment,
        zip_code,
        state,
        city,
        region,
        product_category,
        product_subcategory,
        product_name,
        unit_price,
        quantity AS order_quantity,
        sales,
        profit,
        discount,
        shipping_cost,
        product_base_margin
    FROM "postgres_metabase1"."raw"."orders"
)
SELECT *
FROM raw_orders;
  );
[0m17:17:04.010871 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: Close
[0m17:17:04.012862 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (execute): 17:17:03.900221 => 17:17:04.012630
[0m17:17:04.014438 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 35: FROM raw_orders;
                        ^

[0m17:17:04.016684 [debug] [Thread-3 (]: On model.superstore_project.stg_users: Close
[0m17:17:04.018395 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: ROLLBACK
[0m17:17:04.022653 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (execute): 17:17:03.944085 => 17:17:04.022359
[0m17:17:04.024261 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: Close
[0m17:17:04.028037 [debug] [Thread-2 (]: Database Error in model stg_returns (models/stg/stg_returns.sql)
  syntax error at or near ";"
  LINE 14: FROM raw_returns;
                           ^
  compiled Code at target/run/superstore_project/models/stg/stg_returns.sql
[0m17:17:04.029009 [debug] [Thread-3 (]: Database Error in model stg_users (models/stg/stg_users.sql)
  syntax error at or near ";"
  LINE 14: FROM raw_users;
                         ^
  compiled Code at target/run/superstore_project/models/stg/stg_users.sql
[0m17:17:04.029744 [debug] [Thread-1 (]: Database Error in model stg_orders (models/stg/stg_orders.sql)
  syntax error at or near ";"
  LINE 35: FROM raw_orders;
                          ^
  compiled Code at target/run/superstore_project/models/stg/stg_orders.sql
[0m17:17:04.030939 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8c02f7e-19a4-43fe-9b01-919ed7f67e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ead70c520>]}
[0m17:17:04.032948 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8c02f7e-19a4-43fe-9b01-919ed7f67e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ead6fe110>]}
[0m17:17:04.034902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8c02f7e-19a4-43fe-9b01-919ed7f67e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ead89b130>]}
[0m17:17:04.036871 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model raw.stg_returns ........................... [[31mERROR[0m in 0.18s]
[0m17:17:04.039331 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model raw.stg_users ............................. [[31mERROR[0m in 0.18s]
[0m17:17:04.041066 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model raw.stg_orders ............................ [[31mERROR[0m in 0.19s]
[0m17:17:04.042864 [debug] [Thread-2 (]: Finished running node model.superstore_project.stg_returns
[0m17:17:04.044645 [debug] [Thread-3 (]: Finished running node model.superstore_project.stg_users
[0m17:17:04.046406 [debug] [Thread-1 (]: Finished running node model.superstore_project.stg_orders
[0m17:17:04.051468 [debug] [Thread-4 (]: Began running node model.superstore_project.final_orders_with_returns
[0m17:17:04.054113 [info ] [Thread-4 (]: 4 of 4 SKIP relation raw.final_orders_with_returns ............................. [[33mSKIP[0m]
[0m17:17:04.056214 [debug] [Thread-4 (]: Finished running node model.superstore_project.final_orders_with_returns
[0m17:17:04.059777 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:04.061206 [debug] [MainThread]: On master: BEGIN
[0m17:17:04.062649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:04.072134 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:17:04.073815 [debug] [MainThread]: On master: COMMIT
[0m17:17:04.075262 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:04.076754 [debug] [MainThread]: On master: COMMIT
[0m17:17:04.078474 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:17:04.080013 [debug] [MainThread]: On master: Close
[0m17:17:04.082268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:04.083797 [debug] [MainThread]: Connection 'model.superstore_project.stg_returns' was properly closed.
[0m17:17:04.085105 [debug] [MainThread]: Connection 'model.superstore_project.stg_orders' was properly closed.
[0m17:17:04.086605 [debug] [MainThread]: Connection 'model.superstore_project.stg_users' was properly closed.
[0m17:17:04.088201 [info ] [MainThread]: 
[0m17:17:04.089728 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m17:17:04.091630 [debug] [MainThread]: Command end result
[0m17:17:04.121444 [info ] [MainThread]: 
[0m17:17:04.123152 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m17:17:04.124956 [info ] [MainThread]: 
[0m17:17:04.126563 [error] [MainThread]:   Database Error in model stg_returns (models/stg/stg_returns.sql)
  syntax error at or near ";"
  LINE 14: FROM raw_returns;
                           ^
  compiled Code at target/run/superstore_project/models/stg/stg_returns.sql
[0m17:17:04.128328 [info ] [MainThread]: 
[0m17:17:04.130569 [error] [MainThread]:   Database Error in model stg_users (models/stg/stg_users.sql)
  syntax error at or near ";"
  LINE 14: FROM raw_users;
                         ^
  compiled Code at target/run/superstore_project/models/stg/stg_users.sql
[0m17:17:04.132680 [info ] [MainThread]: 
[0m17:17:04.134378 [error] [MainThread]:   Database Error in model stg_orders (models/stg/stg_orders.sql)
  syntax error at or near ";"
  LINE 35: FROM raw_orders;
                          ^
  compiled Code at target/run/superstore_project/models/stg/stg_orders.sql
[0m17:17:04.136306 [info ] [MainThread]: 
[0m17:17:04.137916 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m17:17:04.140194 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.4383283, "process_user_time": 3.310645, "process_kernel_time": 0.280776, "process_mem_max_rss": "112560", "process_out_blocks": "56", "command_success": false, "process_in_blocks": "0"}
[0m17:17:04.143516 [debug] [MainThread]: Command `dbt run` failed at 17:17:04.143312 after 2.44 seconds
[0m17:17:04.145010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746eb3d13730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746eb1f3e260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746ead70c520>]}
[0m17:17:04.146764 [debug] [MainThread]: Flushing usage events
[0m17:21:10.993983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5558b2740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f553b161a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f553b16140>]}


============================== 17:21:11.007139 | 86771c81-ab3d-4656-88e2-357e98fc0613 ==============================
[0m17:21:11.007139 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:21:11.012082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app/profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:21:11.341914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86771c81-ab3d-4656-88e2-357e98fc0613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f553b16290>]}
[0m17:21:11.426686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86771c81-ab3d-4656-88e2-357e98fc0613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5520c7ca0>]}
[0m17:21:11.429128 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m17:21:11.460723 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:21:12.373097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:21:12.376786 [debug] [MainThread]: Partial parsing: updated file: superstore_project://models/stg/stg_orders.sql
[0m17:21:12.380209 [debug] [MainThread]: Partial parsing: updated file: superstore_project://models/stg/stg_users.sql
[0m17:21:12.384781 [debug] [MainThread]: Partial parsing: updated file: superstore_project://models/stg/stg_returns.sql
[0m17:21:12.727035 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m17:21:12.767782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86771c81-ab3d-4656-88e2-357e98fc0613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f54b4ac070>]}
[0m17:21:12.952646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86771c81-ab3d-4656-88e2-357e98fc0613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f551fa3d60>]}
[0m17:21:12.964248 [info ] [MainThread]: Found 4 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:21:12.973832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86771c81-ab3d-4656-88e2-357e98fc0613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f551fa3eb0>]}
[0m17:21:12.988403 [info ] [MainThread]: 
[0m17:21:12.994281 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:21:13.001400 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m17:21:13.014874 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m17:21:13.018134 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m17:21:13.021361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:13.036990 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:21:13.041417 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m17:21:13.046067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now list_postgres_metabase1_raw)
[0m17:21:13.058056 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m17:21:13.061003 [debug] [ThreadPool]: On list_postgres_metabase1_raw: BEGIN
[0m17:21:13.063422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:13.074950 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:21:13.077134 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m17:21:13.079713 [debug] [ThreadPool]: On list_postgres_metabase1_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1_raw"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m17:21:13.093492 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:21:13.099987 [debug] [ThreadPool]: On list_postgres_metabase1_raw: ROLLBACK
[0m17:21:13.105599 [debug] [ThreadPool]: On list_postgres_metabase1_raw: Close
[0m17:21:13.123376 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:13.132389 [debug] [MainThread]: On master: BEGIN
[0m17:21:13.137705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:13.164872 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:21:13.172361 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:13.178934 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:21:13.195678 [debug] [MainThread]: SQL status: SELECT 31 in 0.0 seconds
[0m17:21:13.203569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86771c81-ab3d-4656-88e2-357e98fc0613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f54b2fea40>]}
[0m17:21:13.207993 [debug] [MainThread]: On master: ROLLBACK
[0m17:21:13.223233 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:13.233461 [debug] [MainThread]: On master: BEGIN
[0m17:21:13.242585 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:21:13.250011 [debug] [MainThread]: On master: COMMIT
[0m17:21:13.252963 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:13.257263 [debug] [MainThread]: On master: COMMIT
[0m17:21:13.266898 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:21:13.278883 [debug] [MainThread]: On master: Close
[0m17:21:13.284859 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:21:13.287856 [info ] [MainThread]: 
[0m17:21:13.304240 [debug] [Thread-1 (]: Began running node model.superstore_project.stg_orders
[0m17:21:13.305725 [debug] [Thread-2 (]: Began running node model.superstore_project.stg_returns
[0m17:21:13.307743 [debug] [Thread-3 (]: Began running node model.superstore_project.stg_users
[0m17:21:13.312875 [info ] [Thread-1 (]: 1 of 4 START sql view model raw.stg_orders ..................................... [RUN]
[0m17:21:13.318568 [info ] [Thread-2 (]: 2 of 4 START sql view model raw.stg_returns .................................... [RUN]
[0m17:21:13.328790 [info ] [Thread-3 (]: 3 of 4 START sql view model raw.stg_users ...................................... [RUN]
[0m17:21:13.338076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1_raw, now model.superstore_project.stg_orders)
[0m17:21:13.344017 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.superstore_project.stg_returns'
[0m17:21:13.356768 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_project.stg_users'
[0m17:21:13.367069 [debug] [Thread-1 (]: Began compiling node model.superstore_project.stg_orders
[0m17:21:13.375425 [debug] [Thread-2 (]: Began compiling node model.superstore_project.stg_returns
[0m17:21:13.381127 [debug] [Thread-3 (]: Began compiling node model.superstore_project.stg_users
[0m17:21:13.399482 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.stg_orders"
[0m17:21:13.404737 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.stg_returns"
[0m17:21:13.416241 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.stg_users"
[0m17:21:13.463578 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (compile): 17:21:13.386142 => 17:21:13.461567
[0m17:21:13.477340 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (compile): 17:21:13.408567 => 17:21:13.474685
[0m17:21:13.480557 [debug] [Thread-1 (]: Began executing node model.superstore_project.stg_orders
[0m17:21:13.489575 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (compile): 17:21:13.401195 => 17:21:13.486746
[0m17:21:13.495918 [debug] [Thread-3 (]: Began executing node model.superstore_project.stg_users
[0m17:21:13.542501 [debug] [Thread-2 (]: Began executing node model.superstore_project.stg_returns
[0m17:21:13.701864 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.stg_returns"
[0m17:21:13.702506 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.stg_orders"
[0m17:21:13.703491 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.stg_users"
[0m17:21:13.738557 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m17:21:13.739041 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m17:21:13.742281 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: BEGIN
[0m17:21:13.748118 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: BEGIN
[0m17:21:13.750918 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m17:21:13.758355 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:21:13.764019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:13.773191 [debug] [Thread-3 (]: On model.superstore_project.stg_users: BEGIN
[0m17:21:13.784375 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:21:13.787753 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:21:13.792079 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:21:13.792655 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m17:21:13.797788 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m17:21:13.801517 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */

  create view "postgres_metabase1"."raw"."stg_returns__dbt_tmp"
    
    
  as (
    WITH raw_returns AS (
    SELECT
        order_id,
        status
    FROM "postgres_metabase1"."raw"."returns"
)
SELECT *
FROM raw_returns
  );
[0m17:21:13.802678 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:21:13.804349 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */

  create view "postgres_metabase1"."raw"."stg_orders__dbt_tmp"
    
    
  as (
    WITH raw_orders AS (
    SELECT
        row_id,
        order_id,
        order_date,
        ship_date,
        ship_mode,
        order_priority,
        product_container,
        customer_name,
        customer_segment,
        zip_code,
        state,
        city,
        region,
        product_category,
        product_subcategory,
        product_name,
        unit_price,
        quantity AS order_quantity,
        sales,
        profit,
        discount,
        shipping_cost,
        product_base_margin
    FROM "postgres_metabase1"."raw"."orders"
)
SELECT *
FROM raw_orders
  );
[0m17:21:13.812829 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m17:21:13.816035 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:21:13.820534 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */

  create view "postgres_metabase1"."raw"."stg_users__dbt_tmp"
    
    
  as (
    WITH raw_users AS (
    SELECT
        region,
        manager
    FROM "postgres_metabase1"."raw"."managers"
)
SELECT *
FROM raw_users
  );
[0m17:21:13.825009 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:21:13.840407 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m17:21:13.844629 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:21:13.849888 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m17:21:13.859903 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
alter table "postgres_metabase1"."raw"."stg_returns__dbt_tmp" rename to "stg_returns"
[0m17:21:13.871276 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m17:21:13.877838 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
alter table "postgres_metabase1"."raw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:21:13.887073 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:13.889347 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
alter table "postgres_metabase1"."raw"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:21:13.896141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:13.942688 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:13.944506 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m17:21:13.946852 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m17:21:13.953435 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m17:21:13.956070 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m17:21:13.958453 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m17:21:13.961184 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m17:21:13.963732 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m17:21:13.967014 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m17:21:13.970843 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m17:21:13.976243 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:21:13.977580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:21:13.978484 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:21:13.984959 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_returns__dbt_backup"
[0m17:21:13.988285 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_orders__dbt_backup"
[0m17:21:13.992800 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_users__dbt_backup"
[0m17:21:13.999160 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m17:21:14.002939 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m17:21:14.006308 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m17:21:14.009792 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
drop view if exists "postgres_metabase1"."raw"."stg_returns__dbt_backup" cascade
[0m17:21:14.012540 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
drop view if exists "postgres_metabase1"."raw"."stg_orders__dbt_backup" cascade
[0m17:21:14.014740 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
drop view if exists "postgres_metabase1"."raw"."stg_users__dbt_backup" cascade
[0m17:21:14.018177 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:21:14.019564 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:21:14.021777 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:21:14.026151 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (execute): 17:21:13.664116 => 17:21:14.025974
[0m17:21:14.030092 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (execute): 17:21:13.508789 => 17:21:14.029634
[0m17:21:14.034364 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (execute): 17:21:13.577242 => 17:21:14.033987
[0m17:21:14.037267 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: Close
[0m17:21:14.052157 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: Close
[0m17:21:14.057556 [debug] [Thread-3 (]: On model.superstore_project.stg_users: Close
[0m17:21:14.064256 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86771c81-ab3d-4656-88e2-357e98fc0613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f54b315e10>]}
[0m17:21:14.070605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86771c81-ab3d-4656-88e2-357e98fc0613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f54b37f850>]}
[0m17:21:14.075978 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86771c81-ab3d-4656-88e2-357e98fc0613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f54b35bdc0>]}
[0m17:21:14.079107 [info ] [Thread-2 (]: 2 of 4 OK created sql view model raw.stg_returns ............................... [[32mCREATE VIEW[0m in 0.72s]
[0m17:21:14.082501 [info ] [Thread-1 (]: 1 of 4 OK created sql view model raw.stg_orders ................................ [[32mCREATE VIEW[0m in 0.73s]
[0m17:21:14.086678 [info ] [Thread-3 (]: 3 of 4 OK created sql view model raw.stg_users ................................. [[32mCREATE VIEW[0m in 0.72s]
[0m17:21:14.089613 [debug] [Thread-2 (]: Finished running node model.superstore_project.stg_returns
[0m17:21:14.091864 [debug] [Thread-1 (]: Finished running node model.superstore_project.stg_orders
[0m17:21:14.093871 [debug] [Thread-3 (]: Finished running node model.superstore_project.stg_users
[0m17:21:14.102729 [debug] [Thread-4 (]: Began running node model.superstore_project.final_orders_with_returns
[0m17:21:14.105686 [info ] [Thread-4 (]: 4 of 4 START sql view model raw.final_orders_with_returns ...................... [RUN]
[0m17:21:14.109129 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_project.final_orders_with_returns'
[0m17:21:14.111459 [debug] [Thread-4 (]: Began compiling node model.superstore_project.final_orders_with_returns
[0m17:21:14.117270 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.final_orders_with_returns"
[0m17:21:14.169531 [debug] [Thread-4 (]: Timing info for model.superstore_project.final_orders_with_returns (compile): 17:21:14.113417 => 17:21:14.167516
[0m17:21:14.173489 [debug] [Thread-4 (]: Began executing node model.superstore_project.final_orders_with_returns
[0m17:21:14.196699 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_project.final_orders_with_returns"
[0m17:21:14.263832 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m17:21:14.266390 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: BEGIN
[0m17:21:14.268996 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:21:14.276744 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:21:14.279176 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m17:21:14.280684 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */

  create view "postgres_metabase1"."raw"."final_orders_with_returns__dbt_tmp"
    
    
  as (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."raw"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."raw"."stg_returns" r
    ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."raw"."stg_users" u
    ON o.region = u.region
)
SELECT *
FROM orders_with_returns;
  );
[0m17:21:14.282981 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 19: FROM orders_with_returns;
                                 ^

[0m17:21:14.285186 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: ROLLBACK
[0m17:21:14.287214 [debug] [Thread-4 (]: Timing info for model.superstore_project.final_orders_with_returns (execute): 17:21:14.180629 => 17:21:14.286955
[0m17:21:14.289626 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: Close
[0m17:21:14.296467 [debug] [Thread-4 (]: Database Error in model final_orders_with_returns (models/marts/final_orders_with_returns.sql)
  syntax error at or near ";"
  LINE 19: FROM orders_with_returns;
                                   ^
  compiled Code at target/run/superstore_project/models/marts/final_orders_with_returns.sql
[0m17:21:14.298558 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86771c81-ab3d-4656-88e2-357e98fc0613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f54b3165f0>]}
[0m17:21:14.301865 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model raw.final_orders_with_returns ............. [[31mERROR[0m in 0.19s]
[0m17:21:14.303985 [debug] [Thread-4 (]: Finished running node model.superstore_project.final_orders_with_returns
[0m17:21:14.307103 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:14.309415 [debug] [MainThread]: On master: BEGIN
[0m17:21:14.311311 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:14.319770 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:21:14.321878 [debug] [MainThread]: On master: COMMIT
[0m17:21:14.324090 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:14.325899 [debug] [MainThread]: On master: COMMIT
[0m17:21:14.328064 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:21:14.330466 [debug] [MainThread]: On master: Close
[0m17:21:14.332808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:14.335629 [debug] [MainThread]: Connection 'model.superstore_project.stg_orders' was properly closed.
[0m17:21:14.339445 [debug] [MainThread]: Connection 'model.superstore_project.stg_returns' was properly closed.
[0m17:21:14.341596 [debug] [MainThread]: Connection 'model.superstore_project.stg_users' was properly closed.
[0m17:21:14.343107 [debug] [MainThread]: Connection 'model.superstore_project.final_orders_with_returns' was properly closed.
[0m17:21:14.347079 [info ] [MainThread]: 
[0m17:21:14.350551 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m17:21:14.353548 [debug] [MainThread]: Command end result
[0m17:21:14.398641 [info ] [MainThread]: 
[0m17:21:14.400781 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:21:14.403072 [info ] [MainThread]: 
[0m17:21:14.406800 [error] [MainThread]:   Database Error in model final_orders_with_returns (models/marts/final_orders_with_returns.sql)
  syntax error at or near ";"
  LINE 19: FROM orders_with_returns;
                                   ^
  compiled Code at target/run/superstore_project/models/marts/final_orders_with_returns.sql
[0m17:21:14.408673 [info ] [MainThread]: 
[0m17:21:14.410682 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:21:14.413707 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.5271845, "process_user_time": 2.943545, "process_kernel_time": 0.386983, "process_mem_max_rss": "112284", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:21:14.415776 [debug] [MainThread]: Command `dbt run` failed at 17:21:14.415617 after 3.53 seconds
[0m17:21:14.417392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f5558b2740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f54b47e500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f552085e70>]}
[0m17:21:14.419416 [debug] [MainThread]: Flushing usage events
[0m17:21:44.904521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da60b56f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da6097da1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da6097da170>]}


============================== 17:21:44.908818 | 48591923-75d8-454c-a65f-70bf2f9a4715 ==============================
[0m17:21:44.908818 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:21:44.911350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app/profiles', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:21:45.175955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48591923-75d8-454c-a65f-70bf2f9a4715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da6097da2c0>]}
[0m17:21:45.282763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48591923-75d8-454c-a65f-70bf2f9a4715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da607d87cd0>]}
[0m17:21:45.289180 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m17:21:45.378546 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:21:46.648012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:21:46.650087 [debug] [MainThread]: Partial parsing: updated file: superstore_project://models/marts/final_orders_with_returns.sql
[0m17:21:46.961230 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m17:21:46.969193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48591923-75d8-454c-a65f-70bf2f9a4715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da607b6f730>]}
[0m17:21:47.128816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48591923-75d8-454c-a65f-70bf2f9a4715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da607d3fd60>]}
[0m17:21:47.131656 [info ] [MainThread]: Found 4 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:21:47.134331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48591923-75d8-454c-a65f-70bf2f9a4715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da607d3ff40>]}
[0m17:21:47.145312 [info ] [MainThread]: 
[0m17:21:47.152000 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:21:47.159793 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m17:21:47.181048 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m17:21:47.183128 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m17:21:47.185289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:47.198730 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:21:47.202134 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m17:21:47.211791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now list_postgres_metabase1_raw)
[0m17:21:47.221334 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m17:21:47.223798 [debug] [ThreadPool]: On list_postgres_metabase1_raw: BEGIN
[0m17:21:47.226144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:47.235596 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:21:47.238133 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m17:21:47.240484 [debug] [ThreadPool]: On list_postgres_metabase1_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1_raw"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m17:21:47.247376 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:21:47.252018 [debug] [ThreadPool]: On list_postgres_metabase1_raw: ROLLBACK
[0m17:21:47.255053 [debug] [ThreadPool]: On list_postgres_metabase1_raw: Close
[0m17:21:47.265073 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:47.268275 [debug] [MainThread]: On master: BEGIN
[0m17:21:47.271063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:47.285409 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:21:47.289189 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:47.292668 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:21:47.309196 [debug] [MainThread]: SQL status: SELECT 34 in 0.0 seconds
[0m17:21:47.320533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48591923-75d8-454c-a65f-70bf2f9a4715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da607d84670>]}
[0m17:21:47.330509 [debug] [MainThread]: On master: ROLLBACK
[0m17:21:47.349421 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:47.363130 [debug] [MainThread]: On master: BEGIN
[0m17:21:47.392188 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:21:47.407712 [debug] [MainThread]: On master: COMMIT
[0m17:21:47.419052 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:47.430194 [debug] [MainThread]: On master: COMMIT
[0m17:21:47.443170 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:21:47.453836 [debug] [MainThread]: On master: Close
[0m17:21:47.463891 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:21:47.471638 [info ] [MainThread]: 
[0m17:21:47.503207 [debug] [Thread-1 (]: Began running node model.superstore_project.stg_orders
[0m17:21:47.506336 [debug] [Thread-2 (]: Began running node model.superstore_project.stg_returns
[0m17:21:47.509190 [debug] [Thread-3 (]: Began running node model.superstore_project.stg_users
[0m17:21:47.518639 [info ] [Thread-1 (]: 1 of 4 START sql view model raw.stg_orders ..................................... [RUN]
[0m17:21:47.527700 [info ] [Thread-2 (]: 2 of 4 START sql view model raw.stg_returns .................................... [RUN]
[0m17:21:47.536023 [info ] [Thread-3 (]: 3 of 4 START sql view model raw.stg_users ...................................... [RUN]
[0m17:21:47.547417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1_raw, now model.superstore_project.stg_orders)
[0m17:21:47.558063 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.superstore_project.stg_returns'
[0m17:21:47.564469 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_project.stg_users'
[0m17:21:47.570563 [debug] [Thread-1 (]: Began compiling node model.superstore_project.stg_orders
[0m17:21:47.575471 [debug] [Thread-2 (]: Began compiling node model.superstore_project.stg_returns
[0m17:21:47.579721 [debug] [Thread-3 (]: Began compiling node model.superstore_project.stg_users
[0m17:21:47.591137 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.stg_orders"
[0m17:21:47.596300 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.stg_returns"
[0m17:21:47.602150 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.stg_users"
[0m17:21:47.614450 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (compile): 17:21:47.582887 => 17:21:47.613947
[0m17:21:47.615953 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (compile): 17:21:47.592609 => 17:21:47.615646
[0m17:21:47.616883 [debug] [Thread-1 (]: Began executing node model.superstore_project.stg_orders
[0m17:21:47.618070 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (compile): 17:21:47.598257 => 17:21:47.617740
[0m17:21:47.618947 [debug] [Thread-2 (]: Began executing node model.superstore_project.stg_returns
[0m17:21:47.642794 [debug] [Thread-3 (]: Began executing node model.superstore_project.stg_users
[0m17:21:47.657959 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.stg_orders"
[0m17:21:47.662641 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.stg_returns"
[0m17:21:47.667917 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.stg_users"
[0m17:21:47.677813 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m17:21:47.678824 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m17:21:47.679533 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: BEGIN
[0m17:21:47.680624 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m17:21:47.681303 [debug] [Thread-3 (]: On model.superstore_project.stg_users: BEGIN
[0m17:21:47.682633 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:21:47.683998 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: BEGIN
[0m17:21:47.685437 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:21:47.687844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:47.693580 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:21:47.694280 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:21:47.695487 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m17:21:47.696285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:21:47.697376 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m17:21:47.699182 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */

  create view "postgres_metabase1"."raw"."stg_returns__dbt_tmp"
    
    
  as (
    WITH raw_returns AS (
    SELECT
        order_id,
        status
    FROM "postgres_metabase1"."raw"."returns"
)
SELECT *
FROM raw_returns
  );
[0m17:21:47.700713 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m17:21:47.702385 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */

  create view "postgres_metabase1"."raw"."stg_users__dbt_tmp"
    
    
  as (
    WITH raw_users AS (
    SELECT
        region,
        manager
    FROM "postgres_metabase1"."raw"."managers"
)
SELECT *
FROM raw_users
  );
[0m17:21:47.705928 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */

  create view "postgres_metabase1"."raw"."stg_orders__dbt_tmp"
    
    
  as (
    WITH raw_orders AS (
    SELECT
        row_id,
        order_id,
        order_date,
        ship_date,
        ship_mode,
        order_priority,
        product_container,
        customer_name,
        customer_segment,
        zip_code,
        state,
        city,
        region,
        product_category,
        product_subcategory,
        product_name,
        unit_price,
        quantity AS order_quantity,
        sales,
        profit,
        discount,
        shipping_cost,
        product_base_margin
    FROM "postgres_metabase1"."raw"."orders"
)
SELECT *
FROM raw_orders
  );
[0m17:21:47.706395 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:21:47.715375 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:21:47.716125 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m17:21:47.716546 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:21:47.720677 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m17:21:47.722655 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
alter table "postgres_metabase1"."raw"."stg_returns" rename to "stg_returns__dbt_backup"
[0m17:21:47.726760 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m17:21:47.728455 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
alter table "postgres_metabase1"."raw"."stg_users" rename to "stg_users__dbt_backup"
[0m17:21:47.730589 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:47.731713 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
alter table "postgres_metabase1"."raw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m17:21:47.733802 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:47.737152 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m17:21:47.739400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:47.743717 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m17:21:47.745634 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
alter table "postgres_metabase1"."raw"."stg_returns__dbt_tmp" rename to "stg_returns"
[0m17:21:47.749865 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m17:21:47.751848 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
alter table "postgres_metabase1"."raw"."stg_users__dbt_tmp" rename to "stg_users"
[0m17:21:47.754249 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:47.755181 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
alter table "postgres_metabase1"."raw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m17:21:47.757158 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:47.773477 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m17:21:47.775036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:47.777448 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m17:21:47.779370 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m17:21:47.782477 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m17:21:47.784019 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m17:21:47.785587 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m17:21:47.786906 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m17:21:47.788512 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m17:21:47.791829 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m17:21:47.793338 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:21:47.795911 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:21:47.803424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:21:47.807513 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_returns__dbt_backup"
[0m17:21:47.812497 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_users__dbt_backup"
[0m17:21:47.816673 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_orders__dbt_backup"
[0m17:21:47.822977 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m17:21:47.825237 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m17:21:47.827198 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m17:21:47.828811 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
drop view if exists "postgres_metabase1"."raw"."stg_returns__dbt_backup" cascade
[0m17:21:47.830781 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
drop view if exists "postgres_metabase1"."raw"."stg_users__dbt_backup" cascade
[0m17:21:47.832613 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
drop view if exists "postgres_metabase1"."raw"."stg_orders__dbt_backup" cascade
[0m17:21:47.837571 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:21:47.838092 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:21:47.838515 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:21:47.841114 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (execute): 17:21:47.659067 => 17:21:47.840934
[0m17:21:47.843733 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (execute): 17:21:47.620365 => 17:21:47.843556
[0m17:21:47.846611 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (execute): 17:21:47.664211 => 17:21:47.846436
[0m17:21:47.848254 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: Close
[0m17:21:47.850131 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: Close
[0m17:21:47.851669 [debug] [Thread-3 (]: On model.superstore_project.stg_users: Close
[0m17:21:47.854066 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48591923-75d8-454c-a65f-70bf2f9a4715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da607aa7af0>]}
[0m17:21:47.855864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48591923-75d8-454c-a65f-70bf2f9a4715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da60525bdf0>]}
[0m17:21:47.857315 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48591923-75d8-454c-a65f-70bf2f9a4715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da6052675e0>]}
[0m17:21:47.858690 [info ] [Thread-2 (]: 2 of 4 OK created sql view model raw.stg_returns ............................... [[32mCREATE VIEW[0m in 0.30s]
[0m17:21:47.860679 [info ] [Thread-1 (]: 1 of 4 OK created sql view model raw.stg_orders ................................ [[32mCREATE VIEW[0m in 0.31s]
[0m17:21:47.862434 [info ] [Thread-3 (]: 3 of 4 OK created sql view model raw.stg_users ................................. [[32mCREATE VIEW[0m in 0.29s]
[0m17:21:47.863852 [debug] [Thread-2 (]: Finished running node model.superstore_project.stg_returns
[0m17:21:47.865762 [debug] [Thread-1 (]: Finished running node model.superstore_project.stg_orders
[0m17:21:47.872170 [debug] [Thread-3 (]: Finished running node model.superstore_project.stg_users
[0m17:21:47.878663 [debug] [Thread-4 (]: Began running node model.superstore_project.final_orders_with_returns
[0m17:21:47.882585 [info ] [Thread-4 (]: 4 of 4 START sql view model raw.final_orders_with_returns ...................... [RUN]
[0m17:21:47.885250 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_project.final_orders_with_returns'
[0m17:21:47.886948 [debug] [Thread-4 (]: Began compiling node model.superstore_project.final_orders_with_returns
[0m17:21:47.891856 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.final_orders_with_returns"
[0m17:21:47.908390 [debug] [Thread-4 (]: Timing info for model.superstore_project.final_orders_with_returns (compile): 17:21:47.888791 => 17:21:47.908047
[0m17:21:47.910145 [debug] [Thread-4 (]: Began executing node model.superstore_project.final_orders_with_returns
[0m17:21:47.919681 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_project.final_orders_with_returns"
[0m17:21:47.933891 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m17:21:47.935507 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: BEGIN
[0m17:21:47.936932 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:21:47.944160 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:21:47.946064 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m17:21:47.948019 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */

  create view "postgres_metabase1"."raw"."final_orders_with_returns__dbt_tmp"
    
    
  as (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."raw"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."raw"."stg_returns" r
    ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."raw"."stg_users" u
    ON o.region = u.region
)
SELECT *
FROM orders_with_returns
  );
[0m17:21:47.952934 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:21:47.957413 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m17:21:47.959208 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
alter table "postgres_metabase1"."raw"."final_orders_with_returns__dbt_tmp" rename to "final_orders_with_returns"
[0m17:21:47.961543 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:21:47.963939 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m17:21:47.965633 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m17:21:47.966851 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m17:21:47.969850 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m17:21:47.973399 [debug] [Thread-4 (]: Applying DROP to: "postgres_metabase1"."raw"."final_orders_with_returns__dbt_backup"
[0m17:21:47.975644 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m17:21:47.977285 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
drop view if exists "postgres_metabase1"."raw"."final_orders_with_returns__dbt_backup" cascade
[0m17:21:47.978973 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:21:47.982437 [debug] [Thread-4 (]: Timing info for model.superstore_project.final_orders_with_returns (execute): 17:21:47.911391 => 17:21:47.982246
[0m17:21:47.984335 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: Close
[0m17:21:47.986588 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48591923-75d8-454c-a65f-70bf2f9a4715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da60533f280>]}
[0m17:21:47.988779 [info ] [Thread-4 (]: 4 of 4 OK created sql view model raw.final_orders_with_returns ................. [[32mCREATE VIEW[0m in 0.10s]
[0m17:21:47.990714 [debug] [Thread-4 (]: Finished running node model.superstore_project.final_orders_with_returns
[0m17:21:47.993954 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:47.995707 [debug] [MainThread]: On master: BEGIN
[0m17:21:47.998621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:48.009135 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:21:48.014398 [debug] [MainThread]: On master: COMMIT
[0m17:21:48.016937 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:48.019747 [debug] [MainThread]: On master: COMMIT
[0m17:21:48.021753 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:21:48.023198 [debug] [MainThread]: On master: Close
[0m17:21:48.025268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:48.027043 [debug] [MainThread]: Connection 'model.superstore_project.stg_orders' was properly closed.
[0m17:21:48.029396 [debug] [MainThread]: Connection 'model.superstore_project.stg_returns' was properly closed.
[0m17:21:48.031385 [debug] [MainThread]: Connection 'model.superstore_project.stg_users' was properly closed.
[0m17:21:48.032899 [debug] [MainThread]: Connection 'model.superstore_project.final_orders_with_returns' was properly closed.
[0m17:21:48.034470 [info ] [MainThread]: 
[0m17:21:48.036714 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m17:21:48.039382 [debug] [MainThread]: Command end result
[0m17:21:48.105044 [info ] [MainThread]: 
[0m17:21:48.108214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:48.110310 [info ] [MainThread]: 
[0m17:21:48.111827 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:21:48.113949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2767284, "process_user_time": 2.805534, "process_kernel_time": 0.265388, "process_mem_max_rss": "111008", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:21:48.116564 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:48.116398 after 3.28 seconds
[0m17:21:48.118195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da60b56f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da60525bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da605303fa0>]}
[0m17:21:48.120111 [debug] [MainThread]: Flushing usage events
[0m17:24:14.265410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1f32956290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1f30b86170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1f30b86110>]}


============================== 17:24:14.271400 | 5f6410ca-c867-4bb5-a255-e64d3d4d7ca2 ==============================
[0m17:24:14.271400 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:24:14.274361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:24:14.563773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f6410ca-c867-4bb5-a255-e64d3d4d7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1f30b86260>]}
[0m17:24:14.654579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f6410ca-c867-4bb5-a255-e64d3d4d7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1f2f32bc70>]}
[0m17:24:14.658179 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m17:24:14.713354 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:24:15.553840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:15.564813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:15.572313 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m17:24:15.596015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f6410ca-c867-4bb5-a255-e64d3d4d7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1f2f11d1b0>]}
[0m17:24:15.726728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f6410ca-c867-4bb5-a255-e64d3d4d7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1f2f0eca00>]}
[0m17:24:15.732154 [info ] [MainThread]: Found 4 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:24:15.736204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f6410ca-c867-4bb5-a255-e64d3d4d7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1f2f0eca30>]}
[0m17:24:15.744037 [info ] [MainThread]: 
[0m17:24:15.752452 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:24:15.760607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1_raw'
[0m17:24:15.775554 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m17:24:15.778076 [debug] [ThreadPool]: On list_postgres_metabase1_raw: BEGIN
[0m17:24:15.780183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:15.791168 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:24:15.793848 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m17:24:15.796413 [debug] [ThreadPool]: On list_postgres_metabase1_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1_raw"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m17:24:15.802155 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m17:24:15.804848 [debug] [ThreadPool]: On list_postgres_metabase1_raw: ROLLBACK
[0m17:24:15.808427 [debug] [ThreadPool]: On list_postgres_metabase1_raw: Close
[0m17:24:15.826825 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:15.830264 [debug] [MainThread]: On master: BEGIN
[0m17:24:15.833310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:15.847972 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:24:15.850433 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:15.853764 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:24:15.875654 [debug] [MainThread]: SQL status: SELECT 37 in 0.0 seconds
[0m17:24:15.881547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f6410ca-c867-4bb5-a255-e64d3d4d7ca2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1f2f0cbdf0>]}
[0m17:24:15.885024 [debug] [MainThread]: On master: ROLLBACK
[0m17:24:15.889053 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:15.894051 [debug] [MainThread]: On master: BEGIN
[0m17:24:15.898854 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:24:15.901105 [debug] [MainThread]: On master: COMMIT
[0m17:24:15.903601 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:15.909214 [debug] [MainThread]: On master: COMMIT
[0m17:24:15.916216 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:24:15.923213 [debug] [MainThread]: On master: Close
[0m17:24:15.927012 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:24:15.931426 [info ] [MainThread]: 
[0m17:24:15.938604 [debug] [Thread-1 (]: Began running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m17:24:15.939104 [debug] [Thread-2 (]: Began running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m17:24:15.939717 [debug] [Thread-3 (]: Began running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m17:24:15.940118 [debug] [Thread-4 (]: Began running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m17:24:15.943629 [info ] [Thread-1 (]: 1 of 7 START test not_null_stg_orders_order_id ................................. [RUN]
[0m17:24:15.945972 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_orders_region ................................... [RUN]
[0m17:24:15.949010 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_returns_order_id ................................ [RUN]
[0m17:24:15.950971 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_users_region .................................... [RUN]
[0m17:24:15.953225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1_raw, now test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m17:24:15.955575 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.superstore_project.not_null_stg_orders_region.c7b18a6907'
[0m17:24:15.958408 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e'
[0m17:24:15.963328 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_project.not_null_stg_users_region.97049f06a2'
[0m17:24:15.966032 [debug] [Thread-1 (]: Began compiling node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m17:24:15.968449 [debug] [Thread-2 (]: Began compiling node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m17:24:15.970351 [debug] [Thread-3 (]: Began compiling node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m17:24:15.973185 [debug] [Thread-4 (]: Began compiling node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m17:24:15.992309 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:24:15.996908 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m17:24:16.002888 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m17:24:16.008529 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m17:24:16.035818 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (compile): 17:24:15.975233 => 17:24:16.035207
[0m17:24:16.039117 [debug] [Thread-1 (]: Began executing node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m17:24:16.040281 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (compile): 17:24:16.005315 => 17:24:16.039715
[0m17:24:16.071635 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:24:16.073850 [debug] [Thread-4 (]: Began executing node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m17:24:16.074484 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (compile): 17:24:15.993585 => 17:24:16.074225
[0m17:24:16.076800 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (compile): 17:24:15.999564 => 17:24:16.076486
[0m17:24:16.082947 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m17:24:16.086996 [debug] [Thread-2 (]: Began executing node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m17:24:16.090198 [debug] [Thread-3 (]: Began executing node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m17:24:16.104346 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m17:24:16.112540 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m17:24:16.121581 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:24:16.129375 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m17:24:16.131684 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m17:24:16.134663 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m17:24:16.135254 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: BEGIN
[0m17:24:16.140458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:16.148972 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m17:24:16.152056 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: BEGIN
[0m17:24:16.157803 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:24:16.169806 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: BEGIN
[0m17:24:16.174491 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:24:16.178547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:24:16.180241 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:24:16.186008 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m17:24:16.186585 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:24:16.191146 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:24:16.192027 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres_metabase1"."raw"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m17:24:16.194442 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m17:24:16.197927 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:24:16.198827 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m17:24:16.203092 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_users_region.97049f06a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "postgres_metabase1"."raw"."stg_users"
where region is null



      
    ) dbt_internal_test
[0m17:24:16.205330 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m17:24:16.208431 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_orders_region.c7b18a6907"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "postgres_metabase1"."raw"."stg_orders"
where region is null



      
    ) dbt_internal_test
[0m17:24:16.212557 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:24:16.214277 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres_metabase1"."raw"."stg_returns"
where order_id is null



      
    ) dbt_internal_test
[0m17:24:16.221296 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (execute): 17:24:16.079506 => 17:24:16.220866
[0m17:24:16.227272 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:24:16.228453 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:24:16.228913 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: ROLLBACK
[0m17:24:16.229286 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:24:16.233752 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (execute): 17:24:16.108956 => 17:24:16.233331
[0m17:24:16.239519 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (execute): 17:24:16.099668 => 17:24:16.238878
[0m17:24:16.243159 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: Close
[0m17:24:16.245858 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (execute): 17:24:16.047259 => 17:24:16.245646
[0m17:24:16.249032 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: ROLLBACK
[0m17:24:16.252572 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: ROLLBACK
[0m17:24:16.255264 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_users_region .......................................... [[32mPASS[0m in 0.29s]
[0m17:24:16.256940 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m17:24:16.262268 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: Close
[0m17:24:16.264014 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: Close
[0m17:24:16.267135 [debug] [Thread-4 (]: Finished running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m17:24:16.269990 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m17:24:16.272171 [info ] [Thread-3 (]: 3 of 7 PASS not_null_stg_returns_order_id ...................................... [[32mPASS[0m in 0.31s]
[0m17:24:16.274819 [info ] [Thread-2 (]: 2 of 7 PASS not_null_stg_orders_region ......................................... [[32mPASS[0m in 0.32s]
[0m17:24:16.280024 [debug] [Thread-4 (]: Began running node test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8
[0m17:24:16.283439 [info ] [Thread-1 (]: 1 of 7 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.33s]
[0m17:24:16.286336 [debug] [Thread-3 (]: Finished running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m17:24:16.288558 [debug] [Thread-2 (]: Finished running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m17:24:16.291393 [info ] [Thread-4 (]: 5 of 7 START test unique_final_orders_with_returns_order_id .................... [RUN]
[0m17:24:16.293150 [debug] [Thread-1 (]: Finished running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m17:24:16.295133 [debug] [Thread-3 (]: Began running node test.superstore_project.unique_stg_orders_order_id.e3b841c71a
[0m17:24:16.297639 [debug] [Thread-2 (]: Began running node test.superstore_project.unique_stg_users_region.b6aeae0132
[0m17:24:16.300163 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_users_region.97049f06a2, now test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8)
[0m17:24:16.305165 [info ] [Thread-3 (]: 6 of 7 START test unique_stg_orders_order_id ................................... [RUN]
[0m17:24:16.307842 [info ] [Thread-2 (]: 7 of 7 START test unique_stg_users_region ...................................... [RUN]
[0m17:24:16.310113 [debug] [Thread-4 (]: Began compiling node test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8
[0m17:24:16.315215 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e, now test.superstore_project.unique_stg_orders_order_id.e3b841c71a)
[0m17:24:16.318503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_region.c7b18a6907, now test.superstore_project.unique_stg_users_region.b6aeae0132)
[0m17:24:16.327004 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"
[0m17:24:16.328869 [debug] [Thread-3 (]: Began compiling node test.superstore_project.unique_stg_orders_order_id.e3b841c71a
[0m17:24:16.331264 [debug] [Thread-2 (]: Began compiling node test.superstore_project.unique_stg_users_region.b6aeae0132
[0m17:24:16.342474 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"
[0m17:24:16.348575 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_project.unique_stg_users_region.b6aeae0132"
[0m17:24:16.358447 [debug] [Thread-4 (]: Timing info for test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8 (compile): 17:24:16.320840 => 17:24:16.357925
[0m17:24:16.363779 [debug] [Thread-4 (]: Began executing node test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8
[0m17:24:16.365500 [debug] [Thread-3 (]: Timing info for test.superstore_project.unique_stg_orders_order_id.e3b841c71a (compile): 17:24:16.335834 => 17:24:16.364692
[0m17:24:16.371528 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"
[0m17:24:16.377504 [debug] [Thread-3 (]: Began executing node test.superstore_project.unique_stg_orders_order_id.e3b841c71a
[0m17:24:16.379916 [debug] [Thread-2 (]: Timing info for test.superstore_project.unique_stg_users_region.b6aeae0132 (compile): 17:24:16.344394 => 17:24:16.378874
[0m17:24:16.394832 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"
[0m17:24:16.397322 [debug] [Thread-2 (]: Began executing node test.superstore_project.unique_stg_users_region.b6aeae0132
[0m17:24:16.450546 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_project.unique_stg_users_region.b6aeae0132"
[0m17:24:16.454711 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"
[0m17:24:16.458745 [debug] [Thread-4 (]: On test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8: BEGIN
[0m17:24:16.460095 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"
[0m17:24:16.464008 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:24:16.467514 [debug] [Thread-3 (]: On test.superstore_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m17:24:16.471924 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.unique_stg_users_region.b6aeae0132"
[0m17:24:16.478953 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:24:16.485598 [debug] [Thread-2 (]: On test.superstore_project.unique_stg_users_region.b6aeae0132: BEGIN
[0m17:24:16.489252 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:24:16.491998 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:24:16.493966 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"
[0m17:24:16.494981 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:24:16.497900 [debug] [Thread-4 (]: On test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres_metabase1"."raw"."final_orders_with_returns"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:24:16.500277 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"
[0m17:24:16.501532 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:24:16.506785 [debug] [Thread-3 (]: On test.superstore_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres_metabase1"."raw"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:24:16.509378 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.unique_stg_users_region.b6aeae0132"
[0m17:24:16.515341 [debug] [Thread-2 (]: On test.superstore_project.unique_stg_users_region.b6aeae0132: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.unique_stg_users_region.b6aeae0132"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from "postgres_metabase1"."raw"."stg_users"
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m17:24:16.519622 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:24:16.520335 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:24:16.521102 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:24:16.524293 [debug] [Thread-3 (]: Timing info for test.superstore_project.unique_stg_orders_order_id.e3b841c71a (execute): 17:24:16.387606 => 17:24:16.524081
[0m17:24:16.527964 [debug] [Thread-2 (]: Timing info for test.superstore_project.unique_stg_users_region.b6aeae0132 (execute): 17:24:16.402166 => 17:24:16.527753
[0m17:24:16.531356 [debug] [Thread-4 (]: Timing info for test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8 (execute): 17:24:16.368366 => 17:24:16.531149
[0m17:24:16.533749 [debug] [Thread-3 (]: On test.superstore_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m17:24:16.536375 [debug] [Thread-2 (]: On test.superstore_project.unique_stg_users_region.b6aeae0132: ROLLBACK
[0m17:24:16.538829 [debug] [Thread-4 (]: On test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8: ROLLBACK
[0m17:24:16.541265 [debug] [Thread-3 (]: On test.superstore_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m17:24:16.543931 [debug] [Thread-2 (]: On test.superstore_project.unique_stg_users_region.b6aeae0132: Close
[0m17:24:16.546355 [debug] [Thread-4 (]: On test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8: Close
[0m17:24:16.548349 [error] [Thread-3 (]: 6 of 7 FAIL 2156 unique_stg_orders_order_id .................................... [[31mFAIL 2156[0m in 0.23s]
[0m17:24:16.550562 [info ] [Thread-2 (]: 7 of 7 PASS unique_stg_users_region ............................................ [[32mPASS[0m in 0.23s]
[0m17:24:16.552436 [error] [Thread-4 (]: 5 of 7 FAIL 2156 unique_final_orders_with_returns_order_id ..................... [[31mFAIL 2156[0m in 0.25s]
[0m17:24:16.553913 [debug] [Thread-3 (]: Finished running node test.superstore_project.unique_stg_orders_order_id.e3b841c71a
[0m17:24:16.556481 [debug] [Thread-2 (]: Finished running node test.superstore_project.unique_stg_users_region.b6aeae0132
[0m17:24:16.558597 [debug] [Thread-4 (]: Finished running node test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8
[0m17:24:16.566267 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:16.568073 [debug] [MainThread]: On master: BEGIN
[0m17:24:16.569926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:24:16.579577 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:24:16.581769 [debug] [MainThread]: On master: COMMIT
[0m17:24:16.583376 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:16.585352 [debug] [MainThread]: On master: COMMIT
[0m17:24:16.587486 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:24:16.589758 [debug] [MainThread]: On master: Close
[0m17:24:16.593896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:16.597376 [debug] [MainThread]: Connection 'test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m17:24:16.599518 [debug] [MainThread]: Connection 'test.superstore_project.unique_stg_users_region.b6aeae0132' was properly closed.
[0m17:24:16.602248 [debug] [MainThread]: Connection 'test.superstore_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m17:24:16.605168 [debug] [MainThread]: Connection 'test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8' was properly closed.
[0m17:24:16.608389 [info ] [MainThread]: 
[0m17:24:16.611755 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m17:24:16.614251 [debug] [MainThread]: Command end result
[0m17:24:16.669915 [info ] [MainThread]: 
[0m17:24:16.673227 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:24:16.675173 [info ] [MainThread]: 
[0m17:24:16.679395 [error] [MainThread]: [31mFailure in test unique_stg_orders_order_id (models/schema.yml)[0m
[0m17:24:16.684197 [error] [MainThread]:   Got 2156 results, configured to fail if != 0
[0m17:24:16.687105 [info ] [MainThread]: 
[0m17:24:16.688870 [info ] [MainThread]:   compiled Code at target/compiled/superstore_project/models/schema.yml/unique_stg_orders_order_id.sql
[0m17:24:16.690920 [info ] [MainThread]: 
[0m17:24:16.692452 [error] [MainThread]: [31mFailure in test unique_final_orders_with_returns_order_id (models/schema.yml)[0m
[0m17:24:16.694472 [error] [MainThread]:   Got 2156 results, configured to fail if != 0
[0m17:24:16.696810 [info ] [MainThread]: 
[0m17:24:16.699201 [info ] [MainThread]:   compiled Code at target/compiled/superstore_project/models/schema.yml/unique_final_orders_with_returns_order_id.sql
[0m17:24:16.701609 [info ] [MainThread]: 
[0m17:24:16.703568 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m17:24:16.706200 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.5290976, "process_user_time": 2.461286, "process_kernel_time": 0.304532, "process_mem_max_rss": "105100", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:24:16.708141 [debug] [MainThread]: Command `dbt test` failed at 17:24:16.707931 after 2.53 seconds
[0m17:24:16.710383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1f32956290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1f2efff190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1f2f02b490>]}
[0m17:24:16.712641 [debug] [MainThread]: Flushing usage events
[0m13:37:53.537644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c683d024d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c683ce64b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c683f705990>]}


============================== 13:37:53.568848 | fd72b47d-e1dc-447f-b512-50b94aa887a4 ==============================
[0m13:37:53.568848 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:37:53.582873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ovp/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:37:54.136050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd72b47d-e1dc-447f-b512-50b94aa887a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c683c9a2650>]}
[0m13:37:54.164909 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:37:54.245062 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:37:54.280154 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.989643, "process_user_time": 2.945426, "process_kernel_time": 0.219383, "process_mem_max_rss": "103392", "process_in_blocks": "872", "process_out_blocks": "0"}
[0m13:37:54.287045 [debug] [MainThread]: Command `cli deps` succeeded at 13:37:54.286691 after 1.00 seconds
[0m13:37:54.300272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c683d6aa950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c683c9e86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c683cfc2190>]}
[0m13:37:54.306559 [debug] [MainThread]: Flushing usage events
[0m09:47:07.614752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5662e8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5662f2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d56605f210>]}


============================== 09:47:07.623599 | 2392ab8f-60e1-4b0b-a63c-35fbb6bc0070 ==============================
[0m09:47:07.623599 [info ] [MainThread]: Running with dbt=1.7.8
[0m09:47:07.627071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ovp/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:47:07.973178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2392ab8f-60e1-4b0b-a63c-35fbb6bc0070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d565f45090>]}
[0m09:47:07.994877 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:47:08.044642 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:47:08.071689 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.59416157, "process_user_time": 3.280745, "process_kernel_time": 0.282342, "process_mem_max_rss": "102976", "process_in_blocks": "288", "process_out_blocks": "0"}
[0m09:47:08.077970 [debug] [MainThread]: Command `cli deps` succeeded at 09:47:08.077624 after 0.60 seconds
[0m09:47:08.083834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5660ae4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5660ae6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75d5660d3ed0>]}
[0m09:47:08.090584 [debug] [MainThread]: Flushing usage events
[0m19:11:54.050934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b55118d0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b55118ed090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b55118d3c90>]}


============================== 19:11:54.058460 | bff5131a-53b2-4c7d-8014-8d7dde155150 ==============================
[0m19:11:54.058460 [info ] [MainThread]: Running with dbt=1.7.8
[0m19:11:54.063305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ovp/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:11:54.302190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bff5131a-53b2-4c7d-8014-8d7dde155150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b55118f7110>]}
[0m19:11:54.322373 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:11:54.362567 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:11:54.380973 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43167567, "process_user_time": 1.811013, "process_kernel_time": 0.185125, "process_mem_max_rss": "103176", "process_in_blocks": "872", "process_out_blocks": "0"}
[0m19:11:54.385910 [debug] [MainThread]: Command `cli deps` succeeded at 19:11:54.385728 after 0.44 seconds
[0m19:11:54.389802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b55118f6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5511f14510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b5511e3fe50>]}
[0m19:11:54.395779 [debug] [MainThread]: Flushing usage events
[0m10:43:19.369102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5e5f0e4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5e5f41a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5e5f0ace10>]}


============================== 10:43:19.375191 | 66ae4957-ae31-4a1a-976e-e0803e2ab907 ==============================
[0m10:43:19.375191 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:43:19.378451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/ovp/.dbt', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m10:43:19.567581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66ae4957-ae31-4a1a-976e-e0803e2ab907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5e5f692450>]}
[0m10:43:19.578718 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:43:19.600002 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:43:19.612448 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.331827, "process_user_time": 1.715109, "process_kernel_time": 0.136739, "process_mem_max_rss": "103656", "process_in_blocks": "72", "process_out_blocks": "0"}
[0m10:43:19.617060 [debug] [MainThread]: Command `cli deps` succeeded at 10:43:19.616868 after 0.34 seconds
[0m10:43:19.620725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5e5f55f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5e5f0af650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5e5f537950>]}
[0m10:43:19.625807 [debug] [MainThread]: Flushing usage events
[0m12:40:26.090421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692e0f2bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692e0c04950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692e14dd8d0>]}


============================== 12:40:26.100672 | 63a8c387-345e-494d-aec0-102fdb9bda17 ==============================
[0m12:40:26.100672 [info ] [MainThread]: Running with dbt=1.7.8
[0m12:40:26.105386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/ovp/.dbt', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:40:26.473420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63a8c387-345e-494d-aec0-102fdb9bda17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692e0f349d0>]}
[0m12:40:26.510441 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:40:26.561209 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:40:26.578748 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5993056, "process_user_time": 3.065822, "process_kernel_time": 0.330101, "process_mem_max_rss": "103644", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:40:26.583234 [debug] [MainThread]: Command `cli deps` succeeded at 12:40:26.582847 after 0.60 seconds
[0m12:40:26.587379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692e0970b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692e084c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7692e0af8150>]}
[0m12:40:26.590881 [debug] [MainThread]: Flushing usage events
[0m13:52:53.962985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748569e03730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7485680bb1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7485680b9a50>]}


============================== 13:52:53.969779 | 65821a50-be12-4a5e-b944-c13ebe05a144 ==============================
[0m13:52:53.969779 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:52:53.971297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:52:54.216364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65821a50-be12-4a5e-b944-c13ebe05a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7485680baec0>]}
[0m13:52:54.301126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65821a50-be12-4a5e-b944-c13ebe05a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7485667a3c70>]}
[0m13:52:54.305471 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:52:54.343765 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:52:55.174979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:52:55.178139 [debug] [MainThread]: Partial parsing: added file: superstore_project://models/marts/mart_orders_summary_by_region.sql
[0m13:52:55.341852 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- models.marts
[0m13:52:55.349506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65821a50-be12-4a5e-b944-c13ebe05a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7485640c80d0>]}
[0m13:52:55.526498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65821a50-be12-4a5e-b944-c13ebe05a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74856654bc70>]}
[0m13:52:55.540458 [info ] [MainThread]: Found 5 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:52:55.551846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65821a50-be12-4a5e-b944-c13ebe05a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74856654beb0>]}
[0m13:52:55.558691 [info ] [MainThread]: 
[0m13:52:55.565411 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:52:55.572370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m13:52:55.598508 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m13:52:55.601108 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m13:52:55.602699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:55.653267 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m13:52:55.658614 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m13:52:55.664288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now list_postgres_metabase1_raw)
[0m13:52:55.677645 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m13:52:55.679664 [debug] [ThreadPool]: On list_postgres_metabase1_raw: BEGIN
[0m13:52:55.681224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:55.692489 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:52:55.694497 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m13:52:55.696525 [debug] [ThreadPool]: On list_postgres_metabase1_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1_raw"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m13:52:55.707321 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m13:52:55.723631 [debug] [ThreadPool]: On list_postgres_metabase1_raw: ROLLBACK
[0m13:52:55.730068 [debug] [ThreadPool]: On list_postgres_metabase1_raw: Close
[0m13:52:55.751060 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:55.754841 [debug] [MainThread]: On master: BEGIN
[0m13:52:55.759533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:55.788451 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:55.796115 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:55.803509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:52:55.831563 [debug] [MainThread]: SQL status: SELECT 31 in 0.0 seconds
[0m13:52:55.844111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65821a50-be12-4a5e-b944-c13ebe05a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748564103b20>]}
[0m13:52:55.850789 [debug] [MainThread]: On master: ROLLBACK
[0m13:52:55.857563 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:55.865094 [debug] [MainThread]: On master: BEGIN
[0m13:52:55.875426 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:55.884412 [debug] [MainThread]: On master: COMMIT
[0m13:52:55.892552 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:55.897996 [debug] [MainThread]: On master: COMMIT
[0m13:52:55.907750 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:52:55.916112 [debug] [MainThread]: On master: Close
[0m13:52:55.926471 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:52:55.935362 [info ] [MainThread]: 
[0m13:52:55.979132 [debug] [Thread-1 (]: Began running node model.superstore_project.stg_orders
[0m13:52:55.981504 [debug] [Thread-2 (]: Began running node model.superstore_project.stg_returns
[0m13:52:55.983001 [debug] [Thread-3 (]: Began running node model.superstore_project.stg_users
[0m13:52:55.986868 [info ] [Thread-1 (]: 1 of 5 START sql view model raw.stg_orders ..................................... [RUN]
[0m13:52:55.991923 [info ] [Thread-2 (]: 2 of 5 START sql view model raw.stg_returns .................................... [RUN]
[0m13:52:55.998477 [info ] [Thread-3 (]: 3 of 5 START sql view model raw.stg_users ...................................... [RUN]
[0m13:52:56.011592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1_raw, now model.superstore_project.stg_orders)
[0m13:52:56.024866 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.superstore_project.stg_returns'
[0m13:52:56.031245 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_project.stg_users'
[0m13:52:56.035334 [debug] [Thread-1 (]: Began compiling node model.superstore_project.stg_orders
[0m13:52:56.038470 [debug] [Thread-2 (]: Began compiling node model.superstore_project.stg_returns
[0m13:52:56.041524 [debug] [Thread-3 (]: Began compiling node model.superstore_project.stg_users
[0m13:52:56.052565 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.stg_orders"
[0m13:52:56.114731 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.stg_returns"
[0m13:52:56.120550 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.stg_users"
[0m13:52:56.165318 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (compile): 13:52:56.044937 => 13:52:56.164100
[0m13:52:56.172937 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (compile): 13:52:56.054038 => 13:52:56.171539
[0m13:52:56.175734 [debug] [Thread-1 (]: Began executing node model.superstore_project.stg_orders
[0m13:52:56.183545 [debug] [Thread-2 (]: Began executing node model.superstore_project.stg_returns
[0m13:52:56.187711 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (compile): 13:52:56.116873 => 13:52:56.186497
[0m13:52:56.275532 [debug] [Thread-3 (]: Began executing node model.superstore_project.stg_users
[0m13:52:56.342887 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.stg_returns"
[0m13:52:56.345897 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.stg_users"
[0m13:52:56.348870 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.stg_orders"
[0m13:52:56.365859 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m13:52:56.368108 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m13:52:56.369801 [debug] [Thread-3 (]: On model.superstore_project.stg_users: BEGIN
[0m13:52:56.373769 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: BEGIN
[0m13:52:56.389961 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m13:52:56.399869 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:52:56.411715 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:52:56.420828 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: BEGIN
[0m13:52:56.450476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:56.459781 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:52:56.466328 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:52:56.470602 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m13:52:56.476634 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m13:52:56.477833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:52:56.482646 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */

  create view "postgres_metabase1"."raw"."stg_users__dbt_tmp"
    
    
  as (
    WITH raw_users AS (
    SELECT
        region,
        manager
    FROM "postgres_metabase1"."raw"."managers"
)
SELECT *
FROM raw_users
  );
[0m13:52:56.489801 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */

  create view "postgres_metabase1"."raw"."stg_returns__dbt_tmp"
    
    
  as (
    WITH raw_returns AS (
    SELECT
        order_id,
        status
    FROM "postgres_metabase1"."raw"."returns"
)
SELECT *
FROM raw_returns
  );
[0m13:52:56.498552 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m13:52:56.515405 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:52:56.522132 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */

  create view "postgres_metabase1"."raw"."stg_orders__dbt_tmp"
    
    
  as (
    WITH raw_orders AS (
    SELECT
        row_id,
        order_id,
        order_date,
        ship_date,
        ship_mode,
        order_priority,
        product_container,
        customer_name,
        customer_segment,
        zip_code,
        state,
        city,
        region,
        product_category,
        product_subcategory,
        product_name,
        unit_price,
        quantity AS order_quantity,
        sales,
        profit,
        discount,
        shipping_cost,
        product_base_margin
    FROM "postgres_metabase1"."raw"."orders"
)
SELECT *
FROM raw_orders
  );
[0m13:52:56.524126 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:52:56.550504 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m13:52:56.561278 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:52:56.564819 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m13:52:56.571214 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
alter table "postgres_metabase1"."raw"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:52:56.583235 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m13:52:56.586445 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
alter table "postgres_metabase1"."raw"."stg_returns__dbt_tmp" rename to "stg_returns"
[0m13:52:56.591524 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:56.593152 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
alter table "postgres_metabase1"."raw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:52:56.596989 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:56.623671 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m13:52:56.624123 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:56.625929 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m13:52:56.627930 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m13:52:56.632415 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m13:52:56.634780 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m13:52:56.636946 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m13:52:56.639080 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m13:52:56.642087 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m13:52:56.646797 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m13:52:56.648745 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:52:56.651284 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:52:56.658271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:52:56.661777 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_users__dbt_backup"
[0m13:52:56.667210 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_returns__dbt_backup"
[0m13:52:56.671953 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_orders__dbt_backup"
[0m13:52:56.677907 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m13:52:56.680422 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m13:52:56.682900 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m13:52:56.685839 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
drop view if exists "postgres_metabase1"."raw"."stg_users__dbt_backup" cascade
[0m13:52:56.688048 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
drop view if exists "postgres_metabase1"."raw"."stg_returns__dbt_backup" cascade
[0m13:52:56.689999 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
drop view if exists "postgres_metabase1"."raw"."stg_orders__dbt_backup" cascade
[0m13:52:56.691915 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:52:56.693336 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:52:56.694725 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:52:56.696940 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (execute): 13:52:56.307165 => 13:52:56.696775
[0m13:52:56.700038 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (execute): 13:52:56.220122 => 13:52:56.699862
[0m13:52:56.703470 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (execute): 13:52:56.194001 => 13:52:56.703306
[0m13:52:56.705045 [debug] [Thread-3 (]: On model.superstore_project.stg_users: Close
[0m13:52:56.706562 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: Close
[0m13:52:56.708051 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: Close
[0m13:52:56.710043 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65821a50-be12-4a5e-b944-c13ebe05a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74852b90aec0>]}
[0m13:52:56.711828 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65821a50-be12-4a5e-b944-c13ebe05a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7485640ef070>]}
[0m13:52:56.713426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65821a50-be12-4a5e-b944-c13ebe05a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74856417a560>]}
[0m13:52:56.714702 [info ] [Thread-3 (]: 3 of 5 OK created sql view model raw.stg_users ................................. [[32mCREATE VIEW[0m in 0.68s]
[0m13:52:56.718459 [info ] [Thread-2 (]: 2 of 5 OK created sql view model raw.stg_returns ............................... [[32mCREATE VIEW[0m in 0.69s]
[0m13:52:56.723259 [info ] [Thread-1 (]: 1 of 5 OK created sql view model raw.stg_orders ................................ [[32mCREATE VIEW[0m in 0.70s]
[0m13:52:56.725778 [debug] [Thread-3 (]: Finished running node model.superstore_project.stg_users
[0m13:52:56.731485 [debug] [Thread-2 (]: Finished running node model.superstore_project.stg_returns
[0m13:52:56.742908 [debug] [Thread-1 (]: Finished running node model.superstore_project.stg_orders
[0m13:52:56.760315 [debug] [Thread-4 (]: Began running node model.superstore_project.final_orders_with_returns
[0m13:52:56.761631 [debug] [Thread-3 (]: Began running node model.superstore_project.mart_orders_summary_by_region
[0m13:52:56.765184 [info ] [Thread-4 (]: 4 of 5 START sql view model raw.final_orders_with_returns ...................... [RUN]
[0m13:52:56.770800 [info ] [Thread-3 (]: 5 of 5 START sql view model raw.mart_orders_summary_by_region .................. [RUN]
[0m13:52:56.775185 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_project.final_orders_with_returns'
[0m13:52:56.783492 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_users, now model.superstore_project.mart_orders_summary_by_region)
[0m13:52:56.790228 [debug] [Thread-4 (]: Began compiling node model.superstore_project.final_orders_with_returns
[0m13:52:56.795780 [debug] [Thread-3 (]: Began compiling node model.superstore_project.mart_orders_summary_by_region
[0m13:52:56.803773 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.final_orders_with_returns"
[0m13:52:56.811271 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.mart_orders_summary_by_region"
[0m13:52:56.830526 [debug] [Thread-4 (]: Timing info for model.superstore_project.final_orders_with_returns (compile): 13:52:56.799048 => 13:52:56.830204
[0m13:52:56.833484 [debug] [Thread-4 (]: Began executing node model.superstore_project.final_orders_with_returns
[0m13:52:56.838489 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_project.final_orders_with_returns"
[0m13:52:56.839442 [debug] [Thread-3 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (compile): 13:52:56.806342 => 13:52:56.839197
[0m13:52:56.843233 [debug] [Thread-3 (]: Began executing node model.superstore_project.mart_orders_summary_by_region
[0m13:52:56.854732 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.mart_orders_summary_by_region"
[0m13:52:56.869199 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m13:52:56.871762 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m13:52:56.872306 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: BEGIN
[0m13:52:56.875175 [debug] [Thread-3 (]: On model.superstore_project.mart_orders_summary_by_region: BEGIN
[0m13:52:56.878039 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:52:56.881143 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:52:56.892583 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:52:56.893858 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:52:56.895500 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m13:52:56.899838 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m13:52:56.902834 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */

  create view "postgres_metabase1"."raw"."final_orders_with_returns__dbt_tmp"
    
    
  as (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."raw"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."raw"."stg_returns" r
    ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."raw"."stg_users" u
    ON o.region = u.region
)
SELECT *
FROM orders_with_returns
  );
[0m13:52:56.905018 [debug] [Thread-3 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */

  create view "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_tmp"
    
    
  as (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."raw"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."raw"."stg_returns" r ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."raw"."stg_users" u ON o.region = u.region
),

region_summary AS (
    SELECT
        region,
        region_manager,
        COUNT(DISTINCT order_id) AS total_orders,
        COUNT(DISTINCT CASE WHEN return_status = 'Returned' THEN order_id END) AS returned_orders,
        ROUND(100.0 * COUNT(DISTINCT CASE WHEN return_status = 'Returned' THEN order_id END) / NULLIF(COUNT(DISTINCT order_id), 0), 2) AS return_rate_percent,
        SUM(sales) AS total_sales,
        SUM(profit) AS total_profit,
        ROUND(AVG(discount), 4) AS avg_discount
    FROM orders_with_returns
    GROUP BY region, region_manager
)

SELECT *
FROM region_summary
ORDER BY return_rate_percent DESC
  );
[0m13:52:56.910756 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:52:56.917098 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m13:52:56.917780 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:52:56.919494 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
alter table "postgres_metabase1"."raw"."final_orders_with_returns__dbt_tmp" rename to "final_orders_with_returns"
[0m13:52:56.926732 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m13:52:56.930552 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:56.932739 [debug] [Thread-3 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
alter table "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_tmp" rename to "mart_orders_summary_by_region"
[0m13:52:56.937886 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m13:52:56.943003 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:56.945712 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m13:52:56.952253 [debug] [Thread-3 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m13:52:56.956639 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m13:52:56.960435 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m13:52:56.967155 [debug] [Thread-3 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m13:52:56.968340 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:52:56.970309 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:52:56.975416 [debug] [Thread-4 (]: Applying DROP to: "postgres_metabase1"."raw"."final_orders_with_returns__dbt_backup"
[0m13:52:56.981755 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_backup"
[0m13:52:56.988223 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m13:52:56.992108 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m13:52:56.996090 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
drop view if exists "postgres_metabase1"."raw"."final_orders_with_returns__dbt_backup" cascade
[0m13:52:57.001077 [debug] [Thread-3 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
drop view if exists "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_backup" cascade
[0m13:52:57.005225 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:52:57.008252 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:52:57.012301 [debug] [Thread-4 (]: Timing info for model.superstore_project.final_orders_with_returns (execute): 13:52:56.834846 => 13:52:57.012000
[0m13:52:57.016997 [debug] [Thread-3 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (execute): 13:52:56.846478 => 13:52:57.016392
[0m13:52:57.020401 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: Close
[0m13:52:57.023658 [debug] [Thread-3 (]: On model.superstore_project.mart_orders_summary_by_region: Close
[0m13:52:57.027779 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65821a50-be12-4a5e-b944-c13ebe05a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74852b939660>]}
[0m13:52:57.032777 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65821a50-be12-4a5e-b944-c13ebe05a144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74852b98fa60>]}
[0m13:52:57.036768 [info ] [Thread-4 (]: 4 of 5 OK created sql view model raw.final_orders_with_returns ................. [[32mCREATE VIEW[0m in 0.25s]
[0m13:52:57.043772 [info ] [Thread-3 (]: 5 of 5 OK created sql view model raw.mart_orders_summary_by_region ............. [[32mCREATE VIEW[0m in 0.25s]
[0m13:52:57.055975 [debug] [Thread-4 (]: Finished running node model.superstore_project.final_orders_with_returns
[0m13:52:57.062708 [debug] [Thread-3 (]: Finished running node model.superstore_project.mart_orders_summary_by_region
[0m13:52:57.077541 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:57.082297 [debug] [MainThread]: On master: BEGIN
[0m13:52:57.087600 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:57.101577 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:57.105972 [debug] [MainThread]: On master: COMMIT
[0m13:52:57.112086 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:57.118430 [debug] [MainThread]: On master: COMMIT
[0m13:52:57.125463 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:52:57.134191 [debug] [MainThread]: On master: Close
[0m13:52:57.144150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:57.152654 [debug] [MainThread]: Connection 'model.superstore_project.stg_orders' was properly closed.
[0m13:52:57.160672 [debug] [MainThread]: Connection 'model.superstore_project.stg_returns' was properly closed.
[0m13:52:57.167158 [debug] [MainThread]: Connection 'model.superstore_project.mart_orders_summary_by_region' was properly closed.
[0m13:52:57.172819 [debug] [MainThread]: Connection 'model.superstore_project.final_orders_with_returns' was properly closed.
[0m13:52:57.178765 [info ] [MainThread]: 
[0m13:52:57.184753 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.61 seconds (1.61s).
[0m13:52:57.192565 [debug] [MainThread]: Command end result
[0m13:52:57.345262 [info ] [MainThread]: 
[0m13:52:57.355155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:57.363694 [info ] [MainThread]: 
[0m13:52:57.366625 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:52:57.371957 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.6044896, "process_user_time": 3.369969, "process_kernel_time": 0.47171, "process_mem_max_rss": "108724", "process_in_blocks": "87696", "process_out_blocks": "664"}
[0m13:52:57.378679 [debug] [MainThread]: Command `dbt run` succeeded at 13:52:57.377457 after 3.61 seconds
[0m13:52:57.381970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748569e03730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7485640ef070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7485680baec0>]}
[0m13:52:57.385879 [debug] [MainThread]: Flushing usage events
[0m13:53:10.868500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f928aa6e740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9288cda1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9288cda140>]}


============================== 13:53:10.878963 | eb814baf-8e1b-4cb8-8e67-5055e0c6cb9f ==============================
[0m13:53:10.878963 [info ] [MainThread]: Running with dbt=1.7.4
[0m13:53:10.881561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:53:11.186210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb814baf-8e1b-4cb8-8e67-5055e0c6cb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9288cda290>]}
[0m13:53:11.273390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb814baf-8e1b-4cb8-8e67-5055e0c6cb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f928727fca0>]}
[0m13:53:11.277143 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m13:53:11.310806 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m13:53:11.887980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:53:11.891356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:53:11.895260 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m13:53:11.902946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb814baf-8e1b-4cb8-8e67-5055e0c6cb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92870797b0>]}
[0m13:53:11.938186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb814baf-8e1b-4cb8-8e67-5055e0c6cb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92872482b0>]}
[0m13:53:11.947980 [info ] [MainThread]: Found 5 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m13:53:11.953842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb814baf-8e1b-4cb8-8e67-5055e0c6cb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92872484f0>]}
[0m13:53:11.967217 [info ] [MainThread]: 
[0m13:53:11.978802 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:53:11.992104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1_raw'
[0m13:53:12.025752 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m13:53:12.032102 [debug] [ThreadPool]: On list_postgres_metabase1_raw: BEGIN
[0m13:53:12.038718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:12.079347 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:53:12.089398 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m13:53:12.097618 [debug] [ThreadPool]: On list_postgres_metabase1_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1_raw"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m13:53:12.118493 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:53:12.126708 [debug] [ThreadPool]: On list_postgres_metabase1_raw: ROLLBACK
[0m13:53:12.133499 [debug] [ThreadPool]: On list_postgres_metabase1_raw: Close
[0m13:53:12.158789 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:12.162828 [debug] [MainThread]: On master: BEGIN
[0m13:53:12.167599 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:53:12.180673 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:53:12.183406 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:12.186966 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:53:12.203248 [debug] [MainThread]: SQL status: SELECT 40 in 0.0 seconds
[0m13:53:12.216562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb814baf-8e1b-4cb8-8e67-5055e0c6cb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92870b2290>]}
[0m13:53:12.221890 [debug] [MainThread]: On master: ROLLBACK
[0m13:53:12.227904 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:12.234187 [debug] [MainThread]: On master: BEGIN
[0m13:53:12.243860 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:53:12.250650 [debug] [MainThread]: On master: COMMIT
[0m13:53:12.254810 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:12.260917 [debug] [MainThread]: On master: COMMIT
[0m13:53:12.267802 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:53:12.273662 [debug] [MainThread]: On master: Close
[0m13:53:12.280751 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:53:12.283140 [info ] [MainThread]: 
[0m13:53:12.291341 [debug] [Thread-1 (]: Began running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:53:12.291776 [debug] [Thread-2 (]: Began running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m13:53:12.292347 [debug] [Thread-3 (]: Began running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m13:53:12.292782 [debug] [Thread-4 (]: Began running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m13:53:12.293926 [info ] [Thread-1 (]: 1 of 7 START test not_null_stg_orders_order_id ................................. [RUN]
[0m13:53:12.296132 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_orders_region ................................... [RUN]
[0m13:53:12.298304 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_returns_order_id ................................ [RUN]
[0m13:53:12.299642 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_users_region .................................... [RUN]
[0m13:53:12.301663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1_raw, now test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:53:12.303541 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.superstore_project.not_null_stg_orders_region.c7b18a6907'
[0m13:53:12.306352 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e'
[0m13:53:12.308848 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_project.not_null_stg_users_region.97049f06a2'
[0m13:53:12.311150 [debug] [Thread-1 (]: Began compiling node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:53:12.312779 [debug] [Thread-2 (]: Began compiling node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m13:53:12.314567 [debug] [Thread-3 (]: Began compiling node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m13:53:12.316341 [debug] [Thread-4 (]: Began compiling node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m13:53:12.337339 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:53:12.342615 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m13:53:12.352251 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m13:53:12.359293 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m13:53:12.378913 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (compile): 13:53:12.318649 => 13:53:12.378133
[0m13:53:12.383157 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (compile): 13:53:12.354439 => 13:53:12.382609
[0m13:53:12.383749 [debug] [Thread-1 (]: Began executing node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:53:12.387133 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (compile): 13:53:12.337784 => 13:53:12.386905
[0m13:53:12.388537 [debug] [Thread-4 (]: Began executing node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m13:53:12.389051 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (compile): 13:53:12.345743 => 13:53:12.388844
[0m13:53:12.420134 [debug] [Thread-2 (]: Began executing node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m13:53:12.428791 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:53:12.436365 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m13:53:12.442757 [debug] [Thread-3 (]: Began executing node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m13:53:12.453539 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m13:53:12.478268 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m13:53:12.489603 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:53:12.491364 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m13:53:12.494412 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m13:53:12.496939 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:53:12.504357 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m13:53:12.506723 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: BEGIN
[0m13:53:12.512780 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: BEGIN
[0m13:53:12.521166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:12.525089 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: BEGIN
[0m13:53:12.529275 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:53:12.532425 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:53:12.540134 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:53:12.550788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:53:12.553188 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:53:12.553702 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:53:12.555376 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:53:12.555771 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres_metabase1"."raw"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m13:53:12.556514 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:53:12.557755 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m13:53:12.559685 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m13:53:12.563054 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m13:53:12.564534 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:53:12.565256 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_users_region.97049f06a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "postgres_metabase1"."raw"."stg_users"
where region is null



      
    ) dbt_internal_test
[0m13:53:12.567377 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_orders_region.c7b18a6907"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "postgres_metabase1"."raw"."stg_orders"
where region is null



      
    ) dbt_internal_test
[0m13:53:12.569155 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres_metabase1"."raw"."stg_returns"
where order_id is null



      
    ) dbt_internal_test
[0m13:53:12.572752 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (execute): 13:53:12.394996 => 13:53:12.572539
[0m13:53:12.576856 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:53:12.579968 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:53:12.580340 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:53:12.581977 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:53:12.584888 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (execute): 13:53:12.432456 => 13:53:12.584610
[0m13:53:12.588320 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (execute): 13:53:12.448564 => 13:53:12.588117
[0m13:53:12.591650 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (execute): 13:53:12.471833 => 13:53:12.591427
[0m13:53:12.594013 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:53:12.595346 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: ROLLBACK
[0m13:53:12.597708 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: ROLLBACK
[0m13:53:12.599945 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: ROLLBACK
[0m13:53:12.603137 [info ] [Thread-1 (]: 1 of 7 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.30s]
[0m13:53:12.606336 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: Close
[0m13:53:12.608282 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: Close
[0m13:53:12.610251 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: Close
[0m13:53:12.612009 [debug] [Thread-1 (]: Finished running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:53:12.615051 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_users_region .......................................... [[32mPASS[0m in 0.31s]
[0m13:53:12.616547 [info ] [Thread-2 (]: 2 of 7 PASS not_null_stg_orders_region ......................................... [[32mPASS[0m in 0.31s]
[0m13:53:12.618849 [info ] [Thread-3 (]: 3 of 7 PASS not_null_stg_returns_order_id ...................................... [[32mPASS[0m in 0.31s]
[0m13:53:12.620417 [debug] [Thread-1 (]: Began running node test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8
[0m13:53:12.622459 [debug] [Thread-4 (]: Finished running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m13:53:12.624289 [debug] [Thread-2 (]: Finished running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m13:53:12.627215 [debug] [Thread-3 (]: Finished running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m13:53:12.629497 [info ] [Thread-1 (]: 5 of 7 START test unique_final_orders_with_returns_order_id .................... [RUN]
[0m13:53:12.631199 [debug] [Thread-4 (]: Began running node test.superstore_project.unique_stg_orders_order_id.e3b841c71a
[0m13:53:12.633055 [debug] [Thread-2 (]: Began running node test.superstore_project.unique_stg_users_region.b6aeae0132
[0m13:53:12.636327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64, now test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8)
[0m13:53:12.638512 [info ] [Thread-4 (]: 6 of 7 START test unique_stg_orders_order_id ................................... [RUN]
[0m13:53:12.641600 [info ] [Thread-2 (]: 7 of 7 START test unique_stg_users_region ...................................... [RUN]
[0m13:53:12.643353 [debug] [Thread-1 (]: Began compiling node test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8
[0m13:53:12.645597 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_users_region.97049f06a2, now test.superstore_project.unique_stg_orders_order_id.e3b841c71a)
[0m13:53:12.647832 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_region.c7b18a6907, now test.superstore_project.unique_stg_users_region.b6aeae0132)
[0m13:53:12.655885 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"
[0m13:53:12.657459 [debug] [Thread-4 (]: Began compiling node test.superstore_project.unique_stg_orders_order_id.e3b841c71a
[0m13:53:12.659000 [debug] [Thread-2 (]: Began compiling node test.superstore_project.unique_stg_users_region.b6aeae0132
[0m13:53:12.669088 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:53:12.675439 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_project.unique_stg_users_region.b6aeae0132"
[0m13:53:12.678747 [debug] [Thread-1 (]: Timing info for test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8 (compile): 13:53:12.648951 => 13:53:12.678412
[0m13:53:12.680347 [debug] [Thread-1 (]: Began executing node test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8
[0m13:53:12.680978 [debug] [Thread-4 (]: Timing info for test.superstore_project.unique_stg_orders_order_id.e3b841c71a (compile): 13:53:12.661469 => 13:53:12.680779
[0m13:53:12.683910 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"
[0m13:53:12.684564 [debug] [Thread-2 (]: Timing info for test.superstore_project.unique_stg_users_region.b6aeae0132 (compile): 13:53:12.670113 => 13:53:12.684311
[0m13:53:12.687772 [debug] [Thread-4 (]: Began executing node test.superstore_project.unique_stg_orders_order_id.e3b841c71a
[0m13:53:12.693374 [debug] [Thread-2 (]: Began executing node test.superstore_project.unique_stg_users_region.b6aeae0132
[0m13:53:12.701026 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:53:12.747953 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_project.unique_stg_users_region.b6aeae0132"
[0m13:53:12.751157 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"
[0m13:53:12.755592 [debug] [Thread-1 (]: On test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8: BEGIN
[0m13:53:12.758310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:12.764458 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:53:12.767032 [debug] [Thread-4 (]: On test.superstore_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:53:12.767476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:53:12.769603 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.unique_stg_users_region.b6aeae0132"
[0m13:53:12.770174 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:53:12.773006 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"
[0m13:53:12.775587 [debug] [Thread-2 (]: On test.superstore_project.unique_stg_users_region.b6aeae0132: BEGIN
[0m13:53:12.781105 [debug] [Thread-1 (]: On test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres_metabase1"."raw"."final_orders_with_returns"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:53:12.783923 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:53:12.790818 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:53:12.795117 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:53:12.798108 [debug] [Thread-4 (]: On test.superstore_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres_metabase1"."raw"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:53:12.804193 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:53:12.806827 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.unique_stg_users_region.b6aeae0132"
[0m13:53:12.807511 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:53:12.809496 [debug] [Thread-2 (]: On test.superstore_project.unique_stg_users_region.b6aeae0132: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.unique_stg_users_region.b6aeae0132"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from "postgres_metabase1"."raw"."stg_users"
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m13:53:12.810431 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:53:12.814469 [debug] [Thread-1 (]: Timing info for test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8 (execute): 13:53:12.681658 => 13:53:12.813940
[0m13:53:12.819916 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:53:12.823705 [debug] [Thread-4 (]: Timing info for test.superstore_project.unique_stg_orders_order_id.e3b841c71a (execute): 13:53:12.695556 => 13:53:12.823262
[0m13:53:12.828665 [debug] [Thread-1 (]: On test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8: ROLLBACK
[0m13:53:12.839078 [debug] [Thread-2 (]: Timing info for test.superstore_project.unique_stg_users_region.b6aeae0132 (execute): 13:53:12.704848 => 13:53:12.838204
[0m13:53:12.847013 [debug] [Thread-4 (]: On test.superstore_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:53:12.856684 [debug] [Thread-1 (]: On test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8: Close
[0m13:53:12.861334 [debug] [Thread-2 (]: On test.superstore_project.unique_stg_users_region.b6aeae0132: ROLLBACK
[0m13:53:12.869924 [debug] [Thread-4 (]: On test.superstore_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:53:12.879367 [error] [Thread-1 (]: 5 of 7 FAIL 2156 unique_final_orders_with_returns_order_id ..................... [[31mFAIL 2156[0m in 0.24s]
[0m13:53:12.886973 [debug] [Thread-2 (]: On test.superstore_project.unique_stg_users_region.b6aeae0132: Close
[0m13:53:12.895483 [error] [Thread-4 (]: 6 of 7 FAIL 2156 unique_stg_orders_order_id .................................... [[31mFAIL 2156[0m in 0.25s]
[0m13:53:12.900204 [debug] [Thread-1 (]: Finished running node test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8
[0m13:53:12.902861 [info ] [Thread-2 (]: 7 of 7 PASS unique_stg_users_region ............................................ [[32mPASS[0m in 0.26s]
[0m13:53:12.908698 [debug] [Thread-4 (]: Finished running node test.superstore_project.unique_stg_orders_order_id.e3b841c71a
[0m13:53:12.931257 [debug] [Thread-2 (]: Finished running node test.superstore_project.unique_stg_users_region.b6aeae0132
[0m13:53:12.951155 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:12.956824 [debug] [MainThread]: On master: BEGIN
[0m13:53:12.962347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:53:12.991584 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:53:13.000083 [debug] [MainThread]: On master: COMMIT
[0m13:53:13.007035 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:13.015613 [debug] [MainThread]: On master: COMMIT
[0m13:53:13.025727 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:53:13.033986 [debug] [MainThread]: On master: Close
[0m13:53:13.046031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:13.056358 [debug] [MainThread]: Connection 'test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8' was properly closed.
[0m13:53:13.066090 [debug] [MainThread]: Connection 'test.superstore_project.unique_stg_users_region.b6aeae0132' was properly closed.
[0m13:53:13.075179 [debug] [MainThread]: Connection 'test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e' was properly closed.
[0m13:53:13.080543 [debug] [MainThread]: Connection 'test.superstore_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:53:13.087096 [info ] [MainThread]: 
[0m13:53:13.094167 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m13:53:13.099709 [debug] [MainThread]: Command end result
[0m13:53:13.163579 [info ] [MainThread]: 
[0m13:53:13.169048 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:53:13.172184 [info ] [MainThread]: 
[0m13:53:13.178843 [error] [MainThread]: [31mFailure in test unique_final_orders_with_returns_order_id (models/schema.yml)[0m
[0m13:53:13.182485 [error] [MainThread]:   Got 2156 results, configured to fail if != 0
[0m13:53:13.185311 [info ] [MainThread]: 
[0m13:53:13.188532 [info ] [MainThread]:   compiled Code at target/compiled/superstore_project/models/schema.yml/unique_final_orders_with_returns_order_id.sql
[0m13:53:13.191640 [info ] [MainThread]: 
[0m13:53:13.194773 [error] [MainThread]: [31mFailure in test unique_stg_orders_order_id (models/schema.yml)[0m
[0m13:53:13.197113 [error] [MainThread]:   Got 2156 results, configured to fail if != 0
[0m13:53:13.200284 [info ] [MainThread]: 
[0m13:53:13.203576 [info ] [MainThread]:   compiled Code at target/compiled/superstore_project/models/schema.yml/unique_stg_orders_order_id.sql
[0m13:53:13.206052 [info ] [MainThread]: 
[0m13:53:13.208337 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m13:53:13.211152 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.4252133, "process_user_time": 2.510549, "process_kernel_time": 0.241079, "process_mem_max_rss": "104148", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:53:13.214031 [debug] [MainThread]: Command `dbt test` failed at 13:53:13.213835 after 2.43 seconds
[0m13:53:13.216644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f928aa6e740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9288c5df00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9286f79930>]}
[0m13:53:13.219518 [debug] [MainThread]: Flushing usage events
[0m14:27:10.855595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a834b416740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a83496821a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8349682140>]}


============================== 14:27:10.890388 | f1c24ea7-69b1-4410-b649-7101ff4cce6d ==============================
[0m14:27:10.890388 [info ] [MainThread]: Running with dbt=1.7.4
[0m14:27:10.900270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/profiles', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:11.213346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1c24ea7-69b1-4410-b649-7101ff4cce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8349682290>]}
[0m14:27:11.301371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1c24ea7-69b1-4410-b649-7101ff4cce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8347c2fca0>]}
[0m14:27:11.307174 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m14:27:11.337544 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m14:27:12.281511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m14:27:12.285835 [debug] [MainThread]: Partial parsing: added file: superstore_project://models/marts/monthly_returns_trend.sql
[0m14:27:12.290040 [debug] [MainThread]: Partial parsing: added file: superstore_project://models/marts/product_performance.sql
[0m14:27:12.293959 [debug] [MainThread]: Partial parsing: added file: superstore_project://models/marts/top_customers.sql
[0m14:27:12.453571 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m14:27:12.464624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1c24ea7-69b1-4410-b649-7101ff4cce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a834793c0d0>]}
[0m14:27:12.785724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1c24ea7-69b1-4410-b649-7101ff4cce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8347bd7d60>]}
[0m14:27:12.794718 [info ] [MainThread]: Found 8 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:27:12.805796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1c24ea7-69b1-4410-b649-7101ff4cce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8347bd7fa0>]}
[0m14:27:12.818395 [info ] [MainThread]: 
[0m14:27:12.829538 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:27:12.839246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m14:27:12.858191 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m14:27:12.862621 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m14:27:12.866825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:12.921057 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m14:27:12.931886 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m14:27:12.947304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now list_postgres_metabase1_raw)
[0m14:27:12.972296 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m14:27:12.977084 [debug] [ThreadPool]: On list_postgres_metabase1_raw: BEGIN
[0m14:27:12.982573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:13.016231 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:27:13.022628 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m14:27:13.026771 [debug] [ThreadPool]: On list_postgres_metabase1_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1_raw"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m14:27:13.042288 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m14:27:13.050860 [debug] [ThreadPool]: On list_postgres_metabase1_raw: ROLLBACK
[0m14:27:13.058014 [debug] [ThreadPool]: On list_postgres_metabase1_raw: Close
[0m14:27:13.084352 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:13.087575 [debug] [MainThread]: On master: BEGIN
[0m14:27:13.090607 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:13.106565 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:27:13.110076 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:13.114182 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:27:13.135647 [debug] [MainThread]: SQL status: SELECT 40 in 0.0 seconds
[0m14:27:13.146830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1c24ea7-69b1-4410-b649-7101ff4cce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a83479af790>]}
[0m14:27:13.151721 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:13.157317 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:13.162841 [debug] [MainThread]: On master: BEGIN
[0m14:27:13.169912 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:27:13.176049 [debug] [MainThread]: On master: COMMIT
[0m14:27:13.182729 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:13.189644 [debug] [MainThread]: On master: COMMIT
[0m14:27:13.198811 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:27:13.205934 [debug] [MainThread]: On master: Close
[0m14:27:13.214421 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:27:13.222638 [info ] [MainThread]: 
[0m14:27:13.247548 [debug] [Thread-1 (]: Began running node model.superstore_project.stg_orders
[0m14:27:13.250202 [debug] [Thread-2 (]: Began running node model.superstore_project.stg_returns
[0m14:27:13.253621 [debug] [Thread-3 (]: Began running node model.superstore_project.stg_users
[0m14:27:13.261571 [info ] [Thread-1 (]: 1 of 8 START sql view model raw.stg_orders ..................................... [RUN]
[0m14:27:13.268043 [info ] [Thread-2 (]: 2 of 8 START sql view model raw.stg_returns .................................... [RUN]
[0m14:27:13.274217 [info ] [Thread-3 (]: 3 of 8 START sql view model raw.stg_users ...................................... [RUN]
[0m14:27:13.280476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1_raw, now model.superstore_project.stg_orders)
[0m14:27:13.290889 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.superstore_project.stg_returns'
[0m14:27:13.296234 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_project.stg_users'
[0m14:27:13.301111 [debug] [Thread-1 (]: Began compiling node model.superstore_project.stg_orders
[0m14:27:13.306042 [debug] [Thread-2 (]: Began compiling node model.superstore_project.stg_returns
[0m14:27:13.311139 [debug] [Thread-3 (]: Began compiling node model.superstore_project.stg_users
[0m14:27:13.330287 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.stg_orders"
[0m14:27:13.393641 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.stg_returns"
[0m14:27:13.398263 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.stg_users"
[0m14:27:13.456885 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (compile): 14:27:13.315722 => 14:27:13.454886
[0m14:27:13.467087 [debug] [Thread-1 (]: Began executing node model.superstore_project.stg_orders
[0m14:27:13.522807 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (compile): 14:27:13.331788 => 14:27:13.522488
[0m14:27:13.535620 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (compile): 14:27:13.395277 => 14:27:13.534992
[0m14:27:13.542322 [debug] [Thread-2 (]: Began executing node model.superstore_project.stg_returns
[0m14:27:13.547960 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.stg_orders"
[0m14:27:13.550744 [debug] [Thread-3 (]: Began executing node model.superstore_project.stg_users
[0m14:27:13.559424 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.stg_returns"
[0m14:27:13.568598 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.stg_users"
[0m14:27:13.590321 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m14:27:13.591653 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m14:27:13.593993 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: BEGIN
[0m14:27:13.596175 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: BEGIN
[0m14:27:13.601135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:13.605048 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:27:13.615602 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m14:27:13.616950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:27:13.618701 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:27:13.619472 [debug] [Thread-3 (]: On model.superstore_project.stg_users: BEGIN
[0m14:27:13.622678 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m14:27:13.625916 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m14:27:13.628708 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:27:13.632599 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */

  create view "postgres_metabase1"."raw"."stg_orders__dbt_tmp"
    
    
  as (
    WITH raw_orders AS (
    SELECT
        row_id,
        order_id,
        order_date,
        ship_date,
        ship_mode,
        order_priority,
        product_container,
        customer_name,
        customer_segment,
        zip_code,
        state,
        city,
        region,
        product_category,
        product_subcategory,
        product_name,
        unit_price,
        quantity AS order_quantity,
        sales,
        profit,
        discount,
        shipping_cost,
        product_base_margin
    FROM "postgres_metabase1"."raw"."orders"
)
SELECT *
FROM raw_orders
  );
[0m14:27:13.636337 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */

  create view "postgres_metabase1"."raw"."stg_returns__dbt_tmp"
    
    
  as (
    WITH raw_returns AS (
    SELECT
        order_id,
        status
    FROM "postgres_metabase1"."raw"."returns"
)
SELECT *
FROM raw_returns
  );
[0m14:27:13.653148 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:27:13.653718 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:13.654078 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:13.655771 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m14:27:13.668882 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m14:27:13.674508 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m14:27:13.677028 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */

  create view "postgres_metabase1"."raw"."stg_users__dbt_tmp"
    
    
  as (
    WITH raw_users AS (
    SELECT
        region,
        manager
    FROM "postgres_metabase1"."raw"."managers"
)
SELECT *
FROM raw_users
  );
[0m14:27:13.679331 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
alter table "postgres_metabase1"."raw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:27:13.682071 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
alter table "postgres_metabase1"."raw"."stg_returns" rename to "stg_returns__dbt_backup"
[0m14:27:13.688810 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:13.690782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:13.693071 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:13.702121 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m14:27:13.708137 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m14:27:13.714376 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m14:27:13.716890 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
alter table "postgres_metabase1"."raw"."stg_users" rename to "stg_users__dbt_backup"
[0m14:27:13.721269 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
alter table "postgres_metabase1"."raw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:27:13.724073 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
alter table "postgres_metabase1"."raw"."stg_returns__dbt_tmp" rename to "stg_returns"
[0m14:27:13.727576 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:13.730479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:13.733036 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:13.742118 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m14:27:13.762561 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m14:27:13.764167 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m14:27:13.766537 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
alter table "postgres_metabase1"."raw"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:27:13.768464 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m14:27:13.770303 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m14:27:13.772785 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:13.774820 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m14:27:13.777049 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m14:27:13.781799 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m14:27:13.787991 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:27:13.788675 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m14:27:13.789428 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:27:13.800139 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_orders__dbt_backup"
[0m14:27:13.801845 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m14:27:13.808433 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_returns__dbt_backup"
[0m14:27:13.816418 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m14:27:13.820456 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:27:13.821493 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m14:27:13.824281 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
drop view if exists "postgres_metabase1"."raw"."stg_orders__dbt_backup" cascade
[0m14:27:13.829403 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_users__dbt_backup"
[0m14:27:13.832130 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
drop view if exists "postgres_metabase1"."raw"."stg_returns__dbt_backup" cascade
[0m14:27:13.837917 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m14:27:13.839603 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:13.843394 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:13.844146 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
drop view if exists "postgres_metabase1"."raw"."stg_users__dbt_backup" cascade
[0m14:27:13.850389 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (execute): 14:27:13.475873 => 14:27:13.850015
[0m14:27:13.855564 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (execute): 14:27:13.555661 => 14:27:13.855213
[0m14:27:13.862573 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:13.864735 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: Close
[0m14:27:13.870775 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: Close
[0m14:27:13.883060 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (execute): 14:27:13.563691 => 14:27:13.879416
[0m14:27:13.889007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c24ea7-69b1-4410-b649-7101ff4cce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8347a26a40>]}
[0m14:27:13.896010 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c24ea7-69b1-4410-b649-7101ff4cce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a83450510f0>]}
[0m14:27:13.900570 [debug] [Thread-3 (]: On model.superstore_project.stg_users: Close
[0m14:27:13.906020 [info ] [Thread-1 (]: 1 of 8 OK created sql view model raw.stg_orders ................................ [[32mCREATE VIEW[0m in 0.61s]
[0m14:27:13.910744 [info ] [Thread-2 (]: 2 of 8 OK created sql view model raw.stg_returns ............................... [[32mCREATE VIEW[0m in 0.61s]
[0m14:27:13.918424 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c24ea7-69b1-4410-b649-7101ff4cce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a834509a350>]}
[0m14:27:13.922233 [debug] [Thread-1 (]: Finished running node model.superstore_project.stg_orders
[0m14:27:13.925651 [debug] [Thread-2 (]: Finished running node model.superstore_project.stg_returns
[0m14:27:13.928385 [info ] [Thread-3 (]: 3 of 8 OK created sql view model raw.stg_users ................................. [[32mCREATE VIEW[0m in 0.62s]
[0m14:27:13.931309 [debug] [Thread-4 (]: Began running node model.superstore_project.product_performance
[0m14:27:13.931694 [debug] [Thread-1 (]: Began running node model.superstore_project.top_customers
[0m14:27:13.934065 [debug] [Thread-2 (]: Began running node model.superstore_project.monthly_returns_trend
[0m14:27:13.936340 [debug] [Thread-3 (]: Finished running node model.superstore_project.stg_users
[0m14:27:13.940065 [info ] [Thread-4 (]: 4 of 8 START sql view model raw.product_performance ............................ [RUN]
[0m14:27:13.942617 [info ] [Thread-1 (]: 5 of 8 START sql view model raw.top_customers .................................. [RUN]
[0m14:27:13.945342 [info ] [Thread-2 (]: 6 of 8 START sql view model raw.monthly_returns_trend .......................... [RUN]
[0m14:27:13.948632 [debug] [Thread-3 (]: Began running node model.superstore_project.final_orders_with_returns
[0m14:27:13.950581 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_project.product_performance'
[0m14:27:13.953965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_orders, now model.superstore_project.top_customers)
[0m14:27:13.956523 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_returns, now model.superstore_project.monthly_returns_trend)
[0m14:27:13.959352 [info ] [Thread-3 (]: 7 of 8 START sql view model raw.final_orders_with_returns ...................... [RUN]
[0m14:27:13.962405 [debug] [Thread-4 (]: Began compiling node model.superstore_project.product_performance
[0m14:27:13.965265 [debug] [Thread-1 (]: Began compiling node model.superstore_project.top_customers
[0m14:27:13.968359 [debug] [Thread-2 (]: Began compiling node model.superstore_project.monthly_returns_trend
[0m14:27:13.971741 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_users, now model.superstore_project.final_orders_with_returns)
[0m14:27:13.977446 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.product_performance"
[0m14:27:13.982235 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.top_customers"
[0m14:27:13.989534 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.monthly_returns_trend"
[0m14:27:13.992465 [debug] [Thread-3 (]: Began compiling node model.superstore_project.final_orders_with_returns
[0m14:27:14.010511 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.final_orders_with_returns"
[0m14:27:14.015255 [debug] [Thread-4 (]: Timing info for model.superstore_project.product_performance (compile): 14:27:13.974465 => 14:27:14.014608
[0m14:27:14.019484 [debug] [Thread-4 (]: Began executing node model.superstore_project.product_performance
[0m14:27:14.020864 [debug] [Thread-2 (]: Timing info for model.superstore_project.monthly_returns_trend (compile): 14:27:13.985023 => 14:27:14.020148
[0m14:27:14.030304 [debug] [Thread-1 (]: Timing info for model.superstore_project.top_customers (compile): 14:27:13.979618 => 14:27:14.029447
[0m14:27:14.040039 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_project.product_performance"
[0m14:27:14.044604 [debug] [Thread-2 (]: Began executing node model.superstore_project.monthly_returns_trend
[0m14:27:14.051408 [debug] [Thread-3 (]: Timing info for model.superstore_project.final_orders_with_returns (compile): 14:27:14.004108 => 14:27:14.050322
[0m14:27:14.054767 [debug] [Thread-1 (]: Began executing node model.superstore_project.top_customers
[0m14:27:14.070549 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.monthly_returns_trend"
[0m14:27:14.072675 [debug] [Thread-3 (]: Began executing node model.superstore_project.final_orders_with_returns
[0m14:27:14.081724 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.top_customers"
[0m14:27:14.091695 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.final_orders_with_returns"
[0m14:27:14.095071 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.product_performance"
[0m14:27:14.101332 [debug] [Thread-4 (]: On model.superstore_project.product_performance: BEGIN
[0m14:27:14.102183 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m14:27:14.105018 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:27:14.106895 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.top_customers"
[0m14:27:14.112643 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: BEGIN
[0m14:27:14.123206 [debug] [Thread-1 (]: On model.superstore_project.top_customers: BEGIN
[0m14:27:14.132721 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:27:14.139100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:14.147005 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:27:14.156563 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m14:27:14.157951 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.product_performance"
[0m14:27:14.162590 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: BEGIN
[0m14:27:14.163880 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:27:14.164370 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:27:14.165853 [debug] [Thread-4 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */

  create view "postgres_metabase1"."raw"."product_performance__dbt_tmp"
    
    
  as (
    SELECT
    product_name,
    product_category,
    product_subcategory,
    SUM(quantity) AS total_quantity_sold,
    SUM(sales) AS total_sales,
    SUM(profit) AS total_profit,
    ROUND(AVG(product_base_margin), 4) AS avg_margin,
    COUNT(DISTINCT order_id) AS num_orders
FROM "postgres_metabase1"."raw"."stg_orders"
GROUP BY 1, 2, 3
ORDER BY total_sales DESC
LIMIT 100;
  );
[0m14:27:14.170418 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:27:14.173021 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m14:27:14.175372 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.top_customers"
[0m14:27:14.183018 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 19: LIMIT 100;
                  ^

[0m14:27:14.184649 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */

  create view "postgres_metabase1"."raw"."monthly_returns_trend__dbt_tmp"
    
    
  as (
    WITH orders_with_returns AS (
    SELECT
        o.order_id,
        o.order_date,
        r.status
    FROM "postgres_metabase1"."raw"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."raw"."stg_returns" r
        ON o.order_id = r.order_id
),
returns_by_month AS (
    SELECT
        DATE_TRUNC('month', order_date) AS month,
        COUNT(*) FILTER (WHERE status = 'Returned') AS returned_orders,
        COUNT(*) AS total_orders,
        ROUND(
            COUNT(*) FILTER (WHERE status = 'Returned')::decimal / NULLIF(COUNT(*), 0),
            2
        ) AS return_rate
    FROM orders_with_returns
    GROUP BY 1
)
SELECT *
FROM returns_by_month
ORDER BY month;
  );
[0m14:27:14.190203 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:27:14.190698 [debug] [Thread-1 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */

  create view "postgres_metabase1"."raw"."top_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_name,
    customer_segment,
    region,
    SUM(sales) AS total_sales,
    COUNT(DISTINCT order_id) AS num_orders,
    ROUND(AVG(profit), 2) AS avg_profit
FROM "postgres_metabase1"."raw"."stg_orders"
GROUP BY 1, 2, 3
ORDER BY total_sales DESC
LIMIT 50;
  );
[0m14:27:14.194055 [debug] [Thread-4 (]: On model.superstore_project.product_performance: ROLLBACK
[0m14:27:14.199245 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30: ORDER BY month;
                       ^

[0m14:27:14.201662 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m14:27:14.205143 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: LIMIT 50;
                 ^

[0m14:27:14.207879 [debug] [Thread-4 (]: Timing info for model.superstore_project.product_performance (execute): 14:27:14.023949 => 14:27:14.207675
[0m14:27:14.210193 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: ROLLBACK
[0m14:27:14.213656 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */

  create view "postgres_metabase1"."raw"."final_orders_with_returns__dbt_tmp"
    
    
  as (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."raw"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."raw"."stg_returns" r
    ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."raw"."stg_users" u
    ON o.region = u.region
)
SELECT *
FROM orders_with_returns
  );
[0m14:27:14.219040 [debug] [Thread-1 (]: On model.superstore_project.top_customers: ROLLBACK
[0m14:27:14.226958 [debug] [Thread-4 (]: On model.superstore_project.product_performance: Close
[0m14:27:14.238064 [debug] [Thread-2 (]: Timing info for model.superstore_project.monthly_returns_trend (execute): 14:27:14.062648 => 14:27:14.236391
[0m14:27:14.253737 [debug] [Thread-1 (]: Timing info for model.superstore_project.top_customers (execute): 14:27:14.075674 => 14:27:14.253514
[0m14:27:14.255049 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:14.260625 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: Close
[0m14:27:14.265116 [debug] [Thread-1 (]: On model.superstore_project.top_customers: Close
[0m14:27:14.272975 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m14:27:14.274363 [debug] [Thread-4 (]: Database Error in model product_performance (models/marts/product_performance.sql)
  syntax error at or near ";"
  LINE 19: LIMIT 100;
                    ^
  compiled Code at target/run/superstore_project/models/marts/product_performance.sql
[0m14:27:14.278325 [debug] [Thread-2 (]: Database Error in model monthly_returns_trend (models/marts/monthly_returns_trend.sql)
  syntax error at or near ";"
  LINE 30: ORDER BY month;
                         ^
  compiled Code at target/run/superstore_project/models/marts/monthly_returns_trend.sql
[0m14:27:14.280766 [debug] [Thread-1 (]: Database Error in model top_customers (models/marts/top_customers.sql)
  syntax error at or near ";"
  LINE 17: LIMIT 50;
                   ^
  compiled Code at target/run/superstore_project/models/marts/top_customers.sql
[0m14:27:14.282834 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
alter table "postgres_metabase1"."raw"."final_orders_with_returns__dbt_tmp" rename to "final_orders_with_returns"
[0m14:27:14.285799 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c24ea7-69b1-4410-b649-7101ff4cce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a83450114e0>]}
[0m14:27:14.290283 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c24ea7-69b1-4410-b649-7101ff4cce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a83479c9ba0>]}
[0m14:27:14.294534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c24ea7-69b1-4410-b649-7101ff4cce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8344ff54e0>]}
[0m14:27:14.298577 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:14.307240 [error] [Thread-4 (]: 4 of 8 ERROR creating sql view model raw.product_performance ................... [[31mERROR[0m in 0.34s]
[0m14:27:14.311677 [error] [Thread-2 (]: 6 of 8 ERROR creating sql view model raw.monthly_returns_trend ................. [[31mERROR[0m in 0.33s]
[0m14:27:14.317327 [error] [Thread-1 (]: 5 of 8 ERROR creating sql view model raw.top_customers ......................... [[31mERROR[0m in 0.34s]
[0m14:27:14.322061 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m14:27:14.326305 [debug] [Thread-4 (]: Finished running node model.superstore_project.product_performance
[0m14:27:14.330795 [debug] [Thread-2 (]: Finished running node model.superstore_project.monthly_returns_trend
[0m14:27:14.334677 [debug] [Thread-1 (]: Finished running node model.superstore_project.top_customers
[0m14:27:14.337185 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m14:27:14.339415 [debug] [Thread-4 (]: Began running node model.superstore_project.mart_orders_summary_by_region
[0m14:27:14.347495 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m14:27:14.349617 [info ] [Thread-4 (]: 8 of 8 START sql view model raw.mart_orders_summary_by_region .................. [RUN]
[0m14:27:14.354480 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_project.product_performance, now model.superstore_project.mart_orders_summary_by_region)
[0m14:27:14.354869 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:27:14.356808 [debug] [Thread-4 (]: Began compiling node model.superstore_project.mart_orders_summary_by_region
[0m14:27:14.362270 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."raw"."final_orders_with_returns__dbt_backup"
[0m14:27:14.369695 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.mart_orders_summary_by_region"
[0m14:27:14.373068 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m14:27:14.378723 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
drop view if exists "postgres_metabase1"."raw"."final_orders_with_returns__dbt_backup" cascade
[0m14:27:14.382149 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:14.385374 [debug] [Thread-3 (]: Timing info for model.superstore_project.final_orders_with_returns (execute): 14:27:14.086124 => 14:27:14.385147
[0m14:27:14.388415 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: Close
[0m14:27:14.393662 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c24ea7-69b1-4410-b649-7101ff4cce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a83450117e0>]}
[0m14:27:14.402486 [info ] [Thread-3 (]: 7 of 8 OK created sql view model raw.final_orders_with_returns ................. [[32mCREATE VIEW[0m in 0.42s]
[0m14:27:14.408899 [debug] [Thread-3 (]: Finished running node model.superstore_project.final_orders_with_returns
[0m14:27:14.449884 [debug] [Thread-4 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (compile): 14:27:14.366017 => 14:27:14.448573
[0m14:27:14.454484 [debug] [Thread-4 (]: Began executing node model.superstore_project.mart_orders_summary_by_region
[0m14:27:14.472894 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_project.mart_orders_summary_by_region"
[0m14:27:14.564114 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m14:27:14.573163 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: BEGIN
[0m14:27:14.582172 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:27:14.614780 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:27:14.622856 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m14:27:14.629965 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */

  create view "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_tmp"
    
    
  as (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."raw"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."raw"."stg_returns" r ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."raw"."stg_users" u ON o.region = u.region
),

region_summary AS (
    SELECT
        region,
        region_manager,
        COUNT(DISTINCT order_id) AS total_orders,
        COUNT(DISTINCT CASE WHEN return_status = 'Returned' THEN order_id END) AS returned_orders,
        ROUND(100.0 * COUNT(DISTINCT CASE WHEN return_status = 'Returned' THEN order_id END) / NULLIF(COUNT(DISTINCT order_id), 0), 2) AS return_rate_percent,
        SUM(sales) AS total_sales,
        SUM(profit) AS total_profit,
        ROUND(AVG(discount), 4) AS avg_discount
    FROM orders_with_returns
    GROUP BY region, region_manager
)

SELECT *
FROM region_summary
ORDER BY return_rate_percent DESC
  );
[0m14:27:14.646400 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:27:14.657898 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m14:27:14.662794 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
alter table "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_tmp" rename to "mart_orders_summary_by_region"
[0m14:27:14.668633 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:27:14.679020 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m14:27:14.683829 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m14:27:14.688322 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m14:27:14.697106 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:27:14.718387 [debug] [Thread-4 (]: Applying DROP to: "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_backup"
[0m14:27:14.725735 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m14:27:14.731693 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
drop view if exists "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_backup" cascade
[0m14:27:14.740156 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:27:14.748387 [debug] [Thread-4 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (execute): 14:27:14.458020 => 14:27:14.748000
[0m14:27:14.753763 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: Close
[0m14:27:14.759294 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c24ea7-69b1-4410-b649-7101ff4cce6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a834475c280>]}
[0m14:27:14.764029 [info ] [Thread-4 (]: 8 of 8 OK created sql view model raw.mart_orders_summary_by_region ............. [[32mCREATE VIEW[0m in 0.41s]
[0m14:27:14.768096 [debug] [Thread-4 (]: Finished running node model.superstore_project.mart_orders_summary_by_region
[0m14:27:14.773509 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:14.777616 [debug] [MainThread]: On master: BEGIN
[0m14:27:14.781543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:14.793019 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:27:14.795496 [debug] [MainThread]: On master: COMMIT
[0m14:27:14.798174 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:14.800401 [debug] [MainThread]: On master: COMMIT
[0m14:27:14.802813 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:27:14.805107 [debug] [MainThread]: On master: Close
[0m14:27:14.807543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:14.809981 [debug] [MainThread]: Connection 'model.superstore_project.top_customers' was properly closed.
[0m14:27:14.813434 [debug] [MainThread]: Connection 'model.superstore_project.monthly_returns_trend' was properly closed.
[0m14:27:14.815760 [debug] [MainThread]: Connection 'model.superstore_project.final_orders_with_returns' was properly closed.
[0m14:27:14.818021 [debug] [MainThread]: Connection 'model.superstore_project.mart_orders_summary_by_region' was properly closed.
[0m14:27:14.820221 [info ] [MainThread]: 
[0m14:27:14.822857 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m14:27:14.825793 [debug] [MainThread]: Command end result
[0m14:27:14.924807 [info ] [MainThread]: 
[0m14:27:14.929383 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:27:14.934191 [info ] [MainThread]: 
[0m14:27:14.936559 [error] [MainThread]:   Database Error in model product_performance (models/marts/product_performance.sql)
  syntax error at or near ";"
  LINE 19: LIMIT 100;
                    ^
  compiled Code at target/run/superstore_project/models/marts/product_performance.sql
[0m14:27:14.938452 [info ] [MainThread]: 
[0m14:27:14.940475 [error] [MainThread]:   Database Error in model monthly_returns_trend (models/marts/monthly_returns_trend.sql)
  syntax error at or near ";"
  LINE 30: ORDER BY month;
                         ^
  compiled Code at target/run/superstore_project/models/marts/monthly_returns_trend.sql
[0m14:27:14.942440 [info ] [MainThread]: 
[0m14:27:14.944233 [error] [MainThread]:   Database Error in model top_customers (models/marts/top_customers.sql)
  syntax error at or near ";"
  LINE 17: LIMIT 50;
                   ^
  compiled Code at target/run/superstore_project/models/marts/top_customers.sql
[0m14:27:14.947680 [info ] [MainThread]: 
[0m14:27:14.950852 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m14:27:14.956201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.3373094, "process_user_time": 3.328449, "process_kernel_time": 0.436517, "process_mem_max_rss": "109184", "process_in_blocks": "80168", "command_success": false, "process_out_blocks": "0"}
[0m14:27:14.959816 [debug] [MainThread]: Command `dbt run` failed at 14:27:14.959647 after 4.34 seconds
[0m14:27:14.962003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a834b416740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a834475c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8349605f00>]}
[0m14:27:14.964016 [debug] [MainThread]: Flushing usage events
[0m10:57:00.612693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714708426010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714708293f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714708291b50>]}


============================== 10:57:00.624779 | 9f70686b-f5ca-446f-b0d6-f4dfde88c93a ==============================
[0m10:57:00.624779 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:57:00.635550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'profiles_dir': '/home/ovp/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:57:01.197153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f70686b-f5ca-446f-b0d6-f4dfde88c93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714707fb5d50>]}
[0m10:57:01.221196 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:57:01.275996 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:57:01.308572 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.81217504, "process_user_time": 7.919723, "process_kernel_time": 0.844234, "process_mem_max_rss": "103700", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:57:01.316779 [debug] [MainThread]: Command `cli deps` succeeded at 10:57:01.316538 after 0.82 seconds
[0m10:57:01.324261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714708579a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714707f67a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714708424bd0>]}
[0m10:57:01.333054 [debug] [MainThread]: Flushing usage events
[0m10:34:55.126292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c0c7ae7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c0cf4b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c0c7ae910>]}


============================== 10:34:55.134850 | 7a462f55-aa8c-46cd-ab60-ca489901a1d4 ==============================
[0m10:34:55.134850 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:34:55.139626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ovp/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:34:55.555682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a462f55-aa8c-46cd-ab60-ca489901a1d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c0c879b90>]}
[0m10:34:55.601093 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:34:55.661584 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:34:55.720601 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6866479, "process_user_time": 1.783523, "process_kernel_time": 0.147299, "process_mem_max_rss": "103692", "process_in_blocks": "616", "process_out_blocks": "0"}
[0m10:34:55.736127 [debug] [MainThread]: Command `cli deps` succeeded at 10:34:55.735916 after 0.70 seconds
[0m10:34:55.755856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c0c7dbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c0c7dad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715c0cc50b50>]}
[0m10:34:55.777777 [debug] [MainThread]: Flushing usage events
[0m10:35:05.824104 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m10:46:30.435322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a7807bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a7866b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a78e01ad0>]}


============================== 10:46:30.447649 | 2f2b55bf-c592-40d4-9481-0a4a80d9fe66 ==============================
[0m10:46:30.447649 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:46:30.454268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/ovp/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m10:46:31.053851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f2b55bf-c592-40d4-9481-0a4a80d9fe66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a790cce10>]}
[0m10:46:31.072531 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:46:31.145015 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:46:31.207235 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.90384465, "process_user_time": 3.474718, "process_kernel_time": 0.285208, "process_mem_max_rss": "103624", "process_in_blocks": "616", "process_out_blocks": "0"}
[0m10:46:31.218181 [debug] [MainThread]: Command `cli deps` succeeded at 10:46:31.217873 after 0.92 seconds
[0m10:46:31.223502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a780bfad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a784d3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4a7866ba50>]}
[0m10:46:31.229768 [debug] [MainThread]: Flushing usage events
[0m10:46:41.675703 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m09:10:13.004092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7003b6b8d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7003b6b8c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7003b6b8c290>]}


============================== 09:10:13.016172 | 2e546ebf-ba9c-49af-9889-e7eaa491175f ==============================
[0m09:10:13.016172 [info ] [MainThread]: Running with dbt=1.7.8
[0m09:10:13.022247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/ovp/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/ovp47/github/metabase-docker/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m09:10:13.739143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e546ebf-ba9c-49af-9889-e7eaa491175f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7003b665f110>]}
[0m09:10:13.796470 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:10:13.861767 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:10:13.900396 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0397882, "process_user_time": 2.972806, "process_kernel_time": 0.248806, "process_mem_max_rss": "103408", "process_in_blocks": "616", "process_out_blocks": "0"}
[0m09:10:13.911539 [debug] [MainThread]: Command `cli deps` succeeded at 09:10:13.910976 after 1.05 seconds
[0m09:10:13.926513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7003b6d68190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7003b6a36b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7003b6a565d0>]}
[0m09:10:13.940869 [debug] [MainThread]: Flushing usage events
[0m09:31:06.569135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748310d77730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830f0628c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830f062b00>]}


============================== 09:31:06.576924 | a4d19d29-e58f-4b29-8fad-93ac9d06f1af ==============================
[0m09:31:06.576924 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:31:06.580303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:31:06.849746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4d19d29-e58f-4b29-8fad-93ac9d06f1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830efab670>]}
[0m09:31:06.956978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4d19d29-e58f-4b29-8fad-93ac9d06f1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830d54c280>]}
[0m09:31:06.959897 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m09:31:06.995987 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:31:07.603302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:31:07.605625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:31:07.608342 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.staging
[0m09:31:07.616127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4d19d29-e58f-4b29-8fad-93ac9d06f1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830d3529e0>]}
[0m09:31:07.678927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4d19d29-e58f-4b29-8fad-93ac9d06f1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830d5154b0>]}
[0m09:31:07.682476 [info ] [MainThread]: Found 8 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:31:07.684743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4d19d29-e58f-4b29-8fad-93ac9d06f1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830d515810>]}
[0m09:31:07.689232 [info ] [MainThread]: 
[0m09:31:07.692234 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:31:07.696634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m09:31:07.712769 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m09:31:07.715587 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m09:31:07.718847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:07.741805 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:31:07.746142 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m09:31:07.751924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now list_postgres_metabase1_raw)
[0m09:31:07.761186 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m09:31:07.764548 [debug] [ThreadPool]: On list_postgres_metabase1_raw: BEGIN
[0m09:31:07.767222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:31:07.777523 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:31:07.780968 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m09:31:07.784374 [debug] [ThreadPool]: On list_postgres_metabase1_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1_raw"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m09:31:07.791010 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m09:31:07.795852 [debug] [ThreadPool]: On list_postgres_metabase1_raw: ROLLBACK
[0m09:31:07.799086 [debug] [ThreadPool]: On list_postgres_metabase1_raw: Close
[0m09:31:07.808592 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:07.811551 [debug] [MainThread]: On master: BEGIN
[0m09:31:07.814610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:31:07.824789 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:31:07.827430 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:07.830046 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:31:07.839509 [debug] [MainThread]: SQL status: SELECT 29 in 0.0 seconds
[0m09:31:07.843608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4d19d29-e58f-4b29-8fad-93ac9d06f1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830d38f9a0>]}
[0m09:31:07.846599 [debug] [MainThread]: On master: ROLLBACK
[0m09:31:07.849258 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:07.851965 [debug] [MainThread]: On master: BEGIN
[0m09:31:07.855870 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:31:07.859145 [debug] [MainThread]: On master: COMMIT
[0m09:31:07.862083 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:07.865513 [debug] [MainThread]: On master: COMMIT
[0m09:31:07.868425 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:31:07.870880 [debug] [MainThread]: On master: Close
[0m09:31:07.873670 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:31:07.876384 [info ] [MainThread]: 
[0m09:31:07.888779 [debug] [Thread-1 (]: Began running node model.superstore_project.stg_orders
[0m09:31:07.889456 [debug] [Thread-2 (]: Began running node model.superstore_project.stg_returns
[0m09:31:07.890075 [debug] [Thread-3 (]: Began running node model.superstore_project.stg_users
[0m09:31:07.892029 [info ] [Thread-1 (]: 1 of 8 START sql view model raw.stg_orders ..................................... [RUN]
[0m09:31:07.894666 [info ] [Thread-2 (]: 2 of 8 START sql view model raw.stg_returns .................................... [RUN]
[0m09:31:07.897375 [info ] [Thread-3 (]: 3 of 8 START sql view model raw.stg_users ...................................... [RUN]
[0m09:31:07.899910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1_raw, now model.superstore_project.stg_orders)
[0m09:31:07.904285 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.superstore_project.stg_returns'
[0m09:31:07.907453 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_project.stg_users'
[0m09:31:07.909752 [debug] [Thread-1 (]: Began compiling node model.superstore_project.stg_orders
[0m09:31:07.912454 [debug] [Thread-2 (]: Began compiling node model.superstore_project.stg_returns
[0m09:31:07.915189 [debug] [Thread-3 (]: Began compiling node model.superstore_project.stg_users
[0m09:31:07.927684 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.stg_orders"
[0m09:31:07.933520 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.stg_returns"
[0m09:31:07.939242 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.stg_users"
[0m09:31:07.960866 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (compile): 09:31:07.929910 => 09:31:07.960424
[0m09:31:07.961745 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (compile): 09:31:07.935964 => 09:31:07.961284
[0m09:31:07.963899 [debug] [Thread-2 (]: Began executing node model.superstore_project.stg_returns
[0m09:31:07.965615 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (compile): 09:31:07.917922 => 09:31:07.965280
[0m09:31:07.967113 [debug] [Thread-3 (]: Began executing node model.superstore_project.stg_users
[0m09:31:07.994741 [debug] [Thread-1 (]: Began executing node model.superstore_project.stg_orders
[0m09:31:08.016656 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.stg_returns"
[0m09:31:08.022918 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.stg_users"
[0m09:31:08.030411 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.stg_orders"
[0m09:31:08.050565 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m09:31:08.053063 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: BEGIN
[0m09:31:08.053650 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m09:31:08.055595 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:31:08.056702 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m09:31:08.058915 [debug] [Thread-3 (]: On model.superstore_project.stg_users: BEGIN
[0m09:31:08.064316 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: BEGIN
[0m09:31:08.068576 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:31:08.069201 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:31:08.072455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:08.075144 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m09:31:08.084017 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */

  create view "postgres_metabase1"."raw"."stg_returns__dbt_tmp"
    
    
  as (
    WITH raw_returns AS (
    SELECT
        order_id,
        status
    FROM "postgres_metabase1"."raw"."returns"
)
SELECT *
FROM raw_returns
  );
[0m09:31:08.085076 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:31:08.087795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:31:08.089982 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:31:08.091196 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m09:31:08.093852 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m09:31:08.103953 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m09:31:08.105813 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */

  create view "postgres_metabase1"."raw"."stg_users__dbt_tmp"
    
    
  as (
    WITH raw_users AS (
    SELECT
        region,
        manager
    FROM "postgres_metabase1"."raw"."managers"
)
SELECT *
FROM raw_users
  );
[0m09:31:08.108086 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */

  create view "postgres_metabase1"."raw"."stg_orders__dbt_tmp"
    
    
  as (
    WITH raw_orders AS (
    SELECT
        row_id,
        order_id,
        order_date,
        ship_date,
        ship_mode,
        order_priority,
        product_container,
        customer_name,
        customer_segment,
        zip_code,
        state,
        city,
        region,
        product_category,
        product_subcategory,
        product_name,
        unit_price,
        quantity AS order_quantity,
        sales,
        profit,
        discount,
        shipping_cost,
        product_base_margin
    FROM "postgres_metabase1"."raw"."orders"
)
SELECT *
FROM raw_orders
  );
[0m09:31:08.110697 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
alter table "postgres_metabase1"."raw"."stg_returns__dbt_tmp" rename to "stg_returns"
[0m09:31:08.115061 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:31:08.117850 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:31:08.119043 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:31:08.124898 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m09:31:08.131006 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m09:31:08.155778 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m09:31:08.156527 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
alter table "postgres_metabase1"."raw"."stg_users__dbt_tmp" rename to "stg_users"
[0m09:31:08.159876 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
alter table "postgres_metabase1"."raw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m09:31:08.163437 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m09:31:08.167187 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:31:08.170072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:31:08.173789 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m09:31:08.178319 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m09:31:08.184558 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m09:31:08.189277 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:31:08.190596 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m09:31:08.193215 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m09:31:08.242953 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_returns__dbt_backup"
[0m09:31:08.245686 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m09:31:08.248330 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m09:31:08.256503 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m09:31:08.260409 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m09:31:08.262544 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:31:08.263856 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
drop view if exists "postgres_metabase1"."raw"."stg_returns__dbt_backup" cascade
[0m09:31:08.269196 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_users__dbt_backup"
[0m09:31:08.274314 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_orders__dbt_backup"
[0m09:31:08.277964 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:31:08.280417 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m09:31:08.283759 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m09:31:08.287819 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (execute): 09:31:07.970028 => 09:31:08.287598
[0m09:31:08.290884 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
drop view if exists "postgres_metabase1"."raw"."stg_users__dbt_backup" cascade
[0m09:31:08.293668 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
drop view if exists "postgres_metabase1"."raw"."stg_orders__dbt_backup" cascade
[0m09:31:08.296267 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: Close
[0m09:31:08.299639 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:31:08.302129 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:31:08.304738 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d19d29-e58f-4b29-8fad-93ac9d06f1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830d3f41c0>]}
[0m09:31:08.308078 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (execute): 09:31:08.017957 => 09:31:08.307868
[0m09:31:08.311834 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (execute): 09:31:08.025792 => 09:31:08.311629
[0m09:31:08.314944 [info ] [Thread-2 (]: 2 of 8 OK created sql view model raw.stg_returns ............................... [[32mCREATE VIEW[0m in 0.40s]
[0m09:31:08.317663 [debug] [Thread-3 (]: On model.superstore_project.stg_users: Close
[0m09:31:08.320258 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: Close
[0m09:31:08.323147 [debug] [Thread-2 (]: Finished running node model.superstore_project.stg_returns
[0m09:31:08.326220 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d19d29-e58f-4b29-8fad-93ac9d06f1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830d279090>]}
[0m09:31:08.329822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d19d29-e58f-4b29-8fad-93ac9d06f1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830d2785e0>]}
[0m09:31:08.335178 [info ] [Thread-3 (]: 3 of 8 OK created sql view model raw.stg_users ................................. [[32mCREATE VIEW[0m in 0.42s]
[0m09:31:08.339235 [info ] [Thread-1 (]: 1 of 8 OK created sql view model raw.stg_orders ................................ [[32mCREATE VIEW[0m in 0.43s]
[0m09:31:08.343034 [debug] [Thread-3 (]: Finished running node model.superstore_project.stg_users
[0m09:31:08.345926 [debug] [Thread-1 (]: Finished running node model.superstore_project.stg_orders
[0m09:31:08.353413 [debug] [Thread-4 (]: Began running node model.superstore_project.final_orders_with_returns
[0m09:31:08.354188 [debug] [Thread-2 (]: Began running node model.superstore_project.mart_orders_summary_by_region
[0m09:31:08.354970 [debug] [Thread-3 (]: Began running node model.superstore_project.monthly_returns_trend
[0m09:31:08.355645 [debug] [Thread-1 (]: Began running node model.superstore_project.product_performance
[0m09:31:08.357559 [info ] [Thread-4 (]: 4 of 8 START sql view model raw.final_orders_with_returns ...................... [RUN]
[0m09:31:08.360514 [info ] [Thread-2 (]: 5 of 8 START sql view model raw.mart_orders_summary_by_region .................. [RUN]
[0m09:31:08.363322 [info ] [Thread-3 (]: 6 of 8 START sql view model raw.monthly_returns_trend .......................... [RUN]
[0m09:31:08.366621 [info ] [Thread-1 (]: 7 of 8 START sql view model raw.product_performance ............................ [RUN]
[0m09:31:08.369984 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_project.final_orders_with_returns'
[0m09:31:08.373212 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_returns, now model.superstore_project.mart_orders_summary_by_region)
[0m09:31:08.376407 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_users, now model.superstore_project.monthly_returns_trend)
[0m09:31:08.379217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_orders, now model.superstore_project.product_performance)
[0m09:31:08.382199 [debug] [Thread-4 (]: Began compiling node model.superstore_project.final_orders_with_returns
[0m09:31:08.385251 [debug] [Thread-2 (]: Began compiling node model.superstore_project.mart_orders_summary_by_region
[0m09:31:08.388574 [debug] [Thread-3 (]: Began compiling node model.superstore_project.monthly_returns_trend
[0m09:31:08.391594 [debug] [Thread-1 (]: Began compiling node model.superstore_project.product_performance
[0m09:31:08.398686 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.final_orders_with_returns"
[0m09:31:08.405049 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.mart_orders_summary_by_region"
[0m09:31:08.411699 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.monthly_returns_trend"
[0m09:31:08.417514 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.product_performance"
[0m09:31:08.438447 [debug] [Thread-4 (]: Timing info for model.superstore_project.final_orders_with_returns (compile): 09:31:08.393970 => 09:31:08.437424
[0m09:31:08.441423 [debug] [Thread-2 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (compile): 09:31:08.401358 => 09:31:08.440790
[0m09:31:08.443680 [debug] [Thread-4 (]: Began executing node model.superstore_project.final_orders_with_returns
[0m09:31:08.445819 [debug] [Thread-1 (]: Timing info for model.superstore_project.product_performance (compile): 09:31:08.414290 => 09:31:08.444588
[0m09:31:08.449270 [debug] [Thread-3 (]: Timing info for model.superstore_project.monthly_returns_trend (compile): 09:31:08.407775 => 09:31:08.448487
[0m09:31:08.450413 [debug] [Thread-2 (]: Began executing node model.superstore_project.mart_orders_summary_by_region
[0m09:31:08.467645 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_project.final_orders_with_returns"
[0m09:31:08.470586 [debug] [Thread-1 (]: Began executing node model.superstore_project.product_performance
[0m09:31:08.476550 [debug] [Thread-3 (]: Began executing node model.superstore_project.monthly_returns_trend
[0m09:31:08.489094 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.mart_orders_summary_by_region"
[0m09:31:08.501766 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.product_performance"
[0m09:31:08.509101 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.monthly_returns_trend"
[0m09:31:08.525455 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m09:31:08.528413 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m09:31:08.530157 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: BEGIN
[0m09:31:08.530885 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m09:31:08.532747 [debug] [Thread-3 (]: On model.superstore_project.monthly_returns_trend: BEGIN
[0m09:31:08.533378 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.product_performance"
[0m09:31:08.535966 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:31:08.540655 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: BEGIN
[0m09:31:08.545409 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:08.550966 [debug] [Thread-1 (]: On model.superstore_project.product_performance: BEGIN
[0m09:31:08.561074 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:31:08.567035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:08.568563 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:31:08.572746 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:31:08.574473 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m09:31:08.576573 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:31:08.577124 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m09:31:08.578406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:31:08.579541 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */

  create view "postgres_metabase1"."raw"."final_orders_with_returns__dbt_tmp"
    
    
  as (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."raw"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."raw"."stg_returns" r
    ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."raw"."stg_users" u
    ON o.region = u.region
)
SELECT *
FROM orders_with_returns
  );
[0m09:31:08.581634 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m09:31:08.583713 [debug] [Thread-3 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */

  create view "postgres_metabase1"."raw"."monthly_returns_trend__dbt_tmp"
    
    
  as (
    WITH orders_with_returns AS (
    SELECT
        o.order_id,
        o.order_date,
        r.status
    FROM "postgres_metabase1"."raw"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."raw"."stg_returns" r
        ON o.order_id = r.order_id
),
returns_by_month AS (
    SELECT
        DATE_TRUNC('month', order_date) AS month,
        COUNT(*) FILTER (WHERE status = 'Returned') AS returned_orders,
        COUNT(*) AS total_orders,
        ROUND(
            COUNT(*) FILTER (WHERE status = 'Returned')::decimal / NULLIF(COUNT(*), 0),
            2
        ) AS return_rate
    FROM orders_with_returns
    GROUP BY 1
)
SELECT *
FROM returns_by_month
ORDER BY month;
  );
[0m09:31:08.585900 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.product_performance"
[0m09:31:08.589611 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */

  create view "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_tmp"
    
    
  as (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."raw"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."raw"."stg_returns" r ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."raw"."stg_users" u ON o.region = u.region
),

region_summary AS (
    SELECT
        region,
        region_manager,
        COUNT(DISTINCT order_id) AS total_orders,
        COUNT(DISTINCT CASE WHEN return_status = 'Returned' THEN order_id END) AS returned_orders,
        ROUND(100.0 * COUNT(DISTINCT CASE WHEN return_status = 'Returned' THEN order_id END) / NULLIF(COUNT(DISTINCT order_id), 0), 2) AS return_rate_percent,
        SUM(sales) AS total_sales,
        SUM(profit) AS total_profit,
        ROUND(AVG(discount), 4) AS avg_discount
    FROM orders_with_returns
    GROUP BY region, region_manager
)

SELECT *
FROM region_summary
ORDER BY return_rate_percent DESC
  );
[0m09:31:08.591907 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:31:08.592586 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30: ORDER BY month;
                       ^

[0m09:31:08.594561 [debug] [Thread-1 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */

  create view "postgres_metabase1"."raw"."product_performance__dbt_tmp"
    
    
  as (
    SELECT
    product_name,
    product_category,
    product_subcategory,
    SUM(quantity) AS total_quantity_sold,
    SUM(sales) AS total_sales,
    SUM(profit) AS total_profit,
    ROUND(AVG(product_base_margin), 4) AS avg_margin,
    COUNT(DISTINCT order_id) AS num_orders
FROM "postgres_metabase1"."raw"."stg_orders"
GROUP BY 1, 2, 3
ORDER BY total_sales DESC
LIMIT 100;
  );
[0m09:31:08.602228 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m09:31:08.602831 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:31:08.604956 [debug] [Thread-3 (]: On model.superstore_project.monthly_returns_trend: ROLLBACK
[0m09:31:08.607784 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 19: LIMIT 100;
                  ^

[0m09:31:08.609621 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
alter table "postgres_metabase1"."raw"."final_orders_with_returns__dbt_tmp" rename to "final_orders_with_returns"
[0m09:31:08.615557 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m09:31:08.619047 [debug] [Thread-3 (]: Timing info for model.superstore_project.monthly_returns_trend (execute): 09:31:08.504265 => 09:31:08.618685
[0m09:31:08.621189 [debug] [Thread-1 (]: On model.superstore_project.product_performance: ROLLBACK
[0m09:31:08.625016 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:31:08.626966 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
alter table "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_tmp" rename to "mart_orders_summary_by_region"
[0m09:31:08.630044 [debug] [Thread-3 (]: On model.superstore_project.monthly_returns_trend: Close
[0m09:31:08.633311 [debug] [Thread-1 (]: Timing info for model.superstore_project.product_performance (execute): 09:31:08.494678 => 09:31:08.632941
[0m09:31:08.636539 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m09:31:08.640140 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:31:08.644552 [debug] [Thread-1 (]: On model.superstore_project.product_performance: Close
[0m09:31:08.647139 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m09:31:08.651606 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m09:31:08.653105 [debug] [Thread-3 (]: Database Error in model monthly_returns_trend (models/marts/monthly_returns_trend.sql)
  syntax error at or near ";"
  LINE 30: ORDER BY month;
                         ^
  compiled Code at target/run/superstore_project/models/marts/monthly_returns_trend.sql
[0m09:31:08.655705 [debug] [Thread-1 (]: Database Error in model product_performance (models/marts/product_performance.sql)
  syntax error at or near ";"
  LINE 19: LIMIT 100;
                    ^
  compiled Code at target/run/superstore_project/models/marts/product_performance.sql
[0m09:31:08.657530 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m09:31:08.660460 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m09:31:08.663095 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d19d29-e58f-4b29-8fad-93ac9d06f1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830d37c190>]}
[0m09:31:08.665615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d19d29-e58f-4b29-8fad-93ac9d06f1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830d34baf0>]}
[0m09:31:08.669502 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m09:31:08.669986 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m09:31:08.673365 [error] [Thread-3 (]: 6 of 8 ERROR creating sql view model raw.monthly_returns_trend ................. [[31mERROR[0m in 0.29s]
[0m09:31:08.676635 [error] [Thread-1 (]: 7 of 8 ERROR creating sql view model raw.product_performance ................... [[31mERROR[0m in 0.29s]
[0m09:31:08.681791 [debug] [Thread-4 (]: Applying DROP to: "postgres_metabase1"."raw"."final_orders_with_returns__dbt_backup"
[0m09:31:08.685224 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:31:08.686570 [debug] [Thread-3 (]: Finished running node model.superstore_project.monthly_returns_trend
[0m09:31:08.689021 [debug] [Thread-1 (]: Finished running node model.superstore_project.product_performance
[0m09:31:08.691908 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m09:31:08.699378 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_backup"
[0m09:31:08.701524 [debug] [Thread-3 (]: Began running node model.superstore_project.top_customers
[0m09:31:08.706512 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
drop view if exists "postgres_metabase1"."raw"."final_orders_with_returns__dbt_backup" cascade
[0m09:31:08.709308 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m09:31:08.713872 [info ] [Thread-3 (]: 8 of 8 START sql view model raw.top_customers .................................. [RUN]
[0m09:31:08.717237 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:31:08.718933 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
drop view if exists "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_backup" cascade
[0m09:31:08.721503 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.monthly_returns_trend, now model.superstore_project.top_customers)
[0m09:31:08.726981 [debug] [Thread-4 (]: Timing info for model.superstore_project.final_orders_with_returns (execute): 09:31:08.453851 => 09:31:08.726727
[0m09:31:08.730262 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:31:08.733139 [debug] [Thread-3 (]: Began compiling node model.superstore_project.top_customers
[0m09:31:08.737232 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: Close
[0m09:31:08.742033 [debug] [Thread-2 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (execute): 09:31:08.482768 => 09:31:08.741711
[0m09:31:08.747800 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.top_customers"
[0m09:31:08.752261 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d19d29-e58f-4b29-8fad-93ac9d06f1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830c11aaa0>]}
[0m09:31:08.755586 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: Close
[0m09:31:08.760422 [info ] [Thread-4 (]: 4 of 8 OK created sql view model raw.final_orders_with_returns ................. [[32mCREATE VIEW[0m in 0.38s]
[0m09:31:08.764183 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d19d29-e58f-4b29-8fad-93ac9d06f1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830c11ba60>]}
[0m09:31:08.767050 [debug] [Thread-4 (]: Finished running node model.superstore_project.final_orders_with_returns
[0m09:31:08.770033 [info ] [Thread-2 (]: 5 of 8 OK created sql view model raw.mart_orders_summary_by_region ............. [[32mCREATE VIEW[0m in 0.39s]
[0m09:31:08.776536 [debug] [Thread-2 (]: Finished running node model.superstore_project.mart_orders_summary_by_region
[0m09:31:08.784167 [debug] [Thread-3 (]: Timing info for model.superstore_project.top_customers (compile): 09:31:08.744456 => 09:31:08.783743
[0m09:31:08.786638 [debug] [Thread-3 (]: Began executing node model.superstore_project.top_customers
[0m09:31:08.794032 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.top_customers"
[0m09:31:08.818519 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.top_customers"
[0m09:31:08.822627 [debug] [Thread-3 (]: On model.superstore_project.top_customers: BEGIN
[0m09:31:08.825765 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:31:08.842223 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:31:08.844659 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.top_customers"
[0m09:31:08.848474 [debug] [Thread-3 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */

  create view "postgres_metabase1"."raw"."top_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_name,
    customer_segment,
    region,
    SUM(sales) AS total_sales,
    COUNT(DISTINCT order_id) AS num_orders,
    ROUND(AVG(profit), 2) AS avg_profit
FROM "postgres_metabase1"."raw"."stg_orders"
GROUP BY 1, 2, 3
ORDER BY total_sales DESC
LIMIT 50;
  );
[0m09:31:08.852606 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: LIMIT 50;
                 ^

[0m09:31:08.854620 [debug] [Thread-3 (]: On model.superstore_project.top_customers: ROLLBACK
[0m09:31:08.858181 [debug] [Thread-3 (]: Timing info for model.superstore_project.top_customers (execute): 09:31:08.788544 => 09:31:08.857592
[0m09:31:08.861226 [debug] [Thread-3 (]: On model.superstore_project.top_customers: Close
[0m09:31:08.866133 [debug] [Thread-3 (]: Database Error in model top_customers (models/marts/top_customers.sql)
  syntax error at or near ";"
  LINE 17: LIMIT 50;
                   ^
  compiled Code at target/run/superstore_project/models/marts/top_customers.sql
[0m09:31:08.869657 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d19d29-e58f-4b29-8fad-93ac9d06f1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830d2bba00>]}
[0m09:31:08.874544 [error] [Thread-3 (]: 8 of 8 ERROR creating sql view model raw.top_customers ......................... [[31mERROR[0m in 0.15s]
[0m09:31:08.879404 [debug] [Thread-3 (]: Finished running node model.superstore_project.top_customers
[0m09:31:08.886893 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:08.888649 [debug] [MainThread]: On master: BEGIN
[0m09:31:08.890576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:31:08.900361 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:31:08.902972 [debug] [MainThread]: On master: COMMIT
[0m09:31:08.904978 [debug] [MainThread]: Using postgres connection "master"
[0m09:31:08.906842 [debug] [MainThread]: On master: COMMIT
[0m09:31:08.910663 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:31:08.913123 [debug] [MainThread]: On master: Close
[0m09:31:08.915562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:31:08.917548 [debug] [MainThread]: Connection 'model.superstore_project.product_performance' was properly closed.
[0m09:31:08.919489 [debug] [MainThread]: Connection 'model.superstore_project.mart_orders_summary_by_region' was properly closed.
[0m09:31:08.921540 [debug] [MainThread]: Connection 'model.superstore_project.top_customers' was properly closed.
[0m09:31:08.923619 [debug] [MainThread]: Connection 'model.superstore_project.final_orders_with_returns' was properly closed.
[0m09:31:08.925528 [info ] [MainThread]: 
[0m09:31:08.927642 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m09:31:08.930631 [debug] [MainThread]: Command end result
[0m09:31:08.967500 [info ] [MainThread]: 
[0m09:31:08.969524 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m09:31:08.971509 [info ] [MainThread]: 
[0m09:31:08.974004 [error] [MainThread]:   Database Error in model monthly_returns_trend (models/marts/monthly_returns_trend.sql)
  syntax error at or near ";"
  LINE 30: ORDER BY month;
                         ^
  compiled Code at target/run/superstore_project/models/marts/monthly_returns_trend.sql
[0m09:31:08.976310 [info ] [MainThread]: 
[0m09:31:08.979020 [error] [MainThread]:   Database Error in model product_performance (models/marts/product_performance.sql)
  syntax error at or near ";"
  LINE 19: LIMIT 100;
                    ^
  compiled Code at target/run/superstore_project/models/marts/product_performance.sql
[0m09:31:08.981689 [info ] [MainThread]: 
[0m09:31:08.984201 [error] [MainThread]:   Database Error in model top_customers (models/marts/top_customers.sql)
  syntax error at or near ";"
  LINE 17: LIMIT 50;
                   ^
  compiled Code at target/run/superstore_project/models/marts/top_customers.sql
[0m09:31:08.987563 [info ] [MainThread]: 
[0m09:31:08.990573 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m09:31:08.995267 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5942268, "process_user_time": 2.964901, "process_kernel_time": 0.324351, "process_mem_max_rss": "107224", "process_in_blocks": "86632", "process_out_blocks": "664", "command_success": false}
[0m09:31:08.998760 [debug] [MainThread]: Command `dbt run` failed at 09:31:08.998507 after 2.60 seconds
[0m09:31:09.001970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x748310d77730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830f048430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74830d515750>]}
[0m09:31:09.004907 [debug] [MainThread]: Flushing usage events
[0m09:48:29.827693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c18084a2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c180670e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c180670e0e0>]}


============================== 09:48:29.833312 | 82a18ab9-2991-4108-973c-7965cc214251 ==============================
[0m09:48:29.833312 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:48:29.835440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app/profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:48:30.350550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c180670e230>]}
[0m09:48:30.440080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1804cbbc40>]}
[0m09:48:30.450587 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m09:48:30.521528 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:48:30.665615 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:48:30.672728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c18066cf820>]}
[0m09:48:33.336833 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.marts
- models.stg
[0m09:48:33.349673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17f5f69300>]}
[0m09:48:33.556523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17f60fc8b0>]}
[0m09:48:33.565384 [info ] [MainThread]: Found 8 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:48:33.572505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1804c51960>]}
[0m09:48:33.581196 [info ] [MainThread]: 
[0m09:48:33.585699 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:48:33.591481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m09:48:33.606785 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m09:48:33.609509 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m09:48:33.613644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:48:33.634922 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:48:33.640455 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m09:48:33.645386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now list_postgres_metabase1_raw)
[0m09:48:33.652708 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m09:48:33.656432 [debug] [ThreadPool]: On list_postgres_metabase1_raw: BEGIN
[0m09:48:33.660378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:48:33.668606 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:48:33.673333 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m09:48:33.676846 [debug] [ThreadPool]: On list_postgres_metabase1_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1_raw"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m09:48:33.684711 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m09:48:33.690673 [debug] [ThreadPool]: On list_postgres_metabase1_raw: ROLLBACK
[0m09:48:33.695374 [debug] [ThreadPool]: On list_postgres_metabase1_raw: Close
[0m09:48:33.705844 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:33.710588 [debug] [MainThread]: On master: BEGIN
[0m09:48:33.715403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:48:33.724744 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:48:33.728851 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:33.733112 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:48:33.743746 [debug] [MainThread]: SQL status: SELECT 40 in 0.0 seconds
[0m09:48:33.750946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17f5f75f90>]}
[0m09:48:33.755766 [debug] [MainThread]: On master: ROLLBACK
[0m09:48:33.758802 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:33.767899 [debug] [MainThread]: On master: BEGIN
[0m09:48:33.775933 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:48:33.782346 [debug] [MainThread]: On master: COMMIT
[0m09:48:33.788791 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:33.794529 [debug] [MainThread]: On master: COMMIT
[0m09:48:33.803472 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:48:33.809066 [debug] [MainThread]: On master: Close
[0m09:48:33.814354 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:48:33.818187 [info ] [MainThread]: 
[0m09:48:33.827791 [debug] [Thread-1 (]: Began running node model.superstore_project.stg_orders
[0m09:48:33.828258 [debug] [Thread-2 (]: Began running node model.superstore_project.stg_returns
[0m09:48:33.828679 [debug] [Thread-3 (]: Began running node model.superstore_project.stg_users
[0m09:48:33.832317 [info ] [Thread-1 (]: 1 of 8 START sql view model raw.stg_orders ..................................... [RUN]
[0m09:48:33.839621 [info ] [Thread-2 (]: 2 of 8 START sql view model raw.stg_returns .................................... [RUN]
[0m09:48:33.844832 [info ] [Thread-3 (]: 3 of 8 START sql view model raw.stg_users ...................................... [RUN]
[0m09:48:33.848071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1_raw, now model.superstore_project.stg_orders)
[0m09:48:33.852177 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.superstore_project.stg_returns'
[0m09:48:33.856108 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_project.stg_users'
[0m09:48:33.859426 [debug] [Thread-1 (]: Began compiling node model.superstore_project.stg_orders
[0m09:48:33.864396 [debug] [Thread-2 (]: Began compiling node model.superstore_project.stg_returns
[0m09:48:33.867720 [debug] [Thread-3 (]: Began compiling node model.superstore_project.stg_users
[0m09:48:33.879577 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.stg_orders"
[0m09:48:33.884515 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.stg_returns"
[0m09:48:33.890808 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.stg_users"
[0m09:48:33.917895 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (compile): 09:48:33.873044 => 09:48:33.917565
[0m09:48:33.920262 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (compile): 09:48:33.882284 => 09:48:33.920011
[0m09:48:33.923240 [debug] [Thread-1 (]: Began executing node model.superstore_project.stg_orders
[0m09:48:33.926596 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (compile): 09:48:33.888465 => 09:48:33.926282
[0m09:48:33.928263 [debug] [Thread-2 (]: Began executing node model.superstore_project.stg_returns
[0m09:48:33.956910 [debug] [Thread-3 (]: Began executing node model.superstore_project.stg_users
[0m09:48:33.963080 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.stg_orders"
[0m09:48:33.971429 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.stg_returns"
[0m09:48:33.977883 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.stg_users"
[0m09:48:34.008136 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m09:48:34.012236 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m09:48:34.014272 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: BEGIN
[0m09:48:34.016933 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m09:48:34.018868 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: BEGIN
[0m09:48:34.022779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:34.027143 [debug] [Thread-3 (]: On model.superstore_project.stg_users: BEGIN
[0m09:48:34.031746 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:48:34.039629 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:48:34.041097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:48:34.049898 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:48:34.053618 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:48:34.054796 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m09:48:34.060231 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m09:48:34.064691 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m09:48:34.070208 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */

  create view "postgres_metabase1"."raw"."stg_orders__dbt_tmp"
    
    
  as (
    WITH raw_orders AS (
    SELECT
        row_id,
        order_id,
        order_date,
        ship_date,
        ship_mode,
        order_priority,
        product_container,
        customer_name,
        customer_segment,
        zip_code,
        state,
        city,
        region,
        product_category,
        product_subcategory,
        product_name,
        unit_price,
        quantity AS order_quantity,
        sales,
        profit,
        discount,
        shipping_cost,
        product_base_margin
    FROM "postgres_metabase1"."raw"."orders"
)
SELECT *
FROM raw_orders
  );
[0m09:48:34.076733 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */

  create view "postgres_metabase1"."raw"."stg_returns__dbt_tmp"
    
    
  as (
    WITH raw_returns AS (
    SELECT
        order_id,
        status
    FROM "postgres_metabase1"."raw"."returns"
)
SELECT *
FROM raw_returns
  );
[0m09:48:34.080327 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */

  create view "postgres_metabase1"."raw"."stg_users__dbt_tmp"
    
    
  as (
    WITH raw_users AS (
    SELECT
        region,
        manager
    FROM "postgres_metabase1"."raw"."managers"
)
SELECT *
FROM raw_users
  );
[0m09:48:34.090023 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:48:34.092496 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:48:34.095264 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:48:34.102644 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m09:48:34.109746 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m09:48:34.117036 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m09:48:34.122656 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
alter table "postgres_metabase1"."raw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m09:48:34.127486 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
alter table "postgres_metabase1"."raw"."stg_returns" rename to "stg_returns__dbt_backup"
[0m09:48:34.131780 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
alter table "postgres_metabase1"."raw"."stg_users" rename to "stg_users__dbt_backup"
[0m09:48:34.138702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:48:34.144355 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:48:34.152065 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:48:34.161227 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m09:48:34.169867 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m09:48:34.181690 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m09:48:34.187421 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
alter table "postgres_metabase1"."raw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m09:48:34.194459 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
alter table "postgres_metabase1"."raw"."stg_returns__dbt_tmp" rename to "stg_returns"
[0m09:48:34.201624 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
alter table "postgres_metabase1"."raw"."stg_users__dbt_tmp" rename to "stg_users"
[0m09:48:34.209257 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:48:34.215761 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:48:34.223253 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:48:34.253108 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m09:48:34.260759 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m09:48:34.269715 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m09:48:34.276811 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m09:48:34.287840 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m09:48:34.296386 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m09:48:34.306924 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m09:48:34.313994 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m09:48:34.331522 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m09:48:34.350907 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:48:34.359382 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:48:34.367497 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m09:48:34.381785 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_orders__dbt_backup"
[0m09:48:34.391760 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_returns__dbt_backup"
[0m09:48:34.401999 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."raw"."stg_users__dbt_backup"
[0m09:48:34.415802 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m09:48:34.424780 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m09:48:34.433031 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m09:48:34.439024 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
drop view if exists "postgres_metabase1"."raw"."stg_orders__dbt_backup" cascade
[0m09:48:34.448207 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
drop view if exists "postgres_metabase1"."raw"."stg_returns__dbt_backup" cascade
[0m09:48:34.455359 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
drop view if exists "postgres_metabase1"."raw"."stg_users__dbt_backup" cascade
[0m09:48:34.464484 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:48:34.465358 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:48:34.473293 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:48:34.476557 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (execute): 09:48:33.932337 => 09:48:34.476388
[0m09:48:34.490552 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (execute): 09:48:33.967091 => 09:48:34.490311
[0m09:48:34.501398 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (execute): 09:48:33.974416 => 09:48:34.501205
[0m09:48:34.509593 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: Close
[0m09:48:34.518787 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: Close
[0m09:48:34.531975 [debug] [Thread-3 (]: On model.superstore_project.stg_users: Close
[0m09:48:34.545893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17f5e53f40>]}
[0m09:48:34.553142 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17f5ee6230>]}
[0m09:48:34.560891 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17f5e371f0>]}
[0m09:48:34.567647 [info ] [Thread-1 (]: 1 of 8 OK created sql view model raw.stg_orders ................................ [[32mCREATE VIEW[0m in 0.70s]
[0m09:48:34.579299 [info ] [Thread-2 (]: 2 of 8 OK created sql view model raw.stg_returns ............................... [[32mCREATE VIEW[0m in 0.70s]
[0m09:48:34.586108 [info ] [Thread-3 (]: 3 of 8 OK created sql view model raw.stg_users ................................. [[32mCREATE VIEW[0m in 0.71s]
[0m09:48:34.595967 [debug] [Thread-1 (]: Finished running node model.superstore_project.stg_orders
[0m09:48:34.605598 [debug] [Thread-2 (]: Finished running node model.superstore_project.stg_returns
[0m09:48:34.613271 [debug] [Thread-3 (]: Finished running node model.superstore_project.stg_users
[0m09:48:34.618982 [debug] [Thread-4 (]: Began running node model.superstore_project.product_performance
[0m09:48:34.619436 [debug] [Thread-1 (]: Began running node model.superstore_project.top_customers
[0m09:48:34.625577 [debug] [Thread-2 (]: Began running node model.superstore_project.monthly_returns_trend
[0m09:48:34.631883 [debug] [Thread-3 (]: Began running node model.superstore_project.final_orders_with_returns
[0m09:48:34.637803 [info ] [Thread-4 (]: 4 of 8 START sql view model raw.product_performance ............................ [RUN]
[0m09:48:34.645224 [info ] [Thread-1 (]: 5 of 8 START sql view model raw.top_customers .................................. [RUN]
[0m09:48:34.650722 [info ] [Thread-2 (]: 6 of 8 START sql view model raw.monthly_returns_trend .......................... [RUN]
[0m09:48:34.655603 [info ] [Thread-3 (]: 7 of 8 START sql view model raw.final_orders_with_returns ...................... [RUN]
[0m09:48:34.662360 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_project.product_performance'
[0m09:48:34.669633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_orders, now model.superstore_project.top_customers)
[0m09:48:34.674878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_returns, now model.superstore_project.monthly_returns_trend)
[0m09:48:34.682090 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_users, now model.superstore_project.final_orders_with_returns)
[0m09:48:34.687334 [debug] [Thread-4 (]: Began compiling node model.superstore_project.product_performance
[0m09:48:34.698650 [debug] [Thread-1 (]: Began compiling node model.superstore_project.top_customers
[0m09:48:34.706962 [debug] [Thread-2 (]: Began compiling node model.superstore_project.monthly_returns_trend
[0m09:48:34.715666 [debug] [Thread-3 (]: Began compiling node model.superstore_project.final_orders_with_returns
[0m09:48:34.725636 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.product_performance"
[0m09:48:34.737408 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.top_customers"
[0m09:48:34.745569 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.monthly_returns_trend"
[0m09:48:34.755230 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.final_orders_with_returns"
[0m09:48:34.807871 [debug] [Thread-4 (]: Timing info for model.superstore_project.product_performance (compile): 09:48:34.722597 => 09:48:34.807551
[0m09:48:34.812978 [debug] [Thread-1 (]: Timing info for model.superstore_project.top_customers (compile): 09:48:34.735040 => 09:48:34.812687
[0m09:48:34.814608 [debug] [Thread-2 (]: Timing info for model.superstore_project.monthly_returns_trend (compile): 09:48:34.743118 => 09:48:34.814278
[0m09:48:34.815278 [debug] [Thread-4 (]: Began executing node model.superstore_project.product_performance
[0m09:48:34.822716 [debug] [Thread-3 (]: Timing info for model.superstore_project.final_orders_with_returns (compile): 09:48:34.751698 => 09:48:34.822462
[0m09:48:34.823095 [debug] [Thread-1 (]: Began executing node model.superstore_project.top_customers
[0m09:48:34.829939 [debug] [Thread-2 (]: Began executing node model.superstore_project.monthly_returns_trend
[0m09:48:34.881261 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_project.product_performance"
[0m09:48:34.885447 [debug] [Thread-3 (]: Began executing node model.superstore_project.final_orders_with_returns
[0m09:48:34.896487 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.top_customers"
[0m09:48:34.909823 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.monthly_returns_trend"
[0m09:48:34.927553 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.final_orders_with_returns"
[0m09:48:34.956125 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.product_performance"
[0m09:48:34.958136 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.top_customers"
[0m09:48:34.961785 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m09:48:34.962793 [debug] [Thread-4 (]: On model.superstore_project.product_performance: BEGIN
[0m09:48:34.971204 [debug] [Thread-1 (]: On model.superstore_project.top_customers: BEGIN
[0m09:48:34.975262 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m09:48:34.976270 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: BEGIN
[0m09:48:34.984224 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:48:34.991483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:34.996980 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: BEGIN
[0m09:48:35.003231 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:48:35.013598 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:48:35.017868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:48:35.019710 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:48:35.029260 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:48:35.030804 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.product_performance"
[0m09:48:35.037962 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.top_customers"
[0m09:48:35.049520 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m09:48:35.049944 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:48:35.056623 [debug] [Thread-4 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */

  create view "postgres_metabase1"."raw"."product_performance__dbt_tmp"
    
    
  as (
    SELECT
    product_name,
    product_category,
    product_subcategory,
    SUM(order_quantity) AS total_quantity_sold,
    SUM(sales) AS total_sales,
    SUM(profit) AS total_profit,
    ROUND(AVG(product_base_margin), 4) AS avg_margin,
    COUNT(DISTINCT order_id) AS num_orders
FROM "postgres_metabase1"."raw"."stg_orders"
GROUP BY 1, 2, 3
ORDER BY total_sales DESC
LIMIT 100
  );
[0m09:48:35.061253 [debug] [Thread-1 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */

  create view "postgres_metabase1"."raw"."top_customers__dbt_tmp"
    
    
  as (
    SELECT
    customer_name,
    customer_segment,
    region,
    SUM(sales) AS total_sales,
    COUNT(DISTINCT order_id) AS num_orders,
    ROUND(AVG(profit), 2) AS avg_profit
FROM "postgres_metabase1"."raw"."stg_orders"
GROUP BY 1, 2, 3
ORDER BY total_sales DESC
LIMIT 50
  );
[0m09:48:35.066672 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */

  create view "postgres_metabase1"."raw"."monthly_returns_trend__dbt_tmp"
    
    
  as (
    WITH orders_with_returns AS (
    SELECT
        o.order_id,
        o.order_date,
        r.status
    FROM "postgres_metabase1"."raw"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."raw"."stg_returns" r
        ON o.order_id = r.order_id
),
returns_by_month AS (
    SELECT
        DATE_TRUNC('month', order_date) AS month,
        COUNT(*) FILTER (WHERE status = 'Returned') AS returned_orders,
        COUNT(*) AS total_orders,
        ROUND(
            COUNT(*) FILTER (WHERE status = 'Returned')::decimal
            / NULLIF(COUNT(*), 0),
            2
        ) AS return_rate
    FROM orders_with_returns
    GROUP BY 1
)
SELECT *
FROM returns_by_month
ORDER BY month
  );
[0m09:48:35.070162 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m09:48:35.078777 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:48:35.083740 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:48:35.092143 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:48:35.094134 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */

  create view "postgres_metabase1"."raw"."final_orders_with_returns__dbt_tmp"
    
    
  as (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."raw"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."raw"."stg_returns" r
    ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."raw"."stg_users" u
    ON o.region = u.region
)
SELECT *
FROM orders_with_returns
  );
[0m09:48:35.102292 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.product_performance"
[0m09:48:35.111541 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.top_customers"
[0m09:48:35.119941 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m09:48:35.131068 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:48:35.135475 [debug] [Thread-4 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */
alter table "postgres_metabase1"."raw"."product_performance__dbt_tmp" rename to "product_performance"
[0m09:48:35.140555 [debug] [Thread-1 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */
alter table "postgres_metabase1"."raw"."top_customers__dbt_tmp" rename to "top_customers"
[0m09:48:35.148154 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */
alter table "postgres_metabase1"."raw"."monthly_returns_trend__dbt_tmp" rename to "monthly_returns_trend"
[0m09:48:35.155471 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m09:48:35.166994 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:48:35.175929 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:48:35.184980 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:48:35.193567 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
alter table "postgres_metabase1"."raw"."final_orders_with_returns__dbt_tmp" rename to "final_orders_with_returns"
[0m09:48:35.209580 [debug] [Thread-4 (]: On model.superstore_project.product_performance: COMMIT
[0m09:48:35.225782 [debug] [Thread-1 (]: On model.superstore_project.top_customers: COMMIT
[0m09:48:35.236690 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: COMMIT
[0m09:48:35.244746 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:48:35.250097 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.product_performance"
[0m09:48:35.258964 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.top_customers"
[0m09:48:35.270275 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m09:48:35.279667 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m09:48:35.287910 [debug] [Thread-4 (]: On model.superstore_project.product_performance: COMMIT
[0m09:48:35.294919 [debug] [Thread-1 (]: On model.superstore_project.top_customers: COMMIT
[0m09:48:35.302068 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: COMMIT
[0m09:48:35.308870 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m09:48:35.315853 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m09:48:35.324337 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:48:35.331354 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m09:48:35.337508 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m09:48:35.346700 [debug] [Thread-4 (]: Applying DROP to: "postgres_metabase1"."raw"."product_performance__dbt_backup"
[0m09:48:35.355351 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."raw"."top_customers__dbt_backup"
[0m09:48:35.367731 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."raw"."monthly_returns_trend__dbt_backup"
[0m09:48:35.377708 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m09:48:35.383856 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.product_performance"
[0m09:48:35.391232 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.top_customers"
[0m09:48:35.401482 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m09:48:35.409564 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."raw"."final_orders_with_returns__dbt_backup"
[0m09:48:35.418420 [debug] [Thread-4 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */
drop view if exists "postgres_metabase1"."raw"."product_performance__dbt_backup" cascade
[0m09:48:35.425147 [debug] [Thread-1 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */
drop view if exists "postgres_metabase1"."raw"."top_customers__dbt_backup" cascade
[0m09:48:35.431335 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */
drop view if exists "postgres_metabase1"."raw"."monthly_returns_trend__dbt_backup" cascade
[0m09:48:35.443176 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m09:48:35.450097 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:48:35.455945 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:48:35.459881 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:48:35.466731 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
drop view if exists "postgres_metabase1"."raw"."final_orders_with_returns__dbt_backup" cascade
[0m09:48:35.476632 [debug] [Thread-4 (]: Timing info for model.superstore_project.product_performance (execute): 09:48:34.835331 => 09:48:35.476429
[0m09:48:35.486209 [debug] [Thread-1 (]: Timing info for model.superstore_project.top_customers (execute): 09:48:34.892977 => 09:48:35.486015
[0m09:48:35.493390 [debug] [Thread-2 (]: Timing info for model.superstore_project.monthly_returns_trend (execute): 09:48:34.905649 => 09:48:35.493181
[0m09:48:35.502363 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:48:35.509738 [debug] [Thread-4 (]: On model.superstore_project.product_performance: Close
[0m09:48:35.516665 [debug] [Thread-1 (]: On model.superstore_project.top_customers: Close
[0m09:48:35.527586 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: Close
[0m09:48:35.537544 [debug] [Thread-3 (]: Timing info for model.superstore_project.final_orders_with_returns (execute): 09:48:34.924185 => 09:48:35.537319
[0m09:48:35.544994 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1804b71e10>]}
[0m09:48:35.551529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17f5fc62c0>]}
[0m09:48:35.558928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17f5fc6200>]}
[0m09:48:35.565699 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: Close
[0m09:48:35.574978 [info ] [Thread-4 (]: 4 of 8 OK created sql view model raw.product_performance ....................... [[32mCREATE VIEW[0m in 0.88s]
[0m09:48:35.582729 [info ] [Thread-1 (]: 5 of 8 OK created sql view model raw.top_customers ............................. [[32mCREATE VIEW[0m in 0.88s]
[0m09:48:35.597388 [info ] [Thread-2 (]: 6 of 8 OK created sql view model raw.monthly_returns_trend ..................... [[32mCREATE VIEW[0m in 0.88s]
[0m09:48:35.612030 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1804baaa70>]}
[0m09:48:35.625571 [debug] [Thread-4 (]: Finished running node model.superstore_project.product_performance
[0m09:48:35.638638 [debug] [Thread-1 (]: Finished running node model.superstore_project.top_customers
[0m09:48:35.649676 [debug] [Thread-2 (]: Finished running node model.superstore_project.monthly_returns_trend
[0m09:48:35.662952 [info ] [Thread-3 (]: 7 of 8 OK created sql view model raw.final_orders_with_returns ................. [[32mCREATE VIEW[0m in 0.93s]
[0m09:48:35.674290 [debug] [Thread-4 (]: Began running node model.superstore_project.mart_orders_summary_by_region
[0m09:48:35.697182 [debug] [Thread-3 (]: Finished running node model.superstore_project.final_orders_with_returns
[0m09:48:35.703184 [info ] [Thread-4 (]: 8 of 8 START sql view model raw.mart_orders_summary_by_region .................. [RUN]
[0m09:48:35.714433 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_project.product_performance, now model.superstore_project.mart_orders_summary_by_region)
[0m09:48:35.719485 [debug] [Thread-4 (]: Began compiling node model.superstore_project.mart_orders_summary_by_region
[0m09:48:35.731308 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.mart_orders_summary_by_region"
[0m09:48:35.778278 [debug] [Thread-4 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (compile): 09:48:35.724564 => 09:48:35.777913
[0m09:48:35.782310 [debug] [Thread-4 (]: Began executing node model.superstore_project.mart_orders_summary_by_region
[0m09:48:35.791225 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_project.mart_orders_summary_by_region"
[0m09:48:35.842601 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m09:48:35.847585 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: BEGIN
[0m09:48:35.851844 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:48:35.859913 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:48:35.864919 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m09:48:35.872218 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */

  create view "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_tmp"
    
    
  as (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."raw"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."raw"."stg_returns" r ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."raw"."stg_users" u ON o.region = u.region
),

region_summary AS (
    SELECT
        region,
        region_manager,
        COUNT(DISTINCT order_id) AS total_orders,
        COUNT(DISTINCT CASE WHEN return_status = 'Returned' THEN order_id END) AS returned_orders,
        ROUND(100.0 * COUNT(DISTINCT CASE WHEN return_status = 'Returned' THEN order_id END) / NULLIF(COUNT(DISTINCT order_id), 0), 2) AS return_rate_percent,
        SUM(sales) AS total_sales,
        SUM(profit) AS total_profit,
        ROUND(AVG(discount), 4) AS avg_discount
    FROM orders_with_returns
    GROUP BY region, region_manager
)

SELECT *
FROM region_summary
ORDER BY return_rate_percent DESC
  );
[0m09:48:35.882217 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:48:35.890794 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m09:48:35.896008 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
alter table "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_tmp" rename to "mart_orders_summary_by_region"
[0m09:48:35.906465 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:48:35.916778 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m09:48:35.921645 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m09:48:35.927775 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m09:48:35.936142 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m09:48:35.944677 [debug] [Thread-4 (]: Applying DROP to: "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_backup"
[0m09:48:35.949109 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m09:48:35.956198 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
drop view if exists "postgres_metabase1"."raw"."mart_orders_summary_by_region__dbt_backup" cascade
[0m09:48:35.962860 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:48:35.972450 [debug] [Thread-4 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (execute): 09:48:35.786162 => 09:48:35.972278
[0m09:48:35.980230 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: Close
[0m09:48:35.987081 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a18ab9-2991-4108-973c-7965cc214251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17f453e8c0>]}
[0m09:48:35.992566 [info ] [Thread-4 (]: 8 of 8 OK created sql view model raw.mart_orders_summary_by_region ............. [[32mCREATE VIEW[0m in 0.27s]
[0m09:48:36.000127 [debug] [Thread-4 (]: Finished running node model.superstore_project.mart_orders_summary_by_region
[0m09:48:36.009475 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:36.018285 [debug] [MainThread]: On master: BEGIN
[0m09:48:36.024789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:48:36.036345 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:48:36.043601 [debug] [MainThread]: On master: COMMIT
[0m09:48:36.051443 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:36.057604 [debug] [MainThread]: On master: COMMIT
[0m09:48:36.063994 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:48:36.070671 [debug] [MainThread]: On master: Close
[0m09:48:36.074542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:48:36.080151 [debug] [MainThread]: Connection 'model.superstore_project.top_customers' was properly closed.
[0m09:48:36.089037 [debug] [MainThread]: Connection 'model.superstore_project.monthly_returns_trend' was properly closed.
[0m09:48:36.096379 [debug] [MainThread]: Connection 'model.superstore_project.final_orders_with_returns' was properly closed.
[0m09:48:36.103368 [debug] [MainThread]: Connection 'model.superstore_project.mart_orders_summary_by_region' was properly closed.
[0m09:48:36.111897 [info ] [MainThread]: 
[0m09:48:36.117756 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m09:48:36.121775 [debug] [MainThread]: Command end result
[0m09:48:36.172067 [info ] [MainThread]: 
[0m09:48:36.179755 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:48:36.195744 [info ] [MainThread]: 
[0m09:48:36.198318 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m09:48:36.204659 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4563684, "process_user_time": 3.584929, "process_kernel_time": 0.367579, "process_mem_max_rss": "112020", "process_in_blocks": "80216", "process_out_blocks": "0"}
[0m09:48:36.208403 [debug] [MainThread]: Command `dbt run` succeeded at 09:48:36.208212 after 6.46 seconds
[0m09:48:36.211180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c18084a2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17f5e0e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c17f5fb57b0>]}
[0m09:48:36.213898 [debug] [MainThread]: Flushing usage events
[0m09:54:03.372494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e789ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e5b06110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e5b060b0>]}


============================== 09:54:03.377496 | 91a546d8-b94e-4012-acf5-c12443fdb24e ==============================
[0m09:54:03.377496 [info ] [MainThread]: Running with dbt=1.7.4
[0m09:54:03.379390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/profiles', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:54:03.614376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91a546d8-b94e-4012-acf5-c12443fdb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e5b06200>]}
[0m09:54:03.695200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91a546d8-b94e-4012-acf5-c12443fdb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e5b05db0>]}
[0m09:54:03.698964 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m09:54:03.713894 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m09:54:03.925669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:54:03.927944 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:54:03.934218 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.stg
- models.marts
[0m09:54:03.943146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91a546d8-b94e-4012-acf5-c12443fdb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e3eb65f0>]}
[0m09:54:04.058813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91a546d8-b94e-4012-acf5-c12443fdb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e407d0c0>]}
[0m09:54:04.078582 [info ] [MainThread]: Found 8 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:54:04.094477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a546d8-b94e-4012-acf5-c12443fdb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e407d420>]}
[0m09:54:04.114684 [info ] [MainThread]: 
[0m09:54:04.123942 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:54:04.133901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1_raw'
[0m09:54:04.165361 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m09:54:04.167638 [debug] [ThreadPool]: On list_postgres_metabase1_raw: BEGIN
[0m09:54:04.169548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:04.196046 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:54:04.198633 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_raw"
[0m09:54:04.201800 [debug] [ThreadPool]: On list_postgres_metabase1_raw: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1_raw"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m09:54:04.214203 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m09:54:04.222240 [debug] [ThreadPool]: On list_postgres_metabase1_raw: ROLLBACK
[0m09:54:04.229772 [debug] [ThreadPool]: On list_postgres_metabase1_raw: Close
[0m09:54:04.258360 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:04.261012 [debug] [MainThread]: On master: BEGIN
[0m09:54:04.263650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:54:04.300472 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:54:04.308146 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:04.317159 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:54:04.346511 [debug] [MainThread]: SQL status: SELECT 44 in 0.0 seconds
[0m09:54:04.358943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a546d8-b94e-4012-acf5-c12443fdb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e407c790>]}
[0m09:54:04.363792 [debug] [MainThread]: On master: ROLLBACK
[0m09:54:04.369401 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:04.374442 [debug] [MainThread]: On master: BEGIN
[0m09:54:04.379373 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:54:04.383745 [debug] [MainThread]: On master: COMMIT
[0m09:54:04.388159 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:04.401839 [debug] [MainThread]: On master: COMMIT
[0m09:54:04.408539 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:54:04.415082 [debug] [MainThread]: On master: Close
[0m09:54:04.425852 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:54:04.431846 [info ] [MainThread]: 
[0m09:54:04.450538 [debug] [Thread-1 (]: Began running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m09:54:04.452019 [debug] [Thread-2 (]: Began running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m09:54:04.453215 [debug] [Thread-3 (]: Began running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m09:54:04.454432 [debug] [Thread-4 (]: Began running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m09:54:04.456249 [info ] [Thread-1 (]: 1 of 7 START test not_null_stg_orders_order_id ................................. [RUN]
[0m09:54:04.460870 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_orders_region ................................... [RUN]
[0m09:54:04.465495 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_returns_order_id ................................ [RUN]
[0m09:54:04.470845 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_users_region .................................... [RUN]
[0m09:54:04.474263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1_raw, now test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m09:54:04.478140 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.superstore_project.not_null_stg_orders_region.c7b18a6907'
[0m09:54:04.481367 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e'
[0m09:54:04.486724 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_project.not_null_stg_users_region.97049f06a2'
[0m09:54:04.490932 [debug] [Thread-1 (]: Began compiling node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m09:54:04.493252 [debug] [Thread-2 (]: Began compiling node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m09:54:04.496047 [debug] [Thread-3 (]: Began compiling node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m09:54:04.499786 [debug] [Thread-4 (]: Began compiling node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m09:54:04.517301 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:54:04.522046 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m09:54:04.527130 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m09:54:04.532101 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m09:54:04.542857 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (compile): 09:54:04.502463 => 09:54:04.542594
[0m09:54:04.545610 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (compile): 09:54:04.528958 => 09:54:04.545366
[0m09:54:04.547371 [debug] [Thread-1 (]: Began executing node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m09:54:04.548173 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (compile): 09:54:04.523819 => 09:54:04.547945
[0m09:54:04.550480 [debug] [Thread-4 (]: Began executing node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m09:54:04.553166 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (compile): 09:54:04.518772 => 09:54:04.552700
[0m09:54:04.567351 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:54:04.568178 [debug] [Thread-3 (]: Began executing node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m09:54:04.573712 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m09:54:04.576387 [debug] [Thread-2 (]: Began executing node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m09:54:04.583767 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m09:54:04.594481 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m09:54:04.598864 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:54:04.601453 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m09:54:04.602896 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m09:54:04.610589 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: BEGIN
[0m09:54:04.611038 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m09:54:04.613183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:04.614672 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m09:54:04.617551 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:54:04.622695 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: BEGIN
[0m09:54:04.629622 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: BEGIN
[0m09:54:04.636285 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:54:04.637877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:54:04.639302 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:54:04.640081 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:54:04.643440 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m09:54:04.646552 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:54:04.647390 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m09:54:04.649594 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m09:54:04.650736 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres_metabase1"."raw"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m09:54:04.659736 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m09:54:04.662391 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_users_region.97049f06a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "postgres_metabase1"."raw"."stg_users"
where region is null



      
    ) dbt_internal_test
[0m09:54:04.669284 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m09:54:04.679102 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres_metabase1"."raw"."stg_returns"
where order_id is null



      
    ) dbt_internal_test
[0m09:54:04.684542 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:54:04.687192 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_orders_region.c7b18a6907"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "postgres_metabase1"."raw"."stg_orders"
where region is null



      
    ) dbt_internal_test
[0m09:54:04.690915 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:54:04.697596 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:54:04.704977 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (execute): 09:54:04.571911 => 09:54:04.703875
[0m09:54:04.714774 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:54:04.727152 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (execute): 09:54:04.554616 => 09:54:04.725808
[0m09:54:04.734945 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (execute): 09:54:04.581663 => 09:54:04.733894
[0m09:54:04.739654 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: ROLLBACK
[0m09:54:04.755173 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (execute): 09:54:04.591164 => 09:54:04.753702
[0m09:54:04.760750 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m09:54:04.772082 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: ROLLBACK
[0m09:54:04.780408 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: Close
[0m09:54:04.788361 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: ROLLBACK
[0m09:54:04.795389 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m09:54:04.799254 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: Close
[0m09:54:04.802194 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_users_region .......................................... [[32mPASS[0m in 0.32s]
[0m09:54:04.805119 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: Close
[0m09:54:04.809238 [info ] [Thread-1 (]: 1 of 7 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.34s]
[0m09:54:04.813484 [info ] [Thread-3 (]: 3 of 7 PASS not_null_stg_returns_order_id ...................................... [[32mPASS[0m in 0.33s]
[0m09:54:04.817330 [debug] [Thread-4 (]: Finished running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m09:54:04.822285 [info ] [Thread-2 (]: 2 of 7 PASS not_null_stg_orders_region ......................................... [[32mPASS[0m in 0.34s]
[0m09:54:04.825436 [debug] [Thread-1 (]: Finished running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m09:54:04.827830 [debug] [Thread-3 (]: Finished running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m09:54:04.830096 [debug] [Thread-4 (]: Began running node test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8
[0m09:54:04.839891 [debug] [Thread-2 (]: Finished running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m09:54:04.841930 [debug] [Thread-1 (]: Began running node test.superstore_project.unique_stg_orders_order_id.e3b841c71a
[0m09:54:04.843652 [debug] [Thread-3 (]: Began running node test.superstore_project.unique_stg_users_region.b6aeae0132
[0m09:54:04.845221 [info ] [Thread-4 (]: 5 of 7 START test unique_final_orders_with_returns_order_id .................... [RUN]
[0m09:54:04.850140 [info ] [Thread-1 (]: 6 of 7 START test unique_stg_orders_order_id ................................... [RUN]
[0m09:54:04.853950 [info ] [Thread-3 (]: 7 of 7 START test unique_stg_users_region ...................................... [RUN]
[0m09:54:04.856245 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_users_region.97049f06a2, now test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8)
[0m09:54:04.859143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64, now test.superstore_project.unique_stg_orders_order_id.e3b841c71a)
[0m09:54:04.861841 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e, now test.superstore_project.unique_stg_users_region.b6aeae0132)
[0m09:54:04.864227 [debug] [Thread-4 (]: Began compiling node test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8
[0m09:54:04.866501 [debug] [Thread-1 (]: Began compiling node test.superstore_project.unique_stg_orders_order_id.e3b841c71a
[0m09:54:04.868982 [debug] [Thread-3 (]: Began compiling node test.superstore_project.unique_stg_users_region.b6aeae0132
[0m09:54:04.877834 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"
[0m09:54:04.883813 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"
[0m09:54:04.889661 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.unique_stg_users_region.b6aeae0132"
[0m09:54:04.906713 [debug] [Thread-3 (]: Timing info for test.superstore_project.unique_stg_users_region.b6aeae0132 (compile): 09:54:04.886196 => 09:54:04.906432
[0m09:54:04.908317 [debug] [Thread-4 (]: Timing info for test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8 (compile): 09:54:04.871194 => 09:54:04.908050
[0m09:54:04.909543 [debug] [Thread-3 (]: Began executing node test.superstore_project.unique_stg_users_region.b6aeae0132
[0m09:54:04.918870 [debug] [Thread-1 (]: Timing info for test.superstore_project.unique_stg_orders_order_id.e3b841c71a (compile): 09:54:04.880078 => 09:54:04.918238
[0m09:54:04.919846 [debug] [Thread-4 (]: Began executing node test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8
[0m09:54:04.932484 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_project.unique_stg_users_region.b6aeae0132"
[0m09:54:04.934332 [debug] [Thread-1 (]: Began executing node test.superstore_project.unique_stg_orders_order_id.e3b841c71a
[0m09:54:04.986603 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"
[0m09:54:04.993015 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"
[0m09:54:05.028278 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.unique_stg_users_region.b6aeae0132"
[0m09:54:05.037775 [debug] [Thread-3 (]: On test.superstore_project.unique_stg_users_region.b6aeae0132: BEGIN
[0m09:54:05.041090 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"
[0m09:54:05.061337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:54:05.064924 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"
[0m09:54:05.071619 [debug] [Thread-4 (]: On test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8: BEGIN
[0m09:54:05.090200 [debug] [Thread-1 (]: On test.superstore_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m09:54:05.101140 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:54:05.112182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:05.118601 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m09:54:05.139330 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.unique_stg_users_region.b6aeae0132"
[0m09:54:05.145495 [debug] [Thread-3 (]: On test.superstore_project.unique_stg_users_region.b6aeae0132: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.unique_stg_users_region.b6aeae0132"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    region as unique_field,
    count(*) as n_records

from "postgres_metabase1"."raw"."stg_users"
where region is not null
group by region
having count(*) > 1



      
    ) dbt_internal_test
[0m09:54:05.149780 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m09:54:05.151196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:54:05.155593 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:54:05.156140 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"
[0m09:54:05.157801 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"
[0m09:54:05.163057 [debug] [Thread-3 (]: Timing info for test.superstore_project.unique_stg_users_region.b6aeae0132 (execute): 09:54:04.926154 => 09:54:05.162730
[0m09:54:05.165854 [debug] [Thread-4 (]: On test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres_metabase1"."raw"."final_orders_with_returns"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:54:05.169081 [debug] [Thread-1 (]: On test.superstore_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres_metabase1"."raw"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:54:05.172427 [debug] [Thread-3 (]: On test.superstore_project.unique_stg_users_region.b6aeae0132: ROLLBACK
[0m09:54:05.178601 [debug] [Thread-3 (]: On test.superstore_project.unique_stg_users_region.b6aeae0132: Close
[0m09:54:05.183099 [info ] [Thread-3 (]: 7 of 7 PASS unique_stg_users_region ............................................ [[32mPASS[0m in 0.32s]
[0m09:54:05.185216 [debug] [Thread-3 (]: Finished running node test.superstore_project.unique_stg_users_region.b6aeae0132
[0m09:54:05.186153 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:54:05.188016 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:54:05.189279 [debug] [Thread-1 (]: Timing info for test.superstore_project.unique_stg_orders_order_id.e3b841c71a (execute): 09:54:04.990503 => 09:54:05.189071
[0m09:54:05.191838 [debug] [Thread-4 (]: Timing info for test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8 (execute): 09:54:04.937021 => 09:54:05.191612
[0m09:54:05.193420 [debug] [Thread-1 (]: On test.superstore_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m09:54:05.195344 [debug] [Thread-4 (]: On test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8: ROLLBACK
[0m09:54:05.196983 [debug] [Thread-1 (]: On test.superstore_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m09:54:05.198265 [debug] [Thread-4 (]: On test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8: Close
[0m09:54:05.199780 [error] [Thread-1 (]: 6 of 7 FAIL 2156 unique_stg_orders_order_id .................................... [[31mFAIL 2156[0m in 0.34s]
[0m09:54:05.203465 [error] [Thread-4 (]: 5 of 7 FAIL 2156 unique_final_orders_with_returns_order_id ..................... [[31mFAIL 2156[0m in 0.35s]
[0m09:54:05.205103 [debug] [Thread-1 (]: Finished running node test.superstore_project.unique_stg_orders_order_id.e3b841c71a
[0m09:54:05.206909 [debug] [Thread-4 (]: Finished running node test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8
[0m09:54:05.212801 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:05.215770 [debug] [MainThread]: On master: BEGIN
[0m09:54:05.217339 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:54:05.226274 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:54:05.228111 [debug] [MainThread]: On master: COMMIT
[0m09:54:05.229824 [debug] [MainThread]: Using postgres connection "master"
[0m09:54:05.232163 [debug] [MainThread]: On master: COMMIT
[0m09:54:05.234269 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:54:05.235654 [debug] [MainThread]: On master: Close
[0m09:54:05.237643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:05.239721 [debug] [MainThread]: Connection 'test.superstore_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m09:54:05.241646 [debug] [MainThread]: Connection 'test.superstore_project.not_null_stg_orders_region.c7b18a6907' was properly closed.
[0m09:54:05.243366 [debug] [MainThread]: Connection 'test.superstore_project.unique_stg_users_region.b6aeae0132' was properly closed.
[0m09:54:05.245117 [debug] [MainThread]: Connection 'test.superstore_project.unique_final_orders_with_returns_order_id.3be99a67c8' was properly closed.
[0m09:54:05.246722 [info ] [MainThread]: 
[0m09:54:05.248529 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m09:54:05.250710 [debug] [MainThread]: Command end result
[0m09:54:05.294439 [info ] [MainThread]: 
[0m09:54:05.296334 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m09:54:05.298648 [info ] [MainThread]: 
[0m09:54:05.301245 [error] [MainThread]: [31mFailure in test unique_stg_orders_order_id (models/schema.yml)[0m
[0m09:54:05.304303 [error] [MainThread]:   Got 2156 results, configured to fail if != 0
[0m09:54:05.308389 [info ] [MainThread]: 
[0m09:54:05.312406 [info ] [MainThread]:   compiled Code at target/compiled/superstore_project/models/schema.yml/unique_stg_orders_order_id.sql
[0m09:54:05.316288 [info ] [MainThread]: 
[0m09:54:05.318808 [error] [MainThread]: [31mFailure in test unique_final_orders_with_returns_order_id (models/schema.yml)[0m
[0m09:54:05.323414 [error] [MainThread]:   Got 2156 results, configured to fail if != 0
[0m09:54:05.326579 [info ] [MainThread]: 
[0m09:54:05.328337 [info ] [MainThread]:   compiled Code at target/compiled/superstore_project/models/schema.yml/unique_final_orders_with_returns_order_id.sql
[0m09:54:05.329770 [info ] [MainThread]: 
[0m09:54:05.331404 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m09:54:05.336237 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 2.0416315, "process_user_time": 2.5943, "process_kernel_time": 0.33033, "process_mem_max_rss": "105072", "process_in_blocks": "80832", "command_success": false, "process_out_blocks": "0"}
[0m09:54:05.339399 [debug] [MainThread]: Command `dbt test` failed at 09:54:05.339221 after 2.04 seconds
[0m09:54:05.341423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e789ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e3db1f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da5e4300310>]}
[0m09:54:05.344360 [debug] [MainThread]: Flushing usage events
[0m10:23:19.589221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb848e14850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb84707e080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb84707e020>]}


============================== 10:23:19.601293 | 3d158d3e-7b17-48da-b524-b2dadc7fb51a ==============================
[0m10:23:19.601293 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:23:19.604602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:23:19.879019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb84707e170>]}
[0m10:23:19.965204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb845633b20>]}
[0m10:23:19.969062 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m10:23:19.983297 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:23:20.028481 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:23:20.030441 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:23:20.031581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb845632ce0>]}
[0m10:23:21.477807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb82687d270>]}
[0m10:23:21.795643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb8441007f0>]}
[0m10:23:21.799162 [info ] [MainThread]: Found 8 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:23:21.802078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb845526e90>]}
[0m10:23:21.808676 [info ] [MainThread]: 
[0m10:23:21.814192 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:23:21.826495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m10:23:21.829920 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m10:23:21.869085 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m10:23:21.872772 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m10:23:21.875772 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m10:23:21.878957 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m10:23:21.882887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:21.886897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:21.926730 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:23:21.927348 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:23:21.930463 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m10:23:21.934443 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m10:23:21.941115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now create_postgres_metabase1_analytics_staging)
[0m10:23:21.941939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now create_postgres_metabase1_analytics_analytics)
[0m10:23:21.944052 [debug] [ThreadPool]: Creating schema "database: "postgres_metabase1"
schema: "analytics_staging"
"
[0m10:23:21.946933 [debug] [ThreadPool]: Creating schema "database: "postgres_metabase1"
schema: "analytics_analytics"
"
[0m10:23:21.952744 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1_analytics_staging"
[0m10:23:21.955745 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1_analytics_analytics"
[0m10:23:21.956902 [debug] [ThreadPool]: On create_postgres_metabase1_analytics_staging: BEGIN
[0m10:23:21.958050 [debug] [ThreadPool]: On create_postgres_metabase1_analytics_analytics: BEGIN
[0m10:23:21.958974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:21.959948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:21.966875 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:23:21.967940 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:23:21.968989 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1_analytics_staging"
[0m10:23:21.970213 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1_analytics_analytics"
[0m10:23:21.971276 [debug] [ThreadPool]: On create_postgres_metabase1_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "create_postgres_metabase1_analytics_staging"} */
create schema if not exists "analytics_staging"
[0m10:23:21.972481 [debug] [ThreadPool]: On create_postgres_metabase1_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "create_postgres_metabase1_analytics_analytics"} */
create schema if not exists "analytics_analytics"
[0m10:23:21.974986 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m10:23:21.975379 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m10:23:21.976954 [debug] [ThreadPool]: On create_postgres_metabase1_analytics_staging: COMMIT
[0m10:23:21.978949 [debug] [ThreadPool]: On create_postgres_metabase1_analytics_analytics: COMMIT
[0m10:23:21.980167 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1_analytics_staging"
[0m10:23:21.981857 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1_analytics_analytics"
[0m10:23:21.983124 [debug] [ThreadPool]: On create_postgres_metabase1_analytics_staging: COMMIT
[0m10:23:21.984427 [debug] [ThreadPool]: On create_postgres_metabase1_analytics_analytics: COMMIT
[0m10:23:21.986606 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m10:23:21.987409 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m10:23:21.988173 [debug] [ThreadPool]: On create_postgres_metabase1_analytics_staging: Close
[0m10:23:21.989389 [debug] [ThreadPool]: On create_postgres_metabase1_analytics_analytics: Close
[0m10:23:21.993731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_metabase1_analytics_analytics, now list_postgres_metabase1_analytics_staging)
[0m10:23:21.994627 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_metabase1_analytics_staging, now list_postgres_metabase1_analytics_analytics)
[0m10:23:22.000649 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_analytics_staging"
[0m10:23:22.003268 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_analytics_analytics"
[0m10:23:22.004454 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_staging: BEGIN
[0m10:23:22.005519 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_analytics: BEGIN
[0m10:23:22.006529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:22.007670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:22.013565 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:23:22.014146 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:23:22.014844 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_analytics_staging"
[0m10:23:22.016012 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_analytics_analytics"
[0m10:23:22.017091 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1_analytics_staging"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m10:23:22.018197 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1_analytics_analytics"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m10:23:22.022653 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:23:22.023460 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:23:22.024716 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_staging: ROLLBACK
[0m10:23:22.026549 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_analytics: ROLLBACK
[0m10:23:22.027703 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_staging: Close
[0m10:23:22.028535 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_analytics: Close
[0m10:23:22.033986 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:22.035107 [debug] [MainThread]: On master: BEGIN
[0m10:23:22.036293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:23:22.042264 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:23:22.043577 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:22.044617 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:23:22.050303 [debug] [MainThread]: SQL status: SELECT 44 in 0.0 seconds
[0m10:23:22.052728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb82687d780>]}
[0m10:23:22.053961 [debug] [MainThread]: On master: ROLLBACK
[0m10:23:22.055091 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:22.056124 [debug] [MainThread]: On master: BEGIN
[0m10:23:22.057331 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:23:22.058418 [debug] [MainThread]: On master: COMMIT
[0m10:23:22.059568 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:22.060750 [debug] [MainThread]: On master: COMMIT
[0m10:23:22.062001 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:23:22.062958 [debug] [MainThread]: On master: Close
[0m10:23:22.064379 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:23:22.065533 [info ] [MainThread]: 
[0m10:23:22.071288 [debug] [Thread-1 (]: Began running node model.superstore_project.stg_orders
[0m10:23:22.071732 [debug] [Thread-2 (]: Began running node model.superstore_project.stg_returns
[0m10:23:22.072111 [debug] [Thread-3 (]: Began running node model.superstore_project.stg_users
[0m10:23:22.073090 [info ] [Thread-1 (]: 1 of 8 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m10:23:22.074589 [info ] [Thread-2 (]: 2 of 8 START sql view model analytics_staging.stg_returns ...................... [RUN]
[0m10:23:22.076662 [info ] [Thread-3 (]: 3 of 8 START sql view model analytics_staging.stg_users ........................ [RUN]
[0m10:23:22.078144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1_analytics_analytics, now model.superstore_project.stg_orders)
[0m10:23:22.080575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1_analytics_staging, now model.superstore_project.stg_returns)
[0m10:23:22.083962 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_project.stg_users'
[0m10:23:22.085779 [debug] [Thread-1 (]: Began compiling node model.superstore_project.stg_orders
[0m10:23:22.087430 [debug] [Thread-2 (]: Began compiling node model.superstore_project.stg_returns
[0m10:23:22.088903 [debug] [Thread-3 (]: Began compiling node model.superstore_project.stg_users
[0m10:23:22.096932 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.stg_orders"
[0m10:23:22.101450 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.stg_returns"
[0m10:23:22.105004 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.stg_users"
[0m10:23:22.117591 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (compile): 10:23:22.097959 => 10:23:22.117250
[0m10:23:22.118170 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (compile): 10:23:22.090009 => 10:23:22.117859
[0m10:23:22.126862 [debug] [Thread-2 (]: Began executing node model.superstore_project.stg_returns
[0m10:23:22.135954 [debug] [Thread-1 (]: Began executing node model.superstore_project.stg_orders
[0m10:23:22.144868 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (compile): 10:23:22.102844 => 10:23:22.144328
[0m10:23:22.206102 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.stg_orders"
[0m10:23:22.207958 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.stg_returns"
[0m10:23:22.208425 [debug] [Thread-3 (]: Began executing node model.superstore_project.stg_users
[0m10:23:22.219072 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.stg_users"
[0m10:23:22.230980 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m10:23:22.233447 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m10:23:22.235002 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: BEGIN
[0m10:23:22.240265 [debug] [Thread-3 (]: On model.superstore_project.stg_users: BEGIN
[0m10:23:22.245402 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:23:22.259621 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:23:22.277301 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m10:23:22.285456 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: BEGIN
[0m10:23:22.294585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:22.298553 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:22.302589 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:22.310783 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m10:23:22.318448 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m10:23:22.320969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:22.325197 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */

  create view "postgres_metabase1"."analytics_staging"."stg_returns__dbt_tmp"
    
    
  as (
    WITH raw_returns AS (
    SELECT
        order_id,
        status
    FROM "postgres_metabase1"."raw"."returns"
)
SELECT *
FROM raw_returns
  );
[0m10:23:22.332742 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */

  create view "postgres_metabase1"."analytics_staging"."stg_users__dbt_tmp"
    
    
  as (
    WITH raw_users AS (
    SELECT
        region,
        manager
    FROM "postgres_metabase1"."raw"."managers"
)
SELECT *
FROM raw_users
  );
[0m10:23:22.339228 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m10:23:22.364939 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:23:22.366676 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:23:22.368324 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */

  create view "postgres_metabase1"."analytics_staging"."stg_orders__dbt_tmp"
    
    
  as (
    WITH raw_orders AS (
    SELECT
        row_id,
        order_id,
        order_date,
        ship_date,
        ship_mode,
        order_priority,
        product_container,
        customer_name,
        customer_segment,
        zip_code,
        state,
        city,
        region,
        product_category,
        product_subcategory,
        product_name,
        unit_price,
        quantity AS order_quantity,
        sales,
        profit,
        discount,
        shipping_cost,
        product_base_margin
    FROM "postgres_metabase1"."raw"."orders"
)
SELECT *
FROM raw_orders
  );
[0m10:23:22.399849 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m10:23:22.404956 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m10:23:22.411320 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
alter table "postgres_metabase1"."analytics_staging"."stg_returns__dbt_tmp" rename to "stg_returns"
[0m10:23:22.413522 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:23:22.415078 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
alter table "postgres_metabase1"."analytics_staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m10:23:22.421592 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:23:22.433828 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m10:23:22.439406 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:23:22.459072 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m10:23:22.459578 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
alter table "postgres_metabase1"."analytics_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:23:22.462430 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m10:23:22.464196 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m10:23:22.466633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:23:22.467642 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m10:23:22.469687 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m10:23:22.474817 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m10:23:22.477832 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m10:23:22.483166 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m10:23:22.485416 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:23:22.486139 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:23:22.486770 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m10:23:22.493943 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."analytics_staging"."stg_returns__dbt_backup"
[0m10:23:22.497009 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."analytics_staging"."stg_users__dbt_backup"
[0m10:23:22.499464 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:23:22.503820 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m10:23:22.505728 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m10:23:22.508992 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."analytics_staging"."stg_orders__dbt_backup"
[0m10:23:22.510820 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
drop view if exists "postgres_metabase1"."analytics_staging"."stg_returns__dbt_backup" cascade
[0m10:23:22.512056 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
drop view if exists "postgres_metabase1"."analytics_staging"."stg_users__dbt_backup" cascade
[0m10:23:22.513724 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m10:23:22.517152 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:23:22.525105 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:23:22.531377 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
drop view if exists "postgres_metabase1"."analytics_staging"."stg_orders__dbt_backup" cascade
[0m10:23:22.538072 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (execute): 10:23:22.139028 => 10:23:22.537637
[0m10:23:22.543511 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (execute): 10:23:22.214576 => 10:23:22.543113
[0m10:23:22.547033 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:23:22.549753 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: Close
[0m10:23:22.558915 [debug] [Thread-3 (]: On model.superstore_project.stg_users: Close
[0m10:23:22.570687 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (execute): 10:23:22.165161 => 10:23:22.569623
[0m10:23:22.580901 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb8268c2a10>]}
[0m10:23:22.588162 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb826771a20>]}
[0m10:23:22.593212 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: Close
[0m10:23:22.600612 [info ] [Thread-2 (]: 2 of 8 OK created sql view model analytics_staging.stg_returns ................. [[32mCREATE VIEW[0m in 0.50s]
[0m10:23:22.611435 [info ] [Thread-3 (]: 3 of 8 OK created sql view model analytics_staging.stg_users ................... [[32mCREATE VIEW[0m in 0.50s]
[0m10:23:22.615929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb8267499c0>]}
[0m10:23:22.618183 [debug] [Thread-2 (]: Finished running node model.superstore_project.stg_returns
[0m10:23:22.621305 [debug] [Thread-3 (]: Finished running node model.superstore_project.stg_users
[0m10:23:22.626100 [info ] [Thread-1 (]: 1 of 8 OK created sql view model analytics_staging.stg_orders .................. [[32mCREATE VIEW[0m in 0.54s]
[0m10:23:22.636699 [debug] [Thread-1 (]: Finished running node model.superstore_project.stg_orders
[0m10:23:22.643826 [debug] [Thread-4 (]: Began running node model.superstore_project.final_orders_with_returns
[0m10:23:22.644425 [debug] [Thread-2 (]: Began running node model.superstore_project.mart_orders_summary_by_region
[0m10:23:22.644914 [debug] [Thread-3 (]: Began running node model.superstore_project.monthly_returns_trend
[0m10:23:22.645353 [debug] [Thread-1 (]: Began running node model.superstore_project.product_performance
[0m10:23:22.647290 [info ] [Thread-4 (]: 4 of 8 START sql table model analytics_analytics.final_orders_with_returns ..... [RUN]
[0m10:23:22.650246 [info ] [Thread-2 (]: 5 of 8 START sql table model analytics_analytics.mart_orders_summary_by_region . [RUN]
[0m10:23:22.653197 [info ] [Thread-3 (]: 6 of 8 START sql table model analytics_analytics.monthly_returns_trend ......... [RUN]
[0m10:23:22.657916 [info ] [Thread-1 (]: 7 of 8 START sql table model analytics_analytics.product_performance ........... [RUN]
[0m10:23:22.666947 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_project.final_orders_with_returns'
[0m10:23:22.669308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_returns, now model.superstore_project.mart_orders_summary_by_region)
[0m10:23:22.672068 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_users, now model.superstore_project.monthly_returns_trend)
[0m10:23:22.681787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_orders, now model.superstore_project.product_performance)
[0m10:23:22.690865 [debug] [Thread-4 (]: Began compiling node model.superstore_project.final_orders_with_returns
[0m10:23:22.696831 [debug] [Thread-2 (]: Began compiling node model.superstore_project.mart_orders_summary_by_region
[0m10:23:22.701330 [debug] [Thread-3 (]: Began compiling node model.superstore_project.monthly_returns_trend
[0m10:23:22.709886 [debug] [Thread-1 (]: Began compiling node model.superstore_project.product_performance
[0m10:23:22.721484 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.final_orders_with_returns"
[0m10:23:22.792626 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.mart_orders_summary_by_region"
[0m10:23:22.798690 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.monthly_returns_trend"
[0m10:23:22.809995 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.product_performance"
[0m10:23:22.885504 [debug] [Thread-4 (]: Timing info for model.superstore_project.final_orders_with_returns (compile): 10:23:22.714052 => 10:23:22.883855
[0m10:23:22.895371 [debug] [Thread-4 (]: Began executing node model.superstore_project.final_orders_with_returns
[0m10:23:22.898744 [debug] [Thread-2 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (compile): 10:23:22.724953 => 10:23:22.897335
[0m10:23:22.941844 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_project.final_orders_with_returns"
[0m10:23:22.942677 [debug] [Thread-3 (]: Timing info for model.superstore_project.monthly_returns_trend (compile): 10:23:22.794988 => 10:23:22.942427
[0m10:23:22.943637 [debug] [Thread-2 (]: Began executing node model.superstore_project.mart_orders_summary_by_region
[0m10:23:22.946409 [debug] [Thread-1 (]: Timing info for model.superstore_project.product_performance (compile): 10:23:22.805461 => 10:23:22.946141
[0m10:23:22.947920 [debug] [Thread-3 (]: Began executing node model.superstore_project.monthly_returns_trend
[0m10:23:22.953643 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.mart_orders_summary_by_region"
[0m10:23:22.956931 [debug] [Thread-1 (]: Began executing node model.superstore_project.product_performance
[0m10:23:22.962052 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.monthly_returns_trend"
[0m10:23:22.973284 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.product_performance"
[0m10:23:22.976787 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m10:23:22.977406 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m10:23:22.980789 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: BEGIN
[0m10:23:22.982950 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: BEGIN
[0m10:23:22.985260 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:23:22.987413 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:23:23.005203 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:23.010113 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:23.010730 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m10:23:23.014276 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m10:23:23.017482 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */

  
    

  create  table "postgres_metabase1"."analytics_analytics"."final_orders_with_returns__dbt_tmp"
  
  
    as
  
  (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."analytics_staging"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."analytics_staging"."stg_returns" r
    ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."analytics_staging"."stg_users" u
    ON o.region = u.region
)
SELECT *
FROM orders_with_returns
  );
  
[0m10:23:23.021203 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */

  
    

  create  table "postgres_metabase1"."analytics_analytics"."mart_orders_summary_by_region__dbt_tmp"
  
  
    as
  
  (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."analytics_staging"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."analytics_staging"."stg_returns" r ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."analytics_staging"."stg_users" u ON o.region = u.region
),

region_summary AS (
    SELECT
        region,
        region_manager,
        COUNT(DISTINCT order_id) AS total_orders,
        COUNT(DISTINCT CASE WHEN return_status = 'Returned' THEN order_id END) AS returned_orders,
        ROUND(100.0 * COUNT(DISTINCT CASE WHEN return_status = 'Returned' THEN order_id END) / NULLIF(COUNT(DISTINCT order_id), 0), 2) AS return_rate_percent,
        SUM(sales) AS total_sales,
        SUM(profit) AS total_profit,
        ROUND(AVG(discount), 4) AS avg_discount
    FROM orders_with_returns
    GROUP BY region, region_manager
)

SELECT *
FROM region_summary
ORDER BY return_rate_percent DESC
  );
  
[0m10:23:23.023246 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m10:23:23.027317 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.product_performance"
[0m10:23:23.030675 [debug] [Thread-3 (]: On model.superstore_project.monthly_returns_trend: BEGIN
[0m10:23:23.033476 [debug] [Thread-1 (]: On model.superstore_project.product_performance: BEGIN
[0m10:23:23.036740 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:23:23.040116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:23.050143 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:23.051683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:23.052676 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m10:23:23.053043 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.0 seconds
[0m10:23:23.054640 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.product_performance"
[0m10:23:23.056748 [debug] [Thread-3 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */

  
    

  create  table "postgres_metabase1"."analytics_analytics"."monthly_returns_trend__dbt_tmp"
  
  
    as
  
  (
    WITH orders_with_returns AS (
    SELECT
        o.order_id,
        o.order_date,
        r.status
    FROM "postgres_metabase1"."analytics_staging"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."analytics_staging"."stg_returns" r
        ON o.order_id = r.order_id
),
returns_by_month AS (
    SELECT
        DATE_TRUNC('month', order_date) AS month,
        COUNT(*) FILTER (WHERE status = 'Returned') AS returned_orders,
        COUNT(*) AS total_orders,
        ROUND(
            COUNT(*) FILTER (WHERE status = 'Returned')::decimal
            / NULLIF(COUNT(*), 0),
            2
        ) AS return_rate
    FROM orders_with_returns
    GROUP BY 1
)
SELECT *
FROM returns_by_month
ORDER BY month
  );
  
[0m10:23:23.057640 [debug] [Thread-4 (]: SQL status: SELECT 8399 in 0.0 seconds
[0m10:23:23.061724 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m10:23:23.064157 [debug] [Thread-1 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */

  
    

  create  table "postgres_metabase1"."analytics_analytics"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_name,
    product_category,
    product_subcategory,
    SUM(order_quantity) AS total_quantity_sold,
    SUM(sales) AS total_sales,
    SUM(profit) AS total_profit,
    ROUND(AVG(product_base_margin), 4) AS avg_margin,
    COUNT(DISTINCT order_id) AS num_orders
FROM "postgres_metabase1"."analytics_staging"."stg_orders"
GROUP BY 1, 2, 3
ORDER BY total_sales DESC
LIMIT 100
  );
  
[0m10:23:23.071212 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m10:23:23.073447 [debug] [Thread-3 (]: SQL status: SELECT 48 in 0.0 seconds
[0m10:23:23.073841 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
alter table "postgres_metabase1"."analytics_analytics"."mart_orders_summary_by_region__dbt_tmp" rename to "mart_orders_summary_by_region"
[0m10:23:23.078156 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
alter table "postgres_metabase1"."analytics_analytics"."final_orders_with_returns__dbt_tmp" rename to "final_orders_with_returns"
[0m10:23:23.082880 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m10:23:23.085708 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:23:23.087903 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:23:23.089759 [debug] [Thread-3 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */
alter table "postgres_metabase1"."analytics_analytics"."monthly_returns_trend__dbt_tmp" rename to "monthly_returns_trend"
[0m10:23:23.096515 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m10:23:23.098959 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m10:23:23.101142 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m10:23:23.104713 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:23:23.107083 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m10:23:23.112035 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.product_performance"
[0m10:23:23.114412 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m10:23:23.118000 [debug] [Thread-3 (]: On model.superstore_project.monthly_returns_trend: COMMIT
[0m10:23:23.120160 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m10:23:23.122840 [debug] [Thread-1 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */
alter table "postgres_metabase1"."analytics_analytics"."product_performance__dbt_tmp" rename to "product_performance"
[0m10:23:23.125083 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m10:23:23.126998 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m10:23:23.130539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:23:23.134385 [debug] [Thread-3 (]: On model.superstore_project.monthly_returns_trend: COMMIT
[0m10:23:23.141636 [debug] [Thread-1 (]: On model.superstore_project.product_performance: COMMIT
[0m10:23:23.142554 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:23:23.143216 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:23:23.149931 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:23:23.155165 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.product_performance"
[0m10:23:23.172740 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."analytics_analytics"."mart_orders_summary_by_region__dbt_backup"
[0m10:23:23.190369 [debug] [Thread-4 (]: Applying DROP to: "postgres_metabase1"."analytics_analytics"."final_orders_with_returns__dbt_backup"
[0m10:23:23.208020 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."analytics_analytics"."monthly_returns_trend__dbt_backup"
[0m10:23:23.210880 [debug] [Thread-1 (]: On model.superstore_project.product_performance: COMMIT
[0m10:23:23.221058 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m10:23:23.224408 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m10:23:23.227823 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m10:23:23.233742 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
drop table if exists "postgres_metabase1"."analytics_analytics"."mart_orders_summary_by_region__dbt_backup" cascade
[0m10:23:23.237360 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
drop table if exists "postgres_metabase1"."analytics_analytics"."final_orders_with_returns__dbt_backup" cascade
[0m10:23:23.241394 [debug] [Thread-3 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */
drop table if exists "postgres_metabase1"."analytics_analytics"."monthly_returns_trend__dbt_backup" cascade
[0m10:23:23.244844 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:23:23.245659 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:23:23.248740 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:23:23.251281 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:23:23.256794 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."analytics_analytics"."product_performance__dbt_backup"
[0m10:23:23.261972 [debug] [Thread-2 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (execute): 10:23:22.950409 => 10:23:23.261599
[0m10:23:23.267059 [debug] [Thread-4 (]: Timing info for model.superstore_project.final_orders_with_returns (execute): 10:23:22.906084 => 10:23:23.266550
[0m10:23:23.271657 [debug] [Thread-3 (]: Timing info for model.superstore_project.monthly_returns_trend (execute): 10:23:22.958899 => 10:23:23.271326
[0m10:23:23.274837 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.product_performance"
[0m10:23:23.282438 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: Close
[0m10:23:23.293413 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: Close
[0m10:23:23.301592 [debug] [Thread-3 (]: On model.superstore_project.monthly_returns_trend: Close
[0m10:23:23.310227 [debug] [Thread-1 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */
drop table if exists "postgres_metabase1"."analytics_analytics"."product_performance__dbt_backup" cascade
[0m10:23:23.321141 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb82462b880>]}
[0m10:23:23.329233 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb824637f40>]}
[0m10:23:23.340366 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb84410d300>]}
[0m10:23:23.344604 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:23:23.349468 [info ] [Thread-2 (]: 5 of 8 OK created sql table model analytics_analytics.mart_orders_summary_by_region  [[32mSELECT 4[0m in 0.65s]
[0m10:23:23.357152 [info ] [Thread-4 (]: 4 of 8 OK created sql table model analytics_analytics.final_orders_with_returns  [[32mSELECT 8399[0m in 0.66s]
[0m10:23:23.366473 [info ] [Thread-3 (]: 6 of 8 OK created sql table model analytics_analytics.monthly_returns_trend .... [[32mSELECT 48[0m in 0.67s]
[0m10:23:23.374136 [debug] [Thread-1 (]: Timing info for model.superstore_project.product_performance (execute): 10:23:22.968224 => 10:23:23.373669
[0m10:23:23.380117 [debug] [Thread-2 (]: Finished running node model.superstore_project.mart_orders_summary_by_region
[0m10:23:23.384035 [debug] [Thread-4 (]: Finished running node model.superstore_project.final_orders_with_returns
[0m10:23:23.388965 [debug] [Thread-3 (]: Finished running node model.superstore_project.monthly_returns_trend
[0m10:23:23.397661 [debug] [Thread-1 (]: On model.superstore_project.product_performance: Close
[0m10:23:23.410280 [debug] [Thread-2 (]: Began running node model.superstore_project.top_customers
[0m10:23:23.419915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb84702c2e0>]}
[0m10:23:23.423021 [info ] [Thread-2 (]: 8 of 8 START sql table model analytics_analytics.top_customers ................. [RUN]
[0m10:23:23.429197 [info ] [Thread-1 (]: 7 of 8 OK created sql table model analytics_analytics.product_performance ...... [[32mSELECT 100[0m in 0.74s]
[0m10:23:23.432301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.mart_orders_summary_by_region, now model.superstore_project.top_customers)
[0m10:23:23.438780 [debug] [Thread-1 (]: Finished running node model.superstore_project.product_performance
[0m10:23:23.451845 [debug] [Thread-2 (]: Began compiling node model.superstore_project.top_customers
[0m10:23:23.471862 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.top_customers"
[0m10:23:23.571244 [debug] [Thread-2 (]: Timing info for model.superstore_project.top_customers (compile): 10:23:23.467305 => 10:23:23.570744
[0m10:23:23.585984 [debug] [Thread-2 (]: Began executing node model.superstore_project.top_customers
[0m10:23:23.608200 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.top_customers"
[0m10:23:23.725648 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.top_customers"
[0m10:23:23.729418 [debug] [Thread-2 (]: On model.superstore_project.top_customers: BEGIN
[0m10:23:23.740498 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:23:23.779340 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:23.786711 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.top_customers"
[0m10:23:23.795100 [debug] [Thread-2 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */

  
    

  create  table "postgres_metabase1"."analytics_analytics"."top_customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_name,
    customer_segment,
    region,
    SUM(sales) AS total_sales,
    COUNT(DISTINCT order_id) AS num_orders,
    ROUND(AVG(profit), 2) AS avg_profit
FROM "postgres_metabase1"."analytics_staging"."stg_orders"
GROUP BY 1, 2, 3
ORDER BY total_sales DESC
LIMIT 50
  );
  
[0m10:23:23.832885 [debug] [Thread-2 (]: SQL status: SELECT 50 in 0.0 seconds
[0m10:23:23.839258 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.top_customers"
[0m10:23:23.842895 [debug] [Thread-2 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */
alter table "postgres_metabase1"."analytics_analytics"."top_customers__dbt_tmp" rename to "top_customers"
[0m10:23:23.847766 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:23:23.855177 [debug] [Thread-2 (]: On model.superstore_project.top_customers: COMMIT
[0m10:23:23.860850 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.top_customers"
[0m10:23:23.866110 [debug] [Thread-2 (]: On model.superstore_project.top_customers: COMMIT
[0m10:23:23.875303 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:23:23.885700 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."analytics_analytics"."top_customers__dbt_backup"
[0m10:23:23.890961 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.top_customers"
[0m10:23:23.896667 [debug] [Thread-2 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */
drop table if exists "postgres_metabase1"."analytics_analytics"."top_customers__dbt_backup" cascade
[0m10:23:23.902281 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:23:23.909320 [debug] [Thread-2 (]: Timing info for model.superstore_project.top_customers (execute): 10:23:23.596470 => 10:23:23.908843
[0m10:23:23.913753 [debug] [Thread-2 (]: On model.superstore_project.top_customers: Close
[0m10:23:23.920122 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d158d3e-7b17-48da-b524-b2dadc7fb51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb844101360>]}
[0m10:23:23.925288 [info ] [Thread-2 (]: 8 of 8 OK created sql table model analytics_analytics.top_customers ............ [[32mSELECT 50[0m in 0.49s]
[0m10:23:23.929767 [debug] [Thread-2 (]: Finished running node model.superstore_project.top_customers
[0m10:23:23.935282 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:23.939084 [debug] [MainThread]: On master: BEGIN
[0m10:23:23.941415 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:23:23.949689 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:23:23.953009 [debug] [MainThread]: On master: COMMIT
[0m10:23:23.955607 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:23.957584 [debug] [MainThread]: On master: COMMIT
[0m10:23:23.959528 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:23:23.961202 [debug] [MainThread]: On master: Close
[0m10:23:23.964103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:23:23.965593 [debug] [MainThread]: Connection 'model.superstore_project.top_customers' was properly closed.
[0m10:23:23.966968 [debug] [MainThread]: Connection 'model.superstore_project.product_performance' was properly closed.
[0m10:23:23.968791 [debug] [MainThread]: Connection 'model.superstore_project.monthly_returns_trend' was properly closed.
[0m10:23:23.971070 [debug] [MainThread]: Connection 'model.superstore_project.final_orders_with_returns' was properly closed.
[0m10:23:23.972667 [info ] [MainThread]: 
[0m10:23:23.974490 [info ] [MainThread]: Finished running 3 view models, 5 table models in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m10:23:23.977281 [debug] [MainThread]: Command end result
[0m10:23:24.141716 [info ] [MainThread]: 
[0m10:23:24.153386 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:23:24.164893 [info ] [MainThread]: 
[0m10:23:24.175283 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m10:23:24.189504 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.705231, "process_user_time": 4.027493, "process_kernel_time": 0.440117, "process_mem_max_rss": "113152", "process_in_blocks": "81312", "process_out_blocks": "0"}
[0m10:23:24.198669 [debug] [MainThread]: Command `dbt run` succeeded at 10:23:24.197145 after 4.71 seconds
[0m10:23:24.207742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb848e14850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb824641330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb8457fe530>]}
[0m10:23:24.214297 [debug] [MainThread]: Flushing usage events
[0m10:23:33.756744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c828733c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c82855aa080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c82855aa020>]}


============================== 10:23:33.760610 | efb55fa3-003b-49b0-874f-bdcf9acdbc70 ==============================
[0m10:23:33.760610 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:23:33.761947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:23:34.071464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efb55fa3-003b-49b0-874f-bdcf9acdbc70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c82855aa170>]}
[0m10:23:34.161622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efb55fa3-003b-49b0-874f-bdcf9acdbc70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8283b57b20>]}
[0m10:23:34.163385 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m10:23:34.177275 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:23:34.643697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:23:34.645451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:23:34.652978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efb55fa3-003b-49b0-874f-bdcf9acdbc70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c828395e590>]}
[0m10:23:34.771460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efb55fa3-003b-49b0-874f-bdcf9acdbc70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8283b25060>]}
[0m10:23:34.782559 [info ] [MainThread]: Found 8 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:23:34.792954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efb55fa3-003b-49b0-874f-bdcf9acdbc70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8283b253c0>]}
[0m10:23:34.813602 [info ] [MainThread]: 
[0m10:23:34.826988 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:23:34.846664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1_analytics_staging'
[0m10:23:34.853388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1_analytics_analytics'
[0m10:23:34.921502 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_analytics_staging"
[0m10:23:34.924006 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_analytics_analytics"
[0m10:23:34.925436 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_staging: BEGIN
[0m10:23:34.928074 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_analytics: BEGIN
[0m10:23:34.930218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:34.936230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:34.949382 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:23:34.952213 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:23:34.953077 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_analytics_staging"
[0m10:23:34.955186 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1_analytics_analytics"
[0m10:23:34.957288 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1_analytics_staging"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m10:23:34.959589 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1_analytics_analytics"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m10:23:34.966242 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m10:23:34.969499 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_staging: ROLLBACK
[0m10:23:34.969893 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:23:34.971744 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_staging: Close
[0m10:23:34.974288 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_analytics: ROLLBACK
[0m10:23:34.979764 [debug] [ThreadPool]: On list_postgres_metabase1_analytics_analytics: Close
[0m10:23:34.987211 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:34.989443 [debug] [MainThread]: On master: BEGIN
[0m10:23:34.991019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:23:34.998961 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:23:35.000999 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:35.003257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:23:35.012356 [debug] [MainThread]: SQL status: SELECT 47 in 0.0 seconds
[0m10:23:35.017222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efb55fa3-003b-49b0-874f-bdcf9acdbc70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8283b07a90>]}
[0m10:23:35.019820 [debug] [MainThread]: On master: ROLLBACK
[0m10:23:35.032504 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:35.037815 [debug] [MainThread]: On master: BEGIN
[0m10:23:35.043298 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:23:35.047251 [debug] [MainThread]: On master: COMMIT
[0m10:23:35.052093 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:35.056100 [debug] [MainThread]: On master: COMMIT
[0m10:23:35.070104 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:23:35.073829 [debug] [MainThread]: On master: Close
[0m10:23:35.077888 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:23:35.081968 [info ] [MainThread]: 
[0m10:23:35.089397 [debug] [Thread-1 (]: Began running node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m10:23:35.090135 [debug] [Thread-2 (]: Began running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m10:23:35.091042 [debug] [Thread-3 (]: Began running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m10:23:35.091759 [debug] [Thread-4 (]: Began running node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m10:23:35.100956 [info ] [Thread-1 (]: 1 of 7 START test not_null_final_orders_with_returns_order_id .................. [RUN]
[0m10:23:35.113554 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_orders_order_id ................................. [RUN]
[0m10:23:35.124790 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_orders_region ................................... [RUN]
[0m10:23:35.137205 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_orders_row_id ................................... [RUN]
[0m10:23:35.143067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1_analytics_analytics, now test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028)
[0m10:23:35.145821 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1_analytics_staging, now test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m10:23:35.149183 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_project.not_null_stg_orders_region.c7b18a6907'
[0m10:23:35.155357 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_project.not_null_stg_orders_row_id.6258f0907f'
[0m10:23:35.162373 [debug] [Thread-1 (]: Began compiling node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m10:23:35.165755 [debug] [Thread-2 (]: Began compiling node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m10:23:35.169864 [debug] [Thread-3 (]: Began compiling node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m10:23:35.174850 [debug] [Thread-4 (]: Began compiling node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m10:23:35.211185 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028"
[0m10:23:35.212003 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:23:35.221274 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m10:23:35.240577 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_row_id.6258f0907f"
[0m10:23:35.279146 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_orders_row_id.6258f0907f (compile): 10:23:35.230864 => 10:23:35.278726
[0m10:23:35.279886 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (compile): 10:23:35.214614 => 10:23:35.279474
[0m10:23:35.283489 [debug] [Thread-4 (]: Began executing node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m10:23:35.289631 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028 (compile): 10:23:35.178692 => 10:23:35.288548
[0m10:23:35.293730 [debug] [Thread-3 (]: Began executing node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m10:23:35.341524 [debug] [Thread-1 (]: Began executing node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m10:23:35.341269 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_orders_row_id.6258f0907f"
[0m10:23:35.347460 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m10:23:35.350215 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (compile): 10:23:35.204644 => 10:23:35.349950
[0m10:23:35.353453 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028"
[0m10:23:35.362617 [debug] [Thread-2 (]: Began executing node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m10:23:35.372497 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:23:35.379676 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_row_id.6258f0907f"
[0m10:23:35.385626 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028"
[0m10:23:35.388049 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_orders_row_id.6258f0907f: BEGIN
[0m10:23:35.390542 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m10:23:35.399957 [debug] [Thread-1 (]: On test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028: BEGIN
[0m10:23:35.409734 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:23:35.420029 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:23:35.422425 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: BEGIN
[0m10:23:35.433061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:35.449004 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m10:23:35.456959 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:23:35.467614 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:35.475880 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:23:35.483398 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:35.485402 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_row_id.6258f0907f"
[0m10:23:35.489275 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:35.493342 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028"
[0m10:23:35.496355 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_orders_row_id.6258f0907f: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_orders_row_id.6258f0907f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select row_id
from "postgres_metabase1"."analytics_staging"."stg_orders"
where row_id is null



      
    ) dbt_internal_test
[0m10:23:35.496785 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:35.498966 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m10:23:35.501705 [debug] [Thread-1 (]: On test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres_metabase1"."analytics_analytics"."final_orders_with_returns"
where order_id is null



      
    ) dbt_internal_test
[0m10:23:35.508169 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m10:23:35.508940 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:23:35.511413 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_orders_region.c7b18a6907"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "postgres_metabase1"."analytics_staging"."stg_orders"
where region is null



      
    ) dbt_internal_test
[0m10:23:35.516859 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres_metabase1"."analytics_staging"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m10:23:35.517338 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:23:35.521224 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_orders_row_id.6258f0907f (execute): 10:23:35.300820 => 10:23:35.520936
[0m10:23:35.528579 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:23:35.532140 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:23:35.535157 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028 (execute): 10:23:35.351122 => 10:23:35.534902
[0m10:23:35.538773 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_orders_row_id.6258f0907f: ROLLBACK
[0m10:23:35.543168 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (execute): 10:23:35.345137 => 10:23:35.542947
[0m10:23:35.545810 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (execute): 10:23:35.368957 => 10:23:35.545557
[0m10:23:35.547741 [debug] [Thread-1 (]: On test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028: ROLLBACK
[0m10:23:35.550092 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_orders_row_id.6258f0907f: Close
[0m10:23:35.552035 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: ROLLBACK
[0m10:23:35.554156 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m10:23:35.556710 [debug] [Thread-1 (]: On test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028: Close
[0m10:23:35.559783 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_orders_row_id ......................................... [[32mPASS[0m in 0.40s]
[0m10:23:35.562207 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: Close
[0m10:23:35.564347 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m10:23:35.566963 [info ] [Thread-1 (]: 1 of 7 PASS not_null_final_orders_with_returns_order_id ........................ [[32mPASS[0m in 0.42s]
[0m10:23:35.569636 [debug] [Thread-4 (]: Finished running node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m10:23:35.572327 [info ] [Thread-3 (]: 3 of 7 PASS not_null_stg_orders_region ......................................... [[32mPASS[0m in 0.42s]
[0m10:23:35.574319 [info ] [Thread-2 (]: 2 of 7 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.43s]
[0m10:23:35.621679 [debug] [Thread-1 (]: Finished running node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m10:23:35.636956 [debug] [Thread-4 (]: Began running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m10:23:35.652690 [debug] [Thread-3 (]: Finished running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m10:23:35.663241 [debug] [Thread-2 (]: Finished running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m10:23:35.673557 [debug] [Thread-1 (]: Began running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m10:23:35.682734 [info ] [Thread-4 (]: 5 of 7 START test not_null_stg_returns_order_id ................................ [RUN]
[0m10:23:35.692140 [debug] [Thread-3 (]: Began running node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m10:23:35.713458 [info ] [Thread-1 (]: 6 of 7 START test not_null_stg_users_region .................................... [RUN]
[0m10:23:35.723906 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_row_id.6258f0907f, now test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e)
[0m10:23:35.730876 [info ] [Thread-3 (]: 7 of 7 START test unique_stg_orders_row_id ..................................... [RUN]
[0m10:23:35.740659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028, now test.superstore_project.not_null_stg_users_region.97049f06a2)
[0m10:23:35.748127 [debug] [Thread-4 (]: Began compiling node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m10:23:35.754073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_region.c7b18a6907, now test.superstore_project.unique_stg_orders_row_id.71d19f9f6d)
[0m10:23:35.760788 [debug] [Thread-1 (]: Began compiling node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m10:23:35.778331 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m10:23:35.781843 [debug] [Thread-3 (]: Began compiling node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m10:23:35.794419 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m10:23:35.850684 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.unique_stg_orders_row_id.71d19f9f6d"
[0m10:23:35.869828 [debug] [Thread-3 (]: Timing info for test.superstore_project.unique_stg_orders_row_id.71d19f9f6d (compile): 10:23:35.801803 => 10:23:35.869276
[0m10:23:35.872640 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (compile): 10:23:35.767733 => 10:23:35.872060
[0m10:23:35.886866 [debug] [Thread-3 (]: Began executing node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m10:23:35.901949 [debug] [Thread-4 (]: Began executing node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m10:23:35.921236 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_project.unique_stg_orders_row_id.71d19f9f6d"
[0m10:23:35.932378 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m10:23:35.944473 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (compile): 10:23:35.788095 => 10:23:35.942596
[0m10:23:35.960095 [debug] [Thread-1 (]: Began executing node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m10:23:35.979948 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m10:23:35.996321 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.unique_stg_orders_row_id.71d19f9f6d"
[0m10:23:35.999649 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m10:23:36.006945 [debug] [Thread-3 (]: On test.superstore_project.unique_stg_orders_row_id.71d19f9f6d: BEGIN
[0m10:23:36.017486 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: BEGIN
[0m10:23:36.027055 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:23:36.033349 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m10:23:36.038602 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:23:36.058716 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: BEGIN
[0m10:23:36.078995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:36.086202 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:36.099769 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.unique_stg_orders_row_id.71d19f9f6d"
[0m10:23:36.101805 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:36.108285 [debug] [Thread-3 (]: On test.superstore_project.unique_stg_orders_row_id.71d19f9f6d: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.unique_stg_orders_row_id.71d19f9f6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    row_id as unique_field,
    count(*) as n_records

from "postgres_metabase1"."analytics_staging"."stg_orders"
where row_id is not null
group by row_id
having count(*) > 1



      
    ) dbt_internal_test
[0m10:23:36.116852 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m10:23:36.120571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:23:36.128998 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres_metabase1"."analytics_staging"."stg_returns"
where order_id is null



      
    ) dbt_internal_test
[0m10:23:36.133285 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m10:23:36.138830 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:23:36.139870 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_users_region.97049f06a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "postgres_metabase1"."analytics_staging"."stg_users"
where region is null



      
    ) dbt_internal_test
[0m10:23:36.140823 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:23:36.144594 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (execute): 10:23:35.926321 => 10:23:36.144330
[0m10:23:36.148021 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:23:36.149673 [debug] [Thread-3 (]: Timing info for test.superstore_project.unique_stg_orders_row_id.71d19f9f6d (execute): 10:23:35.910955 => 10:23:36.149435
[0m10:23:36.151881 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: ROLLBACK
[0m10:23:36.155310 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (execute): 10:23:35.968733 => 10:23:36.155013
[0m10:23:36.157713 [debug] [Thread-3 (]: On test.superstore_project.unique_stg_orders_row_id.71d19f9f6d: ROLLBACK
[0m10:23:36.160271 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: Close
[0m10:23:36.162540 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: ROLLBACK
[0m10:23:36.164999 [debug] [Thread-3 (]: On test.superstore_project.unique_stg_orders_row_id.71d19f9f6d: Close
[0m10:23:36.167196 [info ] [Thread-4 (]: 5 of 7 PASS not_null_stg_returns_order_id ...................................... [[32mPASS[0m in 0.44s]
[0m10:23:36.168988 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: Close
[0m10:23:36.171092 [info ] [Thread-3 (]: 7 of 7 PASS unique_stg_orders_row_id ........................................... [[32mPASS[0m in 0.42s]
[0m10:23:36.172740 [debug] [Thread-4 (]: Finished running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m10:23:36.175115 [info ] [Thread-1 (]: 6 of 7 PASS not_null_stg_users_region .......................................... [[32mPASS[0m in 0.44s]
[0m10:23:36.176299 [debug] [Thread-3 (]: Finished running node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m10:23:36.180827 [debug] [Thread-1 (]: Finished running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m10:23:36.185849 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:36.188004 [debug] [MainThread]: On master: BEGIN
[0m10:23:36.190072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:23:36.197915 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:23:36.200156 [debug] [MainThread]: On master: COMMIT
[0m10:23:36.201982 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:36.203924 [debug] [MainThread]: On master: COMMIT
[0m10:23:36.206307 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:23:36.208217 [debug] [MainThread]: On master: Close
[0m10:23:36.211604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:23:36.213736 [debug] [MainThread]: Connection 'test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m10:23:36.215713 [debug] [MainThread]: Connection 'test.superstore_project.not_null_stg_users_region.97049f06a2' was properly closed.
[0m10:23:36.217455 [debug] [MainThread]: Connection 'test.superstore_project.unique_stg_orders_row_id.71d19f9f6d' was properly closed.
[0m10:23:36.222359 [debug] [MainThread]: Connection 'test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e' was properly closed.
[0m10:23:36.226591 [info ] [MainThread]: 
[0m10:23:36.229547 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m10:23:36.240453 [debug] [MainThread]: Command end result
[0m10:23:36.330225 [info ] [MainThread]: 
[0m10:23:36.333090 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:23:36.335613 [info ] [MainThread]: 
[0m10:23:36.338519 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m10:23:36.341548 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.6683779, "process_user_time": 2.815987, "process_kernel_time": 0.339076, "process_mem_max_rss": "104608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:23:36.344545 [debug] [MainThread]: Command `dbt test` succeeded at 10:23:36.344153 after 2.67 seconds
[0m10:23:36.347921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c828733c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c828384eda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c828386fdc0>]}
[0m10:23:36.349659 [debug] [MainThread]: Flushing usage events
[0m10:56:08.536121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf836f4850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf8196e0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf8196e080>]}


============================== 10:56:08.540958 | 3591bd27-197f-4cfc-94d6-6880c18a2b25 ==============================
[0m10:56:08.540958 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:56:08.542875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m10:56:08.785791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf8196e1d0>]}
[0m10:56:08.868884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7ff19240>]}
[0m10:56:08.873481 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m10:56:08.899763 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:56:08.952663 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:56:08.956387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7ff1b220>]}
[0m10:56:10.553051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7d2452d0>]}
[0m10:56:10.769762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7fde8850>]}
[0m10:56:10.780701 [info ] [MainThread]: Found 8 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:56:10.797154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7feb1990>]}
[0m10:56:10.808589 [info ] [MainThread]: 
[0m10:56:10.815682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:56:10.824635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m10:56:10.826970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m10:56:10.840833 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m10:56:10.844367 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m10:56:10.847605 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m10:56:10.851749 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m10:56:10.856003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:10.861079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:10.911328 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m10:56:10.912179 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m10:56:10.919599 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m10:56:10.927401 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m10:56:10.949756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now create_postgres_metabase1__analytics)
[0m10:56:10.951937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now create_postgres_metabase1__staging)
[0m10:56:10.963139 [debug] [ThreadPool]: Creating schema "database: "postgres_metabase1"
schema: "_analytics"
"
[0m10:56:10.975639 [debug] [ThreadPool]: Creating schema "database: "postgres_metabase1"
schema: "_staging"
"
[0m10:56:11.006480 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1__analytics"
[0m10:56:11.012843 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1__staging"
[0m10:56:11.019417 [debug] [ThreadPool]: On create_postgres_metabase1__analytics: BEGIN
[0m10:56:11.028107 [debug] [ThreadPool]: On create_postgres_metabase1__staging: BEGIN
[0m10:56:11.035844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:11.042749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:11.067756 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:56:11.070735 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:56:11.072416 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1__analytics"
[0m10:56:11.076354 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1__staging"
[0m10:56:11.080595 [debug] [ThreadPool]: On create_postgres_metabase1__analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "create_postgres_metabase1__analytics"} */
create schema if not exists "_analytics"
[0m10:56:11.085121 [debug] [ThreadPool]: On create_postgres_metabase1__staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "create_postgres_metabase1__staging"} */
create schema if not exists "_staging"
[0m10:56:11.093586 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m10:56:11.104243 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m10:56:11.110983 [debug] [ThreadPool]: On create_postgres_metabase1__analytics: COMMIT
[0m10:56:11.121917 [debug] [ThreadPool]: On create_postgres_metabase1__staging: COMMIT
[0m10:56:11.133736 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1__analytics"
[0m10:56:11.143285 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1__staging"
[0m10:56:11.156175 [debug] [ThreadPool]: On create_postgres_metabase1__analytics: COMMIT
[0m10:56:11.172351 [debug] [ThreadPool]: On create_postgres_metabase1__staging: COMMIT
[0m10:56:11.193526 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m10:56:11.203475 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m10:56:11.207961 [debug] [ThreadPool]: On create_postgres_metabase1__analytics: Close
[0m10:56:11.219843 [debug] [ThreadPool]: On create_postgres_metabase1__staging: Close
[0m10:56:11.255930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_metabase1__staging, now list_postgres_metabase1__analytics)
[0m10:56:11.260535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_metabase1__analytics, now list_postgres_metabase1__staging)
[0m10:56:11.289605 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__analytics"
[0m10:56:11.293790 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__staging"
[0m10:56:11.300413 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: BEGIN
[0m10:56:11.308829 [debug] [ThreadPool]: On list_postgres_metabase1__staging: BEGIN
[0m10:56:11.314986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:11.322915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:11.352092 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:56:11.357412 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__analytics"
[0m10:56:11.358502 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:56:11.361933 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1__analytics"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m10:56:11.366180 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__staging"
[0m10:56:11.374737 [debug] [ThreadPool]: On list_postgres_metabase1__staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1__staging"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m10:56:11.378984 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:56:11.386037 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: ROLLBACK
[0m10:56:11.387504 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:56:11.391403 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: Close
[0m10:56:11.395845 [debug] [ThreadPool]: On list_postgres_metabase1__staging: ROLLBACK
[0m10:56:11.403278 [debug] [ThreadPool]: On list_postgres_metabase1__staging: Close
[0m10:56:11.417421 [debug] [MainThread]: Using postgres connection "master"
[0m10:56:11.421304 [debug] [MainThread]: On master: BEGIN
[0m10:56:11.424859 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:56:11.447977 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:56:11.453520 [debug] [MainThread]: Using postgres connection "master"
[0m10:56:11.460806 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:56:11.484061 [debug] [MainThread]: SQL status: SELECT 47 in 0.0 seconds
[0m10:56:11.491070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7d2caf80>]}
[0m10:56:11.497949 [debug] [MainThread]: On master: ROLLBACK
[0m10:56:11.506980 [debug] [MainThread]: Using postgres connection "master"
[0m10:56:11.513693 [debug] [MainThread]: On master: BEGIN
[0m10:56:11.523842 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:56:11.530812 [debug] [MainThread]: On master: COMMIT
[0m10:56:11.538132 [debug] [MainThread]: Using postgres connection "master"
[0m10:56:11.545885 [debug] [MainThread]: On master: COMMIT
[0m10:56:11.555078 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:56:11.562496 [debug] [MainThread]: On master: Close
[0m10:56:11.572123 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:56:11.579406 [info ] [MainThread]: 
[0m10:56:11.592136 [debug] [Thread-1 (]: Began running node model.superstore_project.stg_orders
[0m10:56:11.592760 [debug] [Thread-2 (]: Began running node model.superstore_project.stg_returns
[0m10:56:11.593364 [debug] [Thread-3 (]: Began running node model.superstore_project.stg_users
[0m10:56:11.595244 [info ] [Thread-1 (]: 1 of 8 START sql view model _staging.stg_orders ................................ [RUN]
[0m10:56:11.597356 [info ] [Thread-2 (]: 2 of 8 START sql view model _staging.stg_returns ............................... [RUN]
[0m10:56:11.599156 [info ] [Thread-3 (]: 3 of 8 START sql view model _staging.stg_users ................................. [RUN]
[0m10:56:11.603662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1__staging, now model.superstore_project.stg_orders)
[0m10:56:11.606140 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1__analytics, now model.superstore_project.stg_returns)
[0m10:56:11.608351 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_project.stg_users'
[0m10:56:11.610435 [debug] [Thread-1 (]: Began compiling node model.superstore_project.stg_orders
[0m10:56:11.612327 [debug] [Thread-2 (]: Began compiling node model.superstore_project.stg_returns
[0m10:56:11.613720 [debug] [Thread-3 (]: Began compiling node model.superstore_project.stg_users
[0m10:56:11.621822 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.stg_orders"
[0m10:56:11.626829 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.stg_returns"
[0m10:56:11.630980 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.stg_users"
[0m10:56:11.650284 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (compile): 10:56:11.623136 => 10:56:11.649815
[0m10:56:11.650853 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (compile): 10:56:11.628544 => 10:56:11.650631
[0m10:56:11.658330 [debug] [Thread-2 (]: Began executing node model.superstore_project.stg_returns
[0m10:56:11.660176 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (compile): 10:56:11.615165 => 10:56:11.659699
[0m10:56:11.661804 [debug] [Thread-3 (]: Began executing node model.superstore_project.stg_users
[0m10:56:11.687154 [debug] [Thread-1 (]: Began executing node model.superstore_project.stg_orders
[0m10:56:11.701822 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.stg_returns"
[0m10:56:11.706429 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.stg_users"
[0m10:56:11.711290 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.stg_orders"
[0m10:56:11.791528 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m10:56:11.795403 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m10:56:11.802770 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: BEGIN
[0m10:56:11.815518 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: BEGIN
[0m10:56:11.817596 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m10:56:11.828992 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:56:11.838581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:11.846328 [debug] [Thread-3 (]: On model.superstore_project.stg_users: BEGIN
[0m10:56:11.870926 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:56:11.874643 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:56:11.878501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:56:11.880579 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m10:56:11.883288 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:56:11.883816 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m10:56:11.886902 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */

  create view "postgres_metabase1"."_staging"."stg_returns__dbt_tmp"
    
    
  as (
    WITH raw_returns AS (
    SELECT
        order_id,
        status
    FROM "postgres_metabase1"."raw"."returns"
)
SELECT *
FROM raw_returns
  );
[0m10:56:11.890888 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m10:56:11.894763 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */

  create view "postgres_metabase1"."_staging"."stg_orders__dbt_tmp"
    
    
  as (
    WITH raw_orders AS (
    SELECT
        row_id,
        order_id,
        order_date,
        ship_date,
        ship_mode,
        order_priority,
        product_container,
        customer_name,
        customer_segment,
        zip_code,
        state,
        city,
        region,
        product_category,
        product_subcategory,
        product_name,
        unit_price,
        quantity AS order_quantity,
        sales,
        profit,
        discount,
        shipping_cost,
        product_base_margin
    FROM "postgres_metabase1"."raw"."orders"
)
SELECT *
FROM raw_orders
  );
[0m10:56:11.899548 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */

  create view "postgres_metabase1"."_staging"."stg_users__dbt_tmp"
    
    
  as (
    WITH raw_users AS (
    SELECT
        region,
        manager
    FROM "postgres_metabase1"."raw"."managers"
)
SELECT *
FROM raw_users
  );
[0m10:56:11.902248 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:56:11.906648 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:56:11.911161 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:56:11.918874 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m10:56:11.924411 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m10:56:11.928849 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m10:56:11.931742 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
alter table "postgres_metabase1"."_staging"."stg_returns__dbt_tmp" rename to "stg_returns"
[0m10:56:11.934504 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
alter table "postgres_metabase1"."_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m10:56:11.937308 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
alter table "postgres_metabase1"."_staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m10:56:11.940992 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:56:11.943908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:56:11.946357 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:56:11.963994 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m10:56:11.965997 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m10:56:11.968530 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m10:56:11.970457 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m10:56:11.977842 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m10:56:11.990006 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m10:56:12.000090 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m10:56:12.009768 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m10:56:12.023325 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m10:56:12.040013 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:56:12.047041 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:56:12.052607 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:56:12.072462 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."_staging"."stg_returns__dbt_backup"
[0m10:56:12.084282 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."_staging"."stg_orders__dbt_backup"
[0m10:56:12.101181 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."_staging"."stg_users__dbt_backup"
[0m10:56:12.124702 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m10:56:12.130187 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m10:56:12.139837 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m10:56:12.150445 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
drop view if exists "postgres_metabase1"."_staging"."stg_returns__dbt_backup" cascade
[0m10:56:12.161663 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
drop view if exists "postgres_metabase1"."_staging"."stg_orders__dbt_backup" cascade
[0m10:56:12.172364 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
drop view if exists "postgres_metabase1"."_staging"."stg_users__dbt_backup" cascade
[0m10:56:12.187545 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:56:12.190720 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:56:12.199192 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:56:12.213412 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (execute): 10:56:11.664482 => 10:56:12.212508
[0m10:56:12.230231 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (execute): 10:56:11.708259 => 10:56:12.229272
[0m10:56:12.245433 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (execute): 10:56:11.702954 => 10:56:12.244330
[0m10:56:12.254513 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: Close
[0m10:56:12.268530 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: Close
[0m10:56:12.280241 [debug] [Thread-3 (]: On model.superstore_project.stg_users: Close
[0m10:56:12.300610 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7d1576d0>]}
[0m10:56:12.310968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7d16b730>]}
[0m10:56:12.322975 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7d19c970>]}
[0m10:56:12.331023 [info ] [Thread-2 (]: 2 of 8 OK created sql view model _staging.stg_returns .......................... [[32mCREATE VIEW[0m in 0.69s]
[0m10:56:12.340005 [info ] [Thread-1 (]: 1 of 8 OK created sql view model _staging.stg_orders ........................... [[32mCREATE VIEW[0m in 0.71s]
[0m10:56:12.342783 [info ] [Thread-3 (]: 3 of 8 OK created sql view model _staging.stg_users ............................ [[32mCREATE VIEW[0m in 0.71s]
[0m10:56:12.345983 [debug] [Thread-2 (]: Finished running node model.superstore_project.stg_returns
[0m10:56:12.348401 [debug] [Thread-1 (]: Finished running node model.superstore_project.stg_orders
[0m10:56:12.351113 [debug] [Thread-3 (]: Finished running node model.superstore_project.stg_users
[0m10:56:12.356278 [debug] [Thread-4 (]: Began running node model.superstore_project.monthly_returns_trend
[0m10:56:12.356744 [debug] [Thread-2 (]: Began running node model.superstore_project.product_performance
[0m10:56:12.357225 [debug] [Thread-1 (]: Began running node model.superstore_project.top_customers
[0m10:56:12.365181 [debug] [Thread-3 (]: Began running node model.superstore_project.final_orders_with_returns
[0m10:56:12.373125 [info ] [Thread-4 (]: 4 of 8 START sql table model _analytics.monthly_returns_trend .................. [RUN]
[0m10:56:12.376640 [info ] [Thread-2 (]: 5 of 8 START sql table model _analytics.product_performance .................... [RUN]
[0m10:56:12.380410 [info ] [Thread-1 (]: 6 of 8 START sql table model _analytics.top_customers .......................... [RUN]
[0m10:56:12.384056 [info ] [Thread-3 (]: 7 of 8 START sql table model _analytics.final_orders_with_returns .............. [RUN]
[0m10:56:12.386928 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_project.monthly_returns_trend'
[0m10:56:12.389529 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_returns, now model.superstore_project.product_performance)
[0m10:56:12.392218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_orders, now model.superstore_project.top_customers)
[0m10:56:12.395174 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_users, now model.superstore_project.final_orders_with_returns)
[0m10:56:12.397463 [debug] [Thread-4 (]: Began compiling node model.superstore_project.monthly_returns_trend
[0m10:56:12.401781 [debug] [Thread-2 (]: Began compiling node model.superstore_project.product_performance
[0m10:56:12.404501 [debug] [Thread-1 (]: Began compiling node model.superstore_project.top_customers
[0m10:56:12.406898 [debug] [Thread-3 (]: Began compiling node model.superstore_project.final_orders_with_returns
[0m10:56:12.412435 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.monthly_returns_trend"
[0m10:56:12.418811 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.product_performance"
[0m10:56:12.464828 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.top_customers"
[0m10:56:12.469648 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.final_orders_with_returns"
[0m10:56:12.499831 [debug] [Thread-4 (]: Timing info for model.superstore_project.monthly_returns_trend (compile): 10:56:12.408953 => 10:56:12.499130
[0m10:56:12.501848 [debug] [Thread-2 (]: Timing info for model.superstore_project.product_performance (compile): 10:56:12.414598 => 10:56:12.501135
[0m10:56:12.507471 [debug] [Thread-1 (]: Timing info for model.superstore_project.top_customers (compile): 10:56:12.421244 => 10:56:12.506673
[0m10:56:12.509854 [debug] [Thread-4 (]: Began executing node model.superstore_project.monthly_returns_trend
[0m10:56:12.522184 [debug] [Thread-2 (]: Began executing node model.superstore_project.product_performance
[0m10:56:12.527442 [debug] [Thread-3 (]: Timing info for model.superstore_project.final_orders_with_returns (compile): 10:56:12.466819 => 10:56:12.525443
[0m10:56:12.532007 [debug] [Thread-1 (]: Began executing node model.superstore_project.top_customers
[0m10:56:12.598532 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_project.monthly_returns_trend"
[0m10:56:12.605124 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.product_performance"
[0m10:56:12.605976 [debug] [Thread-3 (]: Began executing node model.superstore_project.final_orders_with_returns
[0m10:56:12.620420 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.top_customers"
[0m10:56:12.647464 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.final_orders_with_returns"
[0m10:56:12.666282 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.product_performance"
[0m10:56:12.686681 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m10:56:12.693070 [debug] [Thread-2 (]: On model.superstore_project.product_performance: BEGIN
[0m10:56:12.696194 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.top_customers"
[0m10:56:12.707705 [debug] [Thread-4 (]: On model.superstore_project.monthly_returns_trend: BEGIN
[0m10:56:12.719184 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:56:12.723912 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m10:56:12.728853 [debug] [Thread-1 (]: On model.superstore_project.top_customers: BEGIN
[0m10:56:12.738989 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:56:12.756541 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: BEGIN
[0m10:56:12.767750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:56:12.780440 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:56:12.787711 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:56:12.802634 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.product_performance"
[0m10:56:12.804768 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:56:12.815199 [debug] [Thread-2 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */

  
    

  create  table "postgres_metabase1"."_analytics"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_name,
    product_category,
    product_subcategory,
    SUM(order_quantity) AS total_quantity_sold,
    SUM(sales) AS total_sales,
    SUM(profit) AS total_profit,
    ROUND(AVG(product_base_margin), 4) AS avg_margin,
    COUNT(DISTINCT order_id) AS num_orders
FROM "postgres_metabase1"."_staging"."stg_orders"
GROUP BY 1, 2, 3
ORDER BY total_sales DESC
LIMIT 100
  );
  
[0m10:56:12.818113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:56:12.821143 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m10:56:12.824408 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:56:12.829823 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.top_customers"
[0m10:56:12.834572 [debug] [Thread-4 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */

  
    

  create  table "postgres_metabase1"."_analytics"."monthly_returns_trend__dbt_tmp"
  
  
    as
  
  (
    WITH orders_with_returns AS (
    SELECT
        o.order_id,
        o.order_date,
        r.status
    FROM "postgres_metabase1"."_staging"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."_staging"."stg_returns" r
        ON o.order_id = r.order_id
),
returns_by_month AS (
    SELECT
        DATE_TRUNC('month', order_date) AS month,
        COUNT(*) FILTER (WHERE status = 'Returned') AS returned_orders,
        COUNT(*) AS total_orders,
        ROUND(
            COUNT(*) FILTER (WHERE status = 'Returned')::decimal
            / NULLIF(COUNT(*), 0),
            2
        ) AS return_rate
    FROM orders_with_returns
    GROUP BY 1
)
SELECT *
FROM returns_by_month
ORDER BY month
  );
  
[0m10:56:12.837532 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m10:56:12.841320 [debug] [Thread-1 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */

  
    

  create  table "postgres_metabase1"."_analytics"."top_customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_name,
    customer_segment,
    region,
    SUM(sales) AS total_sales,
    COUNT(DISTINCT order_id) AS num_orders,
    ROUND(AVG(profit), 2) AS avg_profit
FROM "postgres_metabase1"."_staging"."stg_orders"
GROUP BY 1, 2, 3
ORDER BY total_sales DESC
LIMIT 50
  );
  
[0m10:56:12.847243 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */

  
    

  create  table "postgres_metabase1"."_analytics"."final_orders_with_returns__dbt_tmp"
  
  
    as
  
  (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."_staging"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."_staging"."stg_returns" r
    ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."_staging"."stg_users" u
    ON o.region = u.region
)
SELECT *
FROM orders_with_returns
  );
  
[0m10:56:12.859058 [debug] [Thread-4 (]: SQL status: SELECT 48 in 0.0 seconds
[0m10:56:12.869384 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m10:56:12.870352 [debug] [Thread-2 (]: SQL status: SELECT 100 in 0.0 seconds
[0m10:56:12.872321 [debug] [Thread-4 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */
alter table "postgres_metabase1"."_analytics"."monthly_returns_trend__dbt_tmp" rename to "monthly_returns_trend"
[0m10:56:12.879498 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.product_performance"
[0m10:56:12.882098 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:56:12.882523 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.0 seconds
[0m10:56:12.884187 [debug] [Thread-2 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */
alter table "postgres_metabase1"."_analytics"."product_performance__dbt_tmp" rename to "product_performance"
[0m10:56:12.890261 [debug] [Thread-4 (]: On model.superstore_project.monthly_returns_trend: COMMIT
[0m10:56:12.891808 [debug] [Thread-3 (]: SQL status: SELECT 8399 in 0.0 seconds
[0m10:56:12.894375 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.top_customers"
[0m10:56:12.896873 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:56:12.898275 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m10:56:12.902542 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m10:56:12.904472 [debug] [Thread-1 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */
alter table "postgres_metabase1"."_analytics"."top_customers__dbt_tmp" rename to "top_customers"
[0m10:56:12.907671 [debug] [Thread-2 (]: On model.superstore_project.product_performance: COMMIT
[0m10:56:12.909851 [debug] [Thread-4 (]: On model.superstore_project.monthly_returns_trend: COMMIT
[0m10:56:12.911955 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
alter table "postgres_metabase1"."_analytics"."final_orders_with_returns__dbt_tmp" rename to "final_orders_with_returns"
[0m10:56:12.914343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:56:12.915605 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.product_performance"
[0m10:56:12.920400 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:56:12.923663 [debug] [Thread-1 (]: On model.superstore_project.top_customers: COMMIT
[0m10:56:12.924045 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:56:12.925640 [debug] [Thread-2 (]: On model.superstore_project.product_performance: COMMIT
[0m10:56:12.929704 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m10:56:12.931615 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.top_customers"
[0m10:56:12.936035 [debug] [Thread-4 (]: Applying DROP to: "postgres_metabase1"."_analytics"."monthly_returns_trend__dbt_backup"
[0m10:56:12.939592 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:56:12.939931 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m10:56:12.942165 [debug] [Thread-1 (]: On model.superstore_project.top_customers: COMMIT
[0m10:56:12.949327 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m10:56:12.956137 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."_analytics"."product_performance__dbt_backup"
[0m10:56:12.958649 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m10:56:12.962232 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:56:12.963373 [debug] [Thread-4 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */
drop table if exists "postgres_metabase1"."_analytics"."monthly_returns_trend__dbt_backup" cascade
[0m10:56:12.966014 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.product_performance"
[0m10:56:12.969673 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:56:12.973612 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."_analytics"."top_customers__dbt_backup"
[0m10:56:12.977093 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:56:12.979175 [debug] [Thread-2 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */
drop table if exists "postgres_metabase1"."_analytics"."product_performance__dbt_backup" cascade
[0m10:56:12.991211 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."_analytics"."final_orders_with_returns__dbt_backup"
[0m10:56:12.999437 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.top_customers"
[0m10:56:13.013230 [debug] [Thread-4 (]: Timing info for model.superstore_project.monthly_returns_trend (execute): 10:56:12.538684 => 10:56:13.012609
[0m10:56:13.022877 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:56:13.040659 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m10:56:13.049668 [debug] [Thread-1 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */
drop table if exists "postgres_metabase1"."_analytics"."top_customers__dbt_backup" cascade
[0m10:56:13.061526 [debug] [Thread-4 (]: On model.superstore_project.monthly_returns_trend: Close
[0m10:56:13.082488 [debug] [Thread-2 (]: Timing info for model.superstore_project.product_performance (execute): 10:56:12.565668 => 10:56:13.081167
[0m10:56:13.088933 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
drop table if exists "postgres_metabase1"."_analytics"."final_orders_with_returns__dbt_backup" cascade
[0m10:56:13.099267 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:56:13.108180 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7d14c2e0>]}
[0m10:56:13.114866 [debug] [Thread-2 (]: On model.superstore_project.product_performance: Close
[0m10:56:13.129655 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:56:13.143616 [debug] [Thread-1 (]: Timing info for model.superstore_project.top_customers (execute): 10:56:12.611881 => 10:56:13.141603
[0m10:56:13.155409 [info ] [Thread-4 (]: 4 of 8 OK created sql table model _analytics.monthly_returns_trend ............. [[32mSELECT 48[0m in 0.72s]
[0m10:56:13.166936 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7d111ae0>]}
[0m10:56:13.176262 [debug] [Thread-3 (]: Timing info for model.superstore_project.final_orders_with_returns (execute): 10:56:12.637112 => 10:56:13.175762
[0m10:56:13.184632 [debug] [Thread-1 (]: On model.superstore_project.top_customers: Close
[0m10:56:13.190056 [debug] [Thread-4 (]: Finished running node model.superstore_project.monthly_returns_trend
[0m10:56:13.194899 [info ] [Thread-2 (]: 5 of 8 OK created sql table model _analytics.product_performance ............... [[32mSELECT 100[0m in 0.78s]
[0m10:56:13.205844 [debug] [Thread-3 (]: On model.superstore_project.final_orders_with_returns: Close
[0m10:56:13.213320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7feae1a0>]}
[0m10:56:13.215610 [debug] [Thread-4 (]: Began running node model.superstore_project.mart_orders_summary_by_region
[0m10:56:13.218904 [debug] [Thread-2 (]: Finished running node model.superstore_project.product_performance
[0m10:56:13.221943 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7d25b400>]}
[0m10:56:13.224162 [info ] [Thread-1 (]: 6 of 8 OK created sql table model _analytics.top_customers ..................... [[32mSELECT 50[0m in 0.82s]
[0m10:56:13.226952 [info ] [Thread-4 (]: 8 of 8 START sql table model _analytics.mart_orders_summary_by_region .......... [RUN]
[0m10:56:13.231919 [info ] [Thread-3 (]: 7 of 8 OK created sql table model _analytics.final_orders_with_returns ......... [[32mSELECT 8399[0m in 0.83s]
[0m10:56:13.234731 [debug] [Thread-1 (]: Finished running node model.superstore_project.top_customers
[0m10:56:13.237604 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_project.monthly_returns_trend, now model.superstore_project.mart_orders_summary_by_region)
[0m10:56:13.240293 [debug] [Thread-3 (]: Finished running node model.superstore_project.final_orders_with_returns
[0m10:56:13.244460 [debug] [Thread-4 (]: Began compiling node model.superstore_project.mart_orders_summary_by_region
[0m10:56:13.252921 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.mart_orders_summary_by_region"
[0m10:56:13.277704 [debug] [Thread-4 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (compile): 10:56:13.249449 => 10:56:13.277373
[0m10:56:13.280351 [debug] [Thread-4 (]: Began executing node model.superstore_project.mart_orders_summary_by_region
[0m10:56:13.291708 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_project.mart_orders_summary_by_region"
[0m10:56:13.316439 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m10:56:13.318546 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: BEGIN
[0m10:56:13.344094 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:56:13.386796 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:56:13.394204 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m10:56:13.402170 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */

  
    

  create  table "postgres_metabase1"."_analytics"."mart_orders_summary_by_region__dbt_tmp"
  
  
    as
  
  (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."_staging"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."_staging"."stg_returns" r ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."_staging"."stg_users" u ON o.region = u.region
),

region_summary AS (
    SELECT
        region,
        region_manager,
        COUNT(DISTINCT order_id) AS total_orders,
        COUNT(DISTINCT CASE WHEN return_status = 'Returned' THEN order_id END) AS returned_orders,
        ROUND(100.0 * COUNT(DISTINCT CASE WHEN return_status = 'Returned' THEN order_id END) / NULLIF(COUNT(DISTINCT order_id), 0), 2) AS return_rate_percent,
        SUM(sales) AS total_sales,
        SUM(profit) AS total_profit,
        ROUND(AVG(discount), 4) AS avg_discount
    FROM orders_with_returns
    GROUP BY region, region_manager
)

SELECT *
FROM region_summary
ORDER BY return_rate_percent DESC
  );
  
[0m10:56:13.440704 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.0 seconds
[0m10:56:13.445788 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m10:56:13.449101 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
alter table "postgres_metabase1"."_analytics"."mart_orders_summary_by_region__dbt_tmp" rename to "mart_orders_summary_by_region"
[0m10:56:13.453052 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:56:13.458189 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m10:56:13.461352 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m10:56:13.464489 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m10:56:13.471802 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:56:13.483186 [debug] [Thread-4 (]: Applying DROP to: "postgres_metabase1"."_analytics"."mart_orders_summary_by_region__dbt_backup"
[0m10:56:13.492494 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m10:56:13.498586 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
drop table if exists "postgres_metabase1"."_analytics"."mart_orders_summary_by_region__dbt_backup" cascade
[0m10:56:13.505290 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:56:13.514088 [debug] [Thread-4 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (execute): 10:56:13.283029 => 10:56:13.513475
[0m10:56:13.518409 [debug] [Thread-4 (]: On model.superstore_project.mart_orders_summary_by_region: Close
[0m10:56:13.523056 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3591bd27-197f-4cfc-94d6-6880c18a2b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7d22e620>]}
[0m10:56:13.526799 [info ] [Thread-4 (]: 8 of 8 OK created sql table model _analytics.mart_orders_summary_by_region ..... [[32mSELECT 4[0m in 0.29s]
[0m10:56:13.531653 [debug] [Thread-4 (]: Finished running node model.superstore_project.mart_orders_summary_by_region
[0m10:56:13.537204 [debug] [MainThread]: Using postgres connection "master"
[0m10:56:13.540481 [debug] [MainThread]: On master: BEGIN
[0m10:56:13.542866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:56:13.550245 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:56:13.553750 [debug] [MainThread]: On master: COMMIT
[0m10:56:13.555385 [debug] [MainThread]: Using postgres connection "master"
[0m10:56:13.556493 [debug] [MainThread]: On master: COMMIT
[0m10:56:13.558322 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:56:13.559472 [debug] [MainThread]: On master: Close
[0m10:56:13.560946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:13.562278 [debug] [MainThread]: Connection 'model.superstore_project.product_performance' was properly closed.
[0m10:56:13.563067 [debug] [MainThread]: Connection 'model.superstore_project.top_customers' was properly closed.
[0m10:56:13.564136 [debug] [MainThread]: Connection 'model.superstore_project.final_orders_with_returns' was properly closed.
[0m10:56:13.565146 [debug] [MainThread]: Connection 'model.superstore_project.mart_orders_summary_by_region' was properly closed.
[0m10:56:13.566249 [info ] [MainThread]: 
[0m10:56:13.567626 [info ] [MainThread]: Finished running 3 view models, 5 table models in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m10:56:13.569999 [debug] [MainThread]: Command end result
[0m10:56:13.677830 [info ] [MainThread]: 
[0m10:56:13.685199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:56:13.693621 [info ] [MainThread]: 
[0m10:56:13.702666 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m10:56:13.721499 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.239546, "process_user_time": 4.157514, "process_kernel_time": 0.427254, "process_mem_max_rss": "112888", "process_in_blocks": "81056", "process_out_blocks": "0"}
[0m10:56:13.727032 [debug] [MainThread]: Command `dbt run` succeeded at 10:56:13.726836 after 5.25 seconds
[0m10:56:13.731254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf836f4850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7d16b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bf7fde8850>]}
[0m10:56:13.738554 [debug] [MainThread]: Flushing usage events
[0m11:00:35.635550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b16f0ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b15186110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b151860b0>]}


============================== 11:00:35.640067 | dcc677dc-6215-410e-a9f2-d2ba4442c223 ==============================
[0m11:00:35.640067 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:00:35.641856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/profiles', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:00:35.926873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcc677dc-6215-410e-a9f2-d2ba4442c223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b15186200>]}
[0m11:00:36.023804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcc677dc-6215-410e-a9f2-d2ba4442c223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b13733910>]}
[0m11:00:36.029006 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m11:00:36.052855 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:00:36.289191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:00:36.291124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:00:36.300810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcc677dc-6215-410e-a9f2-d2ba4442c223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b1352e620>]}
[0m11:00:36.457567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcc677dc-6215-410e-a9f2-d2ba4442c223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b136f50f0>]}
[0m11:00:36.467220 [info ] [MainThread]: Found 8 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:00:36.479954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcc677dc-6215-410e-a9f2-d2ba4442c223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b136f5450>]}
[0m11:00:36.497041 [info ] [MainThread]: 
[0m11:00:36.507542 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:00:36.518185 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m11:00:36.522104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m11:00:36.548730 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m11:00:36.551565 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m11:00:36.555785 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m11:00:36.560130 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m11:00:36.563597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:36.567292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:36.606377 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:00:36.607004 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:00:36.610680 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m11:00:36.614323 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m11:00:36.620652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now create_postgres_metabase1__staging)
[0m11:00:36.621294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now create_postgres_metabase1__analytics)
[0m11:00:36.624053 [debug] [ThreadPool]: Creating schema "database: "postgres_metabase1"
schema: "_staging"
"
[0m11:00:36.627776 [debug] [ThreadPool]: Creating schema "database: "postgres_metabase1"
schema: "_analytics"
"
[0m11:00:36.642682 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1__staging"
[0m11:00:36.646889 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1__analytics"
[0m11:00:36.649800 [debug] [ThreadPool]: On create_postgres_metabase1__staging: BEGIN
[0m11:00:36.652496 [debug] [ThreadPool]: On create_postgres_metabase1__analytics: BEGIN
[0m11:00:36.657142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:36.661225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:36.674631 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:00:36.678327 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:00:36.680946 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1__staging"
[0m11:00:36.687730 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1__analytics"
[0m11:00:36.692032 [debug] [ThreadPool]: On create_postgres_metabase1__staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "create_postgres_metabase1__staging"} */
create schema if not exists "_staging"
[0m11:00:36.696749 [debug] [ThreadPool]: On create_postgres_metabase1__analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "create_postgres_metabase1__analytics"} */
create schema if not exists "_analytics"
[0m11:00:36.704061 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m11:00:36.710576 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m11:00:36.725977 [debug] [ThreadPool]: On create_postgres_metabase1__staging: COMMIT
[0m11:00:36.740135 [debug] [ThreadPool]: On create_postgres_metabase1__analytics: COMMIT
[0m11:00:36.754587 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1__staging"
[0m11:00:36.765861 [debug] [ThreadPool]: Using postgres connection "create_postgres_metabase1__analytics"
[0m11:00:36.773004 [debug] [ThreadPool]: On create_postgres_metabase1__staging: COMMIT
[0m11:00:36.783811 [debug] [ThreadPool]: On create_postgres_metabase1__analytics: COMMIT
[0m11:00:36.795870 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m11:00:36.803239 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m11:00:36.806466 [debug] [ThreadPool]: On create_postgres_metabase1__staging: Close
[0m11:00:36.812604 [debug] [ThreadPool]: On create_postgres_metabase1__analytics: Close
[0m11:00:36.837070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_metabase1__analytics, now list_postgres_metabase1__staging)
[0m11:00:36.838416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_metabase1__staging, now list_postgres_metabase1__analytics)
[0m11:00:36.852539 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__staging"
[0m11:00:36.857809 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__analytics"
[0m11:00:36.860897 [debug] [ThreadPool]: On list_postgres_metabase1__staging: BEGIN
[0m11:00:36.863225 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: BEGIN
[0m11:00:36.865964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:36.869176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:36.882971 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:00:36.883849 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:00:36.885483 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__staging"
[0m11:00:36.888461 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__analytics"
[0m11:00:36.892103 [debug] [ThreadPool]: On list_postgres_metabase1__staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1__staging"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m11:00:36.895470 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1__analytics"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m11:00:36.907261 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:00:36.909034 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:00:36.913955 [debug] [ThreadPool]: On list_postgres_metabase1__staging: ROLLBACK
[0m11:00:36.920559 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: ROLLBACK
[0m11:00:36.923901 [debug] [ThreadPool]: On list_postgres_metabase1__staging: Close
[0m11:00:36.927546 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: Close
[0m11:00:36.964761 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:36.970987 [debug] [MainThread]: On master: BEGIN
[0m11:00:36.977398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:00:37.014085 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:37.020732 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:37.027407 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:00:37.049346 [debug] [MainThread]: SQL status: SELECT 44 in 0.0 seconds
[0m11:00:37.056395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcc677dc-6215-410e-a9f2-d2ba4442c223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b13593d60>]}
[0m11:00:37.062893 [debug] [MainThread]: On master: ROLLBACK
[0m11:00:37.070274 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:37.080805 [debug] [MainThread]: On master: BEGIN
[0m11:00:37.087149 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:37.093463 [debug] [MainThread]: On master: COMMIT
[0m11:00:37.101338 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:37.108113 [debug] [MainThread]: On master: COMMIT
[0m11:00:37.123802 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:00:37.133511 [debug] [MainThread]: On master: Close
[0m11:00:37.143455 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:00:37.153352 [info ] [MainThread]: 
[0m11:00:37.166722 [debug] [Thread-1 (]: Began running node model.superstore_project.stg_orders
[0m11:00:37.167390 [debug] [Thread-2 (]: Began running node model.superstore_project.stg_returns
[0m11:00:37.167855 [debug] [Thread-3 (]: Began running node model.superstore_project.stg_users
[0m11:00:37.170815 [info ] [Thread-1 (]: 1 of 8 START sql view model _staging.stg_orders ................................ [RUN]
[0m11:00:37.173361 [info ] [Thread-2 (]: 2 of 8 START sql view model _staging.stg_returns ............................... [RUN]
[0m11:00:37.179010 [info ] [Thread-3 (]: 3 of 8 START sql view model _staging.stg_users ................................. [RUN]
[0m11:00:37.183285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1__analytics, now model.superstore_project.stg_orders)
[0m11:00:37.186691 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1__staging, now model.superstore_project.stg_returns)
[0m11:00:37.190888 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_project.stg_users'
[0m11:00:37.193941 [debug] [Thread-1 (]: Began compiling node model.superstore_project.stg_orders
[0m11:00:37.196912 [debug] [Thread-2 (]: Began compiling node model.superstore_project.stg_returns
[0m11:00:37.199931 [debug] [Thread-3 (]: Began compiling node model.superstore_project.stg_users
[0m11:00:37.210265 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.stg_orders"
[0m11:00:37.214737 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.stg_returns"
[0m11:00:37.219568 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.stg_users"
[0m11:00:37.242678 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (compile): 11:00:37.202945 => 11:00:37.241933
[0m11:00:37.248613 [debug] [Thread-1 (]: Began executing node model.superstore_project.stg_orders
[0m11:00:37.250105 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (compile): 11:00:37.212086 => 11:00:37.249453
[0m11:00:37.259445 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (compile): 11:00:37.217297 => 11:00:37.258736
[0m11:00:37.278661 [debug] [Thread-2 (]: Began executing node model.superstore_project.stg_returns
[0m11:00:37.294544 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.stg_orders"
[0m11:00:37.296242 [debug] [Thread-3 (]: Began executing node model.superstore_project.stg_users
[0m11:00:37.302119 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.stg_returns"
[0m11:00:37.310197 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.stg_users"
[0m11:00:37.318161 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m11:00:37.319061 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m11:00:37.319684 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: BEGIN
[0m11:00:37.320664 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m11:00:37.323842 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: BEGIN
[0m11:00:37.330717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:37.335456 [debug] [Thread-3 (]: On model.superstore_project.stg_users: BEGIN
[0m11:00:37.337196 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:37.340458 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:00:37.347311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:37.348912 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m11:00:37.349789 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:37.350816 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:37.351316 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */

  create view "postgres_metabase1"."_staging"."stg_orders__dbt_tmp"
    
    
  as (
    WITH raw_orders AS (
    SELECT
        row_id,
        order_id,
        order_date,
        ship_date,
        ship_mode,
        order_priority,
        product_container,
        customer_name,
        customer_segment,
        zip_code,
        state,
        city,
        region,
        product_category,
        product_subcategory,
        product_name,
        unit_price,
        quantity AS order_quantity,
        sales,
        profit,
        discount,
        shipping_cost,
        product_base_margin
    FROM "postgres_metabase1"."raw"."orders"
)
SELECT *
FROM raw_orders
  );
[0m11:00:37.352783 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m11:00:37.354215 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m11:00:37.356402 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */

  create view "postgres_metabase1"."_staging"."stg_returns__dbt_tmp"
    
    
  as (
    WITH raw_returns AS (
    SELECT
        order_id,
        status
    FROM "postgres_metabase1"."raw"."returns"
)
SELECT *
FROM raw_returns
  );
[0m11:00:37.357931 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */

  create view "postgres_metabase1"."_staging"."stg_users__dbt_tmp"
    
    
  as (
    WITH raw_users AS (
    SELECT
        region,
        manager
    FROM "postgres_metabase1"."raw"."managers"
)
SELECT *
FROM raw_users
  );
[0m11:00:37.360986 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:00:37.361481 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:00:37.361962 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:00:37.412029 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m11:00:37.416591 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m11:00:37.437556 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m11:00:37.440807 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
alter table "postgres_metabase1"."_staging"."stg_returns__dbt_tmp" rename to "stg_returns"
[0m11:00:37.444074 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
alter table "postgres_metabase1"."_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:00:37.448794 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
alter table "postgres_metabase1"."_staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m11:00:37.453859 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:00:37.457128 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:00:37.460752 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:00:37.484058 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m11:00:37.485469 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m11:00:37.487885 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m11:00:37.489479 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m11:00:37.491297 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m11:00:37.492943 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m11:00:37.495434 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m11:00:37.496894 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m11:00:37.498307 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m11:00:37.503175 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:37.503943 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:37.504689 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:37.513980 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."_staging"."stg_returns__dbt_backup"
[0m11:00:37.517026 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."_staging"."stg_users__dbt_backup"
[0m11:00:37.521294 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."_staging"."stg_orders__dbt_backup"
[0m11:00:37.530958 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m11:00:37.533238 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m11:00:37.535449 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m11:00:37.537002 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
drop view if exists "postgres_metabase1"."_staging"."stg_returns__dbt_backup" cascade
[0m11:00:37.538617 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
drop view if exists "postgres_metabase1"."_staging"."stg_users__dbt_backup" cascade
[0m11:00:37.540030 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
drop view if exists "postgres_metabase1"."_staging"."stg_orders__dbt_backup" cascade
[0m11:00:37.543416 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:00:37.544034 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:00:37.545282 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:00:37.547804 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (execute): 11:00:37.306235 => 11:00:37.547506
[0m11:00:37.550846 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (execute): 11:00:37.299077 => 11:00:37.550528
[0m11:00:37.556786 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (execute): 11:00:37.253517 => 11:00:37.556379
[0m11:00:37.564952 [debug] [Thread-3 (]: On model.superstore_project.stg_users: Close
[0m11:00:37.568538 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: Close
[0m11:00:37.576975 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: Close
[0m11:00:37.586085 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcc677dc-6215-410e-a9f2-d2ba4442c223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b1358c370>]}
[0m11:00:37.595523 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcc677dc-6215-410e-a9f2-d2ba4442c223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b1041a470>]}
[0m11:00:37.602407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcc677dc-6215-410e-a9f2-d2ba4442c223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b135f4040>]}
[0m11:00:37.608452 [info ] [Thread-3 (]: 3 of 8 OK created sql view model _staging.stg_users ............................ [[32mCREATE VIEW[0m in 0.40s]
[0m11:00:37.615833 [info ] [Thread-2 (]: 2 of 8 OK created sql view model _staging.stg_returns .......................... [[32mCREATE VIEW[0m in 0.41s]
[0m11:00:37.625665 [info ] [Thread-1 (]: 1 of 8 OK created sql view model _staging.stg_orders ........................... [[32mCREATE VIEW[0m in 0.42s]
[0m11:00:37.633898 [debug] [Thread-3 (]: Finished running node model.superstore_project.stg_users
[0m11:00:37.639991 [debug] [Thread-2 (]: Finished running node model.superstore_project.stg_returns
[0m11:00:37.644614 [debug] [Thread-1 (]: Finished running node model.superstore_project.stg_orders
[0m11:00:37.663911 [debug] [Thread-4 (]: Began running node model.superstore_project.final_orders_with_returns
[0m11:00:37.664847 [debug] [Thread-3 (]: Began running node model.superstore_project.mart_orders_summary_by_region
[0m11:00:37.665589 [debug] [Thread-2 (]: Began running node model.superstore_project.monthly_returns_trend
[0m11:00:37.666678 [debug] [Thread-1 (]: Began running node model.superstore_project.product_performance
[0m11:00:37.669156 [info ] [Thread-4 (]: 4 of 8 START sql table model _analytics.final_orders_with_returns .............. [RUN]
[0m11:00:37.673066 [info ] [Thread-3 (]: 5 of 8 START sql table model _analytics.mart_orders_summary_by_region .......... [RUN]
[0m11:00:37.679181 [info ] [Thread-2 (]: 6 of 8 START sql table model _analytics.monthly_returns_trend .................. [RUN]
[0m11:00:37.682985 [info ] [Thread-1 (]: 7 of 8 START sql table model _analytics.product_performance .................... [RUN]
[0m11:00:37.688487 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_project.final_orders_with_returns'
[0m11:00:37.692817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_users, now model.superstore_project.mart_orders_summary_by_region)
[0m11:00:37.698117 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_returns, now model.superstore_project.monthly_returns_trend)
[0m11:00:37.702434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_orders, now model.superstore_project.product_performance)
[0m11:00:37.707465 [debug] [Thread-4 (]: Began compiling node model.superstore_project.final_orders_with_returns
[0m11:00:37.711573 [debug] [Thread-3 (]: Began compiling node model.superstore_project.mart_orders_summary_by_region
[0m11:00:37.714347 [debug] [Thread-2 (]: Began compiling node model.superstore_project.monthly_returns_trend
[0m11:00:37.717063 [debug] [Thread-1 (]: Began compiling node model.superstore_project.product_performance
[0m11:00:37.726874 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.final_orders_with_returns"
[0m11:00:37.732200 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.mart_orders_summary_by_region"
[0m11:00:37.737993 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.monthly_returns_trend"
[0m11:00:37.747073 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.product_performance"
[0m11:00:37.778952 [debug] [Thread-4 (]: Timing info for model.superstore_project.final_orders_with_returns (compile): 11:00:37.719469 => 11:00:37.777436
[0m11:00:37.781583 [debug] [Thread-2 (]: Timing info for model.superstore_project.monthly_returns_trend (compile): 11:00:37.734697 => 11:00:37.780785
[0m11:00:37.789226 [debug] [Thread-3 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (compile): 11:00:37.728677 => 11:00:37.787136
[0m11:00:37.791314 [debug] [Thread-4 (]: Began executing node model.superstore_project.final_orders_with_returns
[0m11:00:37.796401 [debug] [Thread-2 (]: Began executing node model.superstore_project.monthly_returns_trend
[0m11:00:37.798745 [debug] [Thread-1 (]: Timing info for model.superstore_project.product_performance (compile): 11:00:37.743302 => 11:00:37.798370
[0m11:00:37.801410 [debug] [Thread-3 (]: Began executing node model.superstore_project.mart_orders_summary_by_region
[0m11:00:37.825730 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_project.final_orders_with_returns"
[0m11:00:37.829290 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.monthly_returns_trend"
[0m11:00:37.832084 [debug] [Thread-1 (]: Began executing node model.superstore_project.product_performance
[0m11:00:37.840179 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.mart_orders_summary_by_region"
[0m11:00:37.856916 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.product_performance"
[0m11:00:37.868344 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m11:00:37.869069 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m11:00:37.872460 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: BEGIN
[0m11:00:37.873140 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m11:00:37.876441 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: BEGIN
[0m11:00:37.877592 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.product_performance"
[0m11:00:37.879198 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:37.881872 [debug] [Thread-3 (]: On model.superstore_project.mart_orders_summary_by_region: BEGIN
[0m11:00:37.884769 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:00:37.887405 [debug] [Thread-1 (]: On model.superstore_project.product_performance: BEGIN
[0m11:00:37.891507 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:00:37.895675 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:37.896817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:37.899523 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:37.904642 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m11:00:37.909574 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:37.910864 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m11:00:37.913190 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */

  
    

  create  table "postgres_metabase1"."_analytics"."monthly_returns_trend__dbt_tmp"
  
  
    as
  
  (
    WITH orders_with_returns AS (
    SELECT
        o.order_id,
        o.order_date,
        r.status
    FROM "postgres_metabase1"."_staging"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."_staging"."stg_returns" r
        ON o.order_id = r.order_id
),
returns_by_month AS (
    SELECT
        DATE_TRUNC('month', order_date) AS month,
        COUNT(*) FILTER (WHERE status = 'Returned') AS returned_orders,
        COUNT(*) AS total_orders,
        ROUND(
            COUNT(*) FILTER (WHERE status = 'Returned')::decimal
            / NULLIF(COUNT(*), 0),
            2
        ) AS return_rate
    FROM orders_with_returns
    GROUP BY 1
)
SELECT *
FROM returns_by_month
ORDER BY month
  );
  
[0m11:00:37.915136 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:37.915634 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m11:00:37.919443 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */

  
    

  create  table "postgres_metabase1"."_analytics"."final_orders_with_returns__dbt_tmp"
  
  
    as
  
  (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."_staging"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."_staging"."stg_returns" r
    ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."_staging"."stg_users" u
    ON o.region = u.region
)
SELECT *
FROM orders_with_returns
  );
  
[0m11:00:37.925320 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.product_performance"
[0m11:00:37.928769 [debug] [Thread-3 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */

  
    

  create  table "postgres_metabase1"."_analytics"."mart_orders_summary_by_region__dbt_tmp"
  
  
    as
  
  (
    WITH orders_with_returns AS (
    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."_staging"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."_staging"."stg_returns" r ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."_staging"."stg_users" u ON o.region = u.region
),

region_summary AS (
    SELECT
        region,
        region_manager,
        COUNT(DISTINCT order_id) AS total_orders,
        COUNT(DISTINCT CASE WHEN return_status = 'Returned' THEN order_id END) AS returned_orders,
        ROUND(100.0 * COUNT(DISTINCT CASE WHEN return_status = 'Returned' THEN order_id END) / NULLIF(COUNT(DISTINCT order_id), 0), 2) AS return_rate_percent,
        SUM(sales) AS total_sales,
        SUM(profit) AS total_profit,
        ROUND(AVG(discount), 4) AS avg_discount
    FROM orders_with_returns
    GROUP BY region, region_manager
)

SELECT *
FROM region_summary
ORDER BY return_rate_percent DESC
  );
  
[0m11:00:37.932184 [debug] [Thread-2 (]: SQL status: SELECT 48 in 0.0 seconds
[0m11:00:37.932908 [debug] [Thread-1 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */

  
    

  create  table "postgres_metabase1"."_analytics"."product_performance__dbt_tmp"
  
  
    as
  
  (
    SELECT
    product_name,
    product_category,
    product_subcategory,
    SUM(order_quantity) AS total_quantity_sold,
    SUM(sales) AS total_sales,
    SUM(profit) AS total_profit,
    ROUND(AVG(product_base_margin), 4) AS avg_margin,
    COUNT(DISTINCT order_id) AS num_orders
FROM "postgres_metabase1"."_staging"."stg_orders"
GROUP BY 1, 2, 3
ORDER BY total_sales DESC
LIMIT 100
  );
  
[0m11:00:37.942007 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m11:00:37.945698 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */
alter table "postgres_metabase1"."_analytics"."monthly_returns_trend__dbt_tmp" rename to "monthly_returns_trend"
[0m11:00:37.948356 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:00:37.955782 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: COMMIT
[0m11:00:37.956304 [debug] [Thread-4 (]: SQL status: SELECT 8399 in 0.0 seconds
[0m11:00:37.956728 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.0 seconds
[0m11:00:37.963278 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m11:00:37.966818 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m11:00:37.971824 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m11:00:37.982920 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m11:00:37.985598 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: COMMIT
[0m11:00:37.991202 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.product_performance"
[0m11:00:37.995243 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
alter table "postgres_metabase1"."_analytics"."final_orders_with_returns__dbt_tmp" rename to "final_orders_with_returns"
[0m11:00:38.001259 [debug] [Thread-3 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
alter table "postgres_metabase1"."_analytics"."mart_orders_summary_by_region__dbt_tmp" rename to "mart_orders_summary_by_region"
[0m11:00:38.008838 [debug] [Thread-1 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */
alter table "postgres_metabase1"."_analytics"."product_performance__dbt_tmp" rename to "product_performance"
[0m11:00:38.016084 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:38.018816 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:00:38.026777 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:00:38.032537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:00:38.043278 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."_analytics"."monthly_returns_trend__dbt_backup"
[0m11:00:38.059244 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m11:00:38.069825 [debug] [Thread-3 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m11:00:38.079756 [debug] [Thread-1 (]: On model.superstore_project.product_performance: COMMIT
[0m11:00:38.097154 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m11:00:38.100507 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m11:00:38.104785 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m11:00:38.109612 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.product_performance"
[0m11:00:38.114650 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */
drop table if exists "postgres_metabase1"."_analytics"."monthly_returns_trend__dbt_backup" cascade
[0m11:00:38.121624 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m11:00:38.126210 [debug] [Thread-3 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m11:00:38.129876 [debug] [Thread-1 (]: On model.superstore_project.product_performance: COMMIT
[0m11:00:38.134966 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:00:38.141231 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:38.142433 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:38.146407 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:38.149172 [debug] [Thread-2 (]: Timing info for model.superstore_project.monthly_returns_trend (execute): 11:00:37.826049 => 11:00:38.148741
[0m11:00:38.157571 [debug] [Thread-4 (]: Applying DROP to: "postgres_metabase1"."_analytics"."final_orders_with_returns__dbt_backup"
[0m11:00:38.164506 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."_analytics"."mart_orders_summary_by_region__dbt_backup"
[0m11:00:38.174539 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."_analytics"."product_performance__dbt_backup"
[0m11:00:38.177253 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: Close
[0m11:00:38.181230 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m11:00:38.185671 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m11:00:38.190406 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.product_performance"
[0m11:00:38.197790 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcc677dc-6215-410e-a9f2-d2ba4442c223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b10434f70>]}
[0m11:00:38.202125 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
drop table if exists "postgres_metabase1"."_analytics"."final_orders_with_returns__dbt_backup" cascade
[0m11:00:38.206493 [debug] [Thread-3 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
drop table if exists "postgres_metabase1"."_analytics"."mart_orders_summary_by_region__dbt_backup" cascade
[0m11:00:38.210507 [debug] [Thread-1 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */
drop table if exists "postgres_metabase1"."_analytics"."product_performance__dbt_backup" cascade
[0m11:00:38.215215 [info ] [Thread-2 (]: 6 of 8 OK created sql table model _analytics.monthly_returns_trend ............. [[32mSELECT 48[0m in 0.50s]
[0m11:00:38.219673 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:00:38.223652 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:00:38.227861 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:00:38.231462 [debug] [Thread-2 (]: Finished running node model.superstore_project.monthly_returns_trend
[0m11:00:38.238937 [debug] [Thread-4 (]: Timing info for model.superstore_project.final_orders_with_returns (execute): 11:00:37.804217 => 11:00:38.238521
[0m11:00:38.243815 [debug] [Thread-3 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (execute): 11:00:37.834877 => 11:00:38.243450
[0m11:00:38.249260 [debug] [Thread-1 (]: Timing info for model.superstore_project.product_performance (execute): 11:00:37.849325 => 11:00:38.248931
[0m11:00:38.251877 [debug] [Thread-2 (]: Began running node model.superstore_project.top_customers
[0m11:00:38.254606 [debug] [Thread-4 (]: On model.superstore_project.final_orders_with_returns: Close
[0m11:00:38.257177 [debug] [Thread-3 (]: On model.superstore_project.mart_orders_summary_by_region: Close
[0m11:00:38.259318 [debug] [Thread-1 (]: On model.superstore_project.product_performance: Close
[0m11:00:38.262274 [info ] [Thread-2 (]: 8 of 8 START sql table model _analytics.top_customers .......................... [RUN]
[0m11:00:38.265585 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcc677dc-6215-410e-a9f2-d2ba4442c223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b10463e50>]}
[0m11:00:38.268723 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcc677dc-6215-410e-a9f2-d2ba4442c223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b1047f220>]}
[0m11:00:38.271626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcc677dc-6215-410e-a9f2-d2ba4442c223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b104cbe50>]}
[0m11:00:38.274814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.monthly_returns_trend, now model.superstore_project.top_customers)
[0m11:00:38.277108 [info ] [Thread-4 (]: 4 of 8 OK created sql table model _analytics.final_orders_with_returns ......... [[32mSELECT 8399[0m in 0.58s]
[0m11:00:38.281623 [info ] [Thread-3 (]: 5 of 8 OK created sql table model _analytics.mart_orders_summary_by_region ..... [[32mSELECT 4[0m in 0.58s]
[0m11:00:38.284245 [info ] [Thread-1 (]: 7 of 8 OK created sql table model _analytics.product_performance ............... [[32mSELECT 100[0m in 0.57s]
[0m11:00:38.287504 [debug] [Thread-2 (]: Began compiling node model.superstore_project.top_customers
[0m11:00:38.290124 [debug] [Thread-4 (]: Finished running node model.superstore_project.final_orders_with_returns
[0m11:00:38.292916 [debug] [Thread-3 (]: Finished running node model.superstore_project.mart_orders_summary_by_region
[0m11:00:38.296223 [debug] [Thread-1 (]: Finished running node model.superstore_project.product_performance
[0m11:00:38.301697 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.top_customers"
[0m11:00:38.339650 [debug] [Thread-2 (]: Timing info for model.superstore_project.top_customers (compile): 11:00:38.298150 => 11:00:38.338651
[0m11:00:38.344235 [debug] [Thread-2 (]: Began executing node model.superstore_project.top_customers
[0m11:00:38.360502 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.top_customers"
[0m11:00:38.424442 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.top_customers"
[0m11:00:38.441234 [debug] [Thread-2 (]: On model.superstore_project.top_customers: BEGIN
[0m11:00:38.449374 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:38.487997 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:38.496030 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.top_customers"
[0m11:00:38.506235 [debug] [Thread-2 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */

  
    

  create  table "postgres_metabase1"."_analytics"."top_customers__dbt_tmp"
  
  
    as
  
  (
    SELECT
    customer_name,
    customer_segment,
    region,
    SUM(sales) AS total_sales,
    COUNT(DISTINCT order_id) AS num_orders,
    ROUND(AVG(profit), 2) AS avg_profit
FROM "postgres_metabase1"."_staging"."stg_orders"
GROUP BY 1, 2, 3
ORDER BY total_sales DESC
LIMIT 50
  );
  
[0m11:00:38.547963 [debug] [Thread-2 (]: SQL status: SELECT 50 in 0.0 seconds
[0m11:00:38.557007 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.top_customers"
[0m11:00:38.559395 [debug] [Thread-2 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */
alter table "postgres_metabase1"."_analytics"."top_customers__dbt_tmp" rename to "top_customers"
[0m11:00:38.562742 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:00:38.566124 [debug] [Thread-2 (]: On model.superstore_project.top_customers: COMMIT
[0m11:00:38.568028 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.top_customers"
[0m11:00:38.571358 [debug] [Thread-2 (]: On model.superstore_project.top_customers: COMMIT
[0m11:00:38.578984 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:00:38.595926 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."_analytics"."top_customers__dbt_backup"
[0m11:00:38.607900 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.top_customers"
[0m11:00:38.620391 [debug] [Thread-2 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */
drop table if exists "postgres_metabase1"."_analytics"."top_customers__dbt_backup" cascade
[0m11:00:38.630708 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:00:38.651136 [debug] [Thread-2 (]: Timing info for model.superstore_project.top_customers (execute): 11:00:38.348395 => 11:00:38.649827
[0m11:00:38.664663 [debug] [Thread-2 (]: On model.superstore_project.top_customers: Close
[0m11:00:38.679130 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcc677dc-6215-410e-a9f2-d2ba4442c223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b1047ec80>]}
[0m11:00:38.689907 [info ] [Thread-2 (]: 8 of 8 OK created sql table model _analytics.top_customers ..................... [[32mSELECT 50[0m in 0.40s]
[0m11:00:38.699271 [debug] [Thread-2 (]: Finished running node model.superstore_project.top_customers
[0m11:00:38.711630 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:38.715226 [debug] [MainThread]: On master: BEGIN
[0m11:00:38.718037 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:00:38.728522 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:38.730812 [debug] [MainThread]: On master: COMMIT
[0m11:00:38.739352 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:38.742303 [debug] [MainThread]: On master: COMMIT
[0m11:00:38.750948 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:00:38.755731 [debug] [MainThread]: On master: Close
[0m11:00:38.762341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:38.771537 [debug] [MainThread]: Connection 'model.superstore_project.product_performance' was properly closed.
[0m11:00:38.776084 [debug] [MainThread]: Connection 'model.superstore_project.top_customers' was properly closed.
[0m11:00:38.782960 [debug] [MainThread]: Connection 'model.superstore_project.mart_orders_summary_by_region' was properly closed.
[0m11:00:38.796860 [debug] [MainThread]: Connection 'model.superstore_project.final_orders_with_returns' was properly closed.
[0m11:00:38.805999 [info ] [MainThread]: 
[0m11:00:38.813019 [info ] [MainThread]: Finished running 3 view models, 5 table models in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m11:00:38.823800 [debug] [MainThread]: Command end result
[0m11:00:38.925163 [info ] [MainThread]: 
[0m11:00:38.928732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:00:38.931347 [info ] [MainThread]: 
[0m11:00:38.937306 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m11:00:38.949439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3690903, "process_user_time": 3.137755, "process_kernel_time": 0.346847, "process_mem_max_rss": "106660", "process_in_blocks": "80576", "process_out_blocks": "0"}
[0m11:00:38.954064 [debug] [MainThread]: Command `dbt run` succeeded at 11:00:38.953815 after 3.37 seconds
[0m11:00:38.957537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b16f0ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b136d7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786b15186200>]}
[0m11:00:38.960090 [debug] [MainThread]: Flushing usage events
[0m11:00:50.193666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51e785e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51e5ad60e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51e5ad6080>]}


============================== 11:00:50.197599 | b88fabc7-4823-42e7-9cf7-16b107ebd4e9 ==============================
[0m11:00:50.197599 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:00:50.199257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app/profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:00:50.383456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b88fabc7-4823-42e7-9cf7-16b107ebd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51e5ad61d0>]}
[0m11:00:50.476983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b88fabc7-4823-42e7-9cf7-16b107ebd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51e4081240>]}
[0m11:00:50.506162 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m11:00:50.594100 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:00:52.083607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:00:52.094470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:00:52.134726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b88fabc7-4823-42e7-9cf7-16b107ebd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51e3e7e5f0>]}
[0m11:00:52.307585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b88fabc7-4823-42e7-9cf7-16b107ebd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51e40450c0>]}
[0m11:00:52.313794 [info ] [MainThread]: Found 8 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:00:52.321273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b88fabc7-4823-42e7-9cf7-16b107ebd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51e4045420>]}
[0m11:00:52.334184 [info ] [MainThread]: 
[0m11:00:52.339228 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:00:52.348944 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1__staging'
[0m11:00:52.354902 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1__analytics'
[0m11:00:52.369848 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__staging"
[0m11:00:52.372440 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__analytics"
[0m11:00:52.374869 [debug] [ThreadPool]: On list_postgres_metabase1__staging: BEGIN
[0m11:00:52.377368 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: BEGIN
[0m11:00:52.379494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:52.383035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:52.392506 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:00:52.395177 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:00:52.395602 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__staging"
[0m11:00:52.399543 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__analytics"
[0m11:00:52.402452 [debug] [ThreadPool]: On list_postgres_metabase1__staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1__staging"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m11:00:52.404578 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1__analytics"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m11:00:52.414361 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m11:00:52.417949 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:00:52.420462 [debug] [ThreadPool]: On list_postgres_metabase1__staging: ROLLBACK
[0m11:00:52.428585 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: ROLLBACK
[0m11:00:52.434026 [debug] [ThreadPool]: On list_postgres_metabase1__staging: Close
[0m11:00:52.439593 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: Close
[0m11:00:52.470135 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:52.481914 [debug] [MainThread]: On master: BEGIN
[0m11:00:52.491560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:00:52.529083 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:52.534626 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:52.543095 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:00:52.567644 [debug] [MainThread]: SQL status: SELECT 47 in 0.0 seconds
[0m11:00:52.578086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b88fabc7-4823-42e7-9cf7-16b107ebd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51e402b730>]}
[0m11:00:52.585451 [debug] [MainThread]: On master: ROLLBACK
[0m11:00:52.596248 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:52.605402 [debug] [MainThread]: On master: BEGIN
[0m11:00:52.617927 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:52.627247 [debug] [MainThread]: On master: COMMIT
[0m11:00:52.636023 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:52.645505 [debug] [MainThread]: On master: COMMIT
[0m11:00:52.657249 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:00:52.665433 [debug] [MainThread]: On master: Close
[0m11:00:52.677817 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:00:52.686641 [info ] [MainThread]: 
[0m11:00:52.701769 [debug] [Thread-1 (]: Began running node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:00:52.702670 [debug] [Thread-2 (]: Began running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:00:52.703374 [debug] [Thread-3 (]: Began running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:00:52.704129 [debug] [Thread-4 (]: Began running node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:00:52.705619 [info ] [Thread-1 (]: 1 of 7 START test not_null_final_orders_with_returns_order_id .................. [RUN]
[0m11:00:52.707624 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_orders_order_id ................................. [RUN]
[0m11:00:52.709996 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_orders_region ................................... [RUN]
[0m11:00:52.713675 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_orders_row_id ................................... [RUN]
[0m11:00:52.715883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1__analytics, now test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028)
[0m11:00:52.717939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1__staging, now test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m11:00:52.719975 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.superstore_project.not_null_stg_orders_region.c7b18a6907'
[0m11:00:52.721980 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_project.not_null_stg_orders_row_id.6258f0907f'
[0m11:00:52.723430 [debug] [Thread-1 (]: Began compiling node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:00:52.725229 [debug] [Thread-2 (]: Began compiling node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:00:52.726729 [debug] [Thread-3 (]: Began compiling node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:00:52.727933 [debug] [Thread-4 (]: Began compiling node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:00:52.745995 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028"
[0m11:00:52.749934 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:00:52.755477 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m11:00:52.761770 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_row_id.6258f0907f"
[0m11:00:52.773564 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028 (compile): 11:00:52.729256 => 11:00:52.773245
[0m11:00:52.774298 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (compile): 11:00:52.751462 => 11:00:52.774044
[0m11:00:52.775513 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (compile): 11:00:52.746277 => 11:00:52.775229
[0m11:00:52.776101 [debug] [Thread-1 (]: Began executing node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:00:52.786051 [debug] [Thread-3 (]: Began executing node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:00:52.789162 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_orders_row_id.6258f0907f (compile): 11:00:52.757437 => 11:00:52.788773
[0m11:00:52.796811 [debug] [Thread-2 (]: Began executing node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:00:52.824734 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028"
[0m11:00:52.826728 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m11:00:52.832143 [debug] [Thread-4 (]: Began executing node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:00:52.840767 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:00:52.864631 [debug] [Thread-4 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_orders_row_id.6258f0907f"
[0m11:00:52.892153 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028"
[0m11:00:52.894849 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m11:00:52.915928 [debug] [Thread-1 (]: On test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028: BEGIN
[0m11:00:52.920785 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:00:52.930002 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: BEGIN
[0m11:00:52.933776 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_row_id.6258f0907f"
[0m11:00:52.941862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:52.951992 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m11:00:52.961032 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:00:52.969132 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_orders_row_id.6258f0907f: BEGIN
[0m11:00:52.986287 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:53.004747 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:00:53.010663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:53.023305 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:53.027504 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028"
[0m11:00:53.031076 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:53.033388 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m11:00:53.036447 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:53.038627 [debug] [Thread-1 (]: On test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres_metabase1"."_analytics"."final_orders_with_returns"
where order_id is null



      
    ) dbt_internal_test
[0m11:00:53.045215 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:00:53.053674 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_orders_region.c7b18a6907"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "postgres_metabase1"."_staging"."stg_orders"
where region is null



      
    ) dbt_internal_test
[0m11:00:53.061711 [debug] [Thread-4 (]: Using postgres connection "test.superstore_project.not_null_stg_orders_row_id.6258f0907f"
[0m11:00:53.077611 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres_metabase1"."_staging"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
[0m11:00:53.079861 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:00:53.094997 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_orders_row_id.6258f0907f: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_orders_row_id.6258f0907f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select row_id
from "postgres_metabase1"."_staging"."stg_orders"
where row_id is null



      
    ) dbt_internal_test
[0m11:00:53.097509 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:00:53.111273 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:00:53.124552 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028 (execute): 11:00:52.801501 => 11:00:53.121780
[0m11:00:53.144585 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:00:53.155539 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (execute): 11:00:52.825001 => 11:00:53.154029
[0m11:00:53.170751 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (execute): 11:00:52.837249 => 11:00:53.167895
[0m11:00:53.179162 [debug] [Thread-1 (]: On test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028: ROLLBACK
[0m11:00:53.191301 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_orders_row_id.6258f0907f (execute): 11:00:52.857026 => 11:00:53.190845
[0m11:00:53.194482 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: ROLLBACK
[0m11:00:53.198797 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m11:00:53.204116 [debug] [Thread-1 (]: On test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028: Close
[0m11:00:53.208877 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_orders_row_id.6258f0907f: ROLLBACK
[0m11:00:53.215093 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_orders_region.c7b18a6907: Close
[0m11:00:53.220088 [debug] [Thread-2 (]: On test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m11:00:53.225888 [info ] [Thread-1 (]: 1 of 7 PASS not_null_final_orders_with_returns_order_id ........................ [[32mPASS[0m in 0.51s]
[0m11:00:53.230155 [debug] [Thread-4 (]: On test.superstore_project.not_null_stg_orders_row_id.6258f0907f: Close
[0m11:00:53.233445 [info ] [Thread-3 (]: 3 of 7 PASS not_null_stg_orders_region ......................................... [[32mPASS[0m in 0.51s]
[0m11:00:53.239514 [info ] [Thread-2 (]: 2 of 7 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.52s]
[0m11:00:53.247201 [debug] [Thread-1 (]: Finished running node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:00:53.253257 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_orders_row_id ......................................... [[32mPASS[0m in 0.53s]
[0m11:00:53.259598 [debug] [Thread-3 (]: Finished running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:00:53.265236 [debug] [Thread-2 (]: Finished running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:00:53.272527 [debug] [Thread-1 (]: Began running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:00:53.276771 [debug] [Thread-4 (]: Finished running node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:00:53.285232 [debug] [Thread-3 (]: Began running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:00:53.293539 [debug] [Thread-2 (]: Began running node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:00:53.296895 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_returns_order_id ................................ [RUN]
[0m11:00:53.302424 [info ] [Thread-3 (]: 6 of 7 START test not_null_stg_users_region .................................... [RUN]
[0m11:00:53.305211 [info ] [Thread-2 (]: 7 of 7 START test unique_stg_orders_row_id ..................................... [RUN]
[0m11:00:53.308359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028, now test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e)
[0m11:00:53.311877 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_region.c7b18a6907, now test.superstore_project.not_null_stg_users_region.97049f06a2)
[0m11:00:53.316735 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64, now test.superstore_project.unique_stg_orders_row_id.71d19f9f6d)
[0m11:00:53.320039 [debug] [Thread-1 (]: Began compiling node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:00:53.323652 [debug] [Thread-3 (]: Began compiling node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:00:53.326923 [debug] [Thread-2 (]: Began compiling node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:00:53.335140 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m11:00:53.343012 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m11:00:53.353256 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_project.unique_stg_orders_row_id.71d19f9f6d"
[0m11:00:53.388702 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (compile): 11:00:53.337482 => 11:00:53.387319
[0m11:00:53.397759 [debug] [Thread-2 (]: Timing info for test.superstore_project.unique_stg_orders_row_id.71d19f9f6d (compile): 11:00:53.345546 => 11:00:53.396646
[0m11:00:53.402916 [debug] [Thread-3 (]: Began executing node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:00:53.414217 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (compile): 11:00:53.329927 => 11:00:53.412036
[0m11:00:53.416867 [debug] [Thread-2 (]: Began executing node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:00:53.519498 [debug] [Thread-3 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m11:00:53.525302 [debug] [Thread-1 (]: Began executing node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:00:53.544248 [debug] [Thread-2 (]: Writing runtime sql for node "test.superstore_project.unique_stg_orders_row_id.71d19f9f6d"
[0m11:00:53.570989 [debug] [Thread-1 (]: Writing runtime sql for node "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m11:00:53.607482 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m11:00:53.610746 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.unique_stg_orders_row_id.71d19f9f6d"
[0m11:00:53.624033 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: BEGIN
[0m11:00:53.638838 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m11:00:53.641670 [debug] [Thread-2 (]: On test.superstore_project.unique_stg_orders_row_id.71d19f9f6d: BEGIN
[0m11:00:53.653421 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:00:53.662803 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: BEGIN
[0m11:00:53.672424 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:00:53.689029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:53.704886 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:53.714064 [debug] [Thread-3 (]: Using postgres connection "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m11:00:53.717763 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:53.720979 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_users_region.97049f06a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "postgres_metabase1"."_staging"."stg_users"
where region is null



      
    ) dbt_internal_test
[0m11:00:53.723078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:53.726024 [debug] [Thread-2 (]: Using postgres connection "test.superstore_project.unique_stg_orders_row_id.71d19f9f6d"
[0m11:00:53.734441 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:00:53.735040 [debug] [Thread-1 (]: Using postgres connection "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m11:00:53.738713 [debug] [Thread-2 (]: On test.superstore_project.unique_stg_orders_row_id.71d19f9f6d: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.unique_stg_orders_row_id.71d19f9f6d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    row_id as unique_field,
    count(*) as n_records

from "postgres_metabase1"."_staging"."stg_orders"
where row_id is not null
group by row_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:00:53.742776 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (execute): 11:00:53.426625 => 11:00:53.742403
[0m11:00:53.745709 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "postgres_metabase1"."_staging"."stg_returns"
where order_id is null



      
    ) dbt_internal_test
[0m11:00:53.751600 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: ROLLBACK
[0m11:00:53.757834 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:00:53.759120 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:00:53.760895 [debug] [Thread-3 (]: On test.superstore_project.not_null_stg_users_region.97049f06a2: Close
[0m11:00:53.763768 [debug] [Thread-2 (]: Timing info for test.superstore_project.unique_stg_orders_row_id.71d19f9f6d (execute): 11:00:53.533940 => 11:00:53.763559
[0m11:00:53.769213 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (execute): 11:00:53.562008 => 11:00:53.768640
[0m11:00:53.775112 [info ] [Thread-3 (]: 6 of 7 PASS not_null_stg_users_region .......................................... [[32mPASS[0m in 0.46s]
[0m11:00:53.780716 [debug] [Thread-2 (]: On test.superstore_project.unique_stg_orders_row_id.71d19f9f6d: ROLLBACK
[0m11:00:53.783826 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: ROLLBACK
[0m11:00:53.787172 [debug] [Thread-3 (]: Finished running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:00:53.790846 [debug] [Thread-2 (]: On test.superstore_project.unique_stg_orders_row_id.71d19f9f6d: Close
[0m11:00:53.799763 [debug] [Thread-1 (]: On test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e: Close
[0m11:00:53.807783 [info ] [Thread-2 (]: 7 of 7 PASS unique_stg_orders_row_id ........................................... [[32mPASS[0m in 0.49s]
[0m11:00:53.812892 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_returns_order_id ...................................... [[32mPASS[0m in 0.50s]
[0m11:00:53.815987 [debug] [Thread-2 (]: Finished running node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:00:53.819105 [debug] [Thread-1 (]: Finished running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:00:53.827513 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:53.831227 [debug] [MainThread]: On master: BEGIN
[0m11:00:53.833673 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:00:53.841893 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:53.853875 [debug] [MainThread]: On master: COMMIT
[0m11:00:53.863029 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:53.869238 [debug] [MainThread]: On master: COMMIT
[0m11:00:53.876833 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:00:53.879131 [debug] [MainThread]: On master: Close
[0m11:00:53.885764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:53.891029 [debug] [MainThread]: Connection 'test.superstore_project.unique_stg_orders_row_id.71d19f9f6d' was properly closed.
[0m11:00:53.896491 [debug] [MainThread]: Connection 'test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e' was properly closed.
[0m11:00:53.900970 [debug] [MainThread]: Connection 'test.superstore_project.not_null_stg_users_region.97049f06a2' was properly closed.
[0m11:00:53.906159 [debug] [MainThread]: Connection 'test.superstore_project.not_null_stg_orders_row_id.6258f0907f' was properly closed.
[0m11:00:53.911954 [info ] [MainThread]: 
[0m11:00:53.919563 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m11:00:53.929271 [debug] [MainThread]: Command end result
[0m11:00:54.090733 [info ] [MainThread]: 
[0m11:00:54.101631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:00:54.113674 [info ] [MainThread]: 
[0m11:00:54.125044 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:00:54.138690 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.999278, "process_user_time": 2.70971, "process_kernel_time": 0.337645, "process_mem_max_rss": "104552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:00:54.149451 [debug] [MainThread]: Command `dbt test` succeeded at 11:00:54.148954 after 4.01 seconds
[0m11:00:54.157635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51e785e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51e4198ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b51e40454b0>]}
[0m11:00:54.166899 [debug] [MainThread]: Flushing usage events
[0m11:15:08.204247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8725ad2740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8723d59840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8723d597e0>]}


============================== 11:15:08.217862 | a74206dc-a83c-44aa-a67e-b6bdb9f6fea0 ==============================
[0m11:15:08.217862 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:15:08.228392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:15:08.948883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a74206dc-a83c-44aa-a67e-b6bdb9f6fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8727d83610>]}
[0m11:15:09.030703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a74206dc-a83c-44aa-a67e-b6bdb9f6fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8725395570>]}
[0m11:15:09.037171 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m11:15:09.085650 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:15:11.310432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:11.315090 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:11.331597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a74206dc-a83c-44aa-a67e-b6bdb9f6fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c87220f2800>]}
[0m11:15:11.419326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a74206dc-a83c-44aa-a67e-b6bdb9f6fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c87222b94b0>]}
[0m11:15:11.435099 [info ] [MainThread]: Found 8 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:15:11.445977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a74206dc-a83c-44aa-a67e-b6bdb9f6fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c87222b9540>]}
[0m11:15:11.457365 [info ] [MainThread]: 
[0m11:15:11.466383 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:15:11.474663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1__analytics'
[0m11:15:11.477318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1__staging'
[0m11:15:11.506886 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__analytics"
[0m11:15:11.509706 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__staging"
[0m11:15:11.514173 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: BEGIN
[0m11:15:11.518369 [debug] [ThreadPool]: On list_postgres_metabase1__staging: BEGIN
[0m11:15:11.522965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:11.528001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:11.575683 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:15:11.576668 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:15:11.580558 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__analytics"
[0m11:15:11.585747 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__staging"
[0m11:15:11.591840 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1__analytics"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m11:15:11.597139 [debug] [ThreadPool]: On list_postgres_metabase1__staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1__staging"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m11:15:11.611353 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:15:11.613622 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m11:15:11.616728 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: ROLLBACK
[0m11:15:11.621132 [debug] [ThreadPool]: On list_postgres_metabase1__staging: ROLLBACK
[0m11:15:11.624678 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: Close
[0m11:15:11.626637 [debug] [ThreadPool]: On list_postgres_metabase1__staging: Close
[0m11:15:11.640629 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:11.650545 [debug] [MainThread]: On master: BEGIN
[0m11:15:11.660796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:11.696158 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:15:11.705667 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:11.714033 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:15:11.732316 [debug] [MainThread]: SQL status: SELECT 47 in 0.0 seconds
[0m11:15:11.742104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a74206dc-a83c-44aa-a67e-b6bdb9f6fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c872212ebf0>]}
[0m11:15:11.750092 [debug] [MainThread]: On master: ROLLBACK
[0m11:15:11.759335 [debug] [MainThread]: On master: Close
[0m11:15:11.769728 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:15:11.778006 [info ] [MainThread]: 
[0m11:15:11.799904 [debug] [Thread-1 (]: Began running node model.superstore_project.stg_orders
[0m11:15:11.801198 [debug] [Thread-2 (]: Began running node model.superstore_project.stg_returns
[0m11:15:11.802604 [debug] [Thread-3 (]: Began running node model.superstore_project.stg_users
[0m11:15:11.807702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1__staging, now model.superstore_project.stg_orders)
[0m11:15:11.818562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1__analytics, now model.superstore_project.stg_returns)
[0m11:15:11.824895 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_project.stg_users'
[0m11:15:11.832840 [debug] [Thread-1 (]: Began compiling node model.superstore_project.stg_orders
[0m11:15:11.841133 [debug] [Thread-2 (]: Began compiling node model.superstore_project.stg_returns
[0m11:15:11.850149 [debug] [Thread-3 (]: Began compiling node model.superstore_project.stg_users
[0m11:15:11.882753 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.stg_orders"
[0m11:15:11.887361 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.stg_returns"
[0m11:15:11.902615 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.stg_users"
[0m11:15:11.977199 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (compile): 11:15:11.858084 => 11:15:11.975969
[0m11:15:11.985916 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (compile): 11:15:11.883366 => 11:15:11.984173
[0m11:15:11.988744 [debug] [Thread-1 (]: Began executing node model.superstore_project.stg_orders
[0m11:15:11.999791 [debug] [Thread-2 (]: Began executing node model.superstore_project.stg_returns
[0m11:15:12.002404 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (compile): 11:15:11.894247 => 11:15:12.001566
[0m11:15:12.008662 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (execute): 11:15:12.008033 => 11:15:12.008079
[0m11:15:12.013583 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (execute): 11:15:12.013172 => 11:15:12.013193
[0m11:15:12.017313 [debug] [Thread-3 (]: Began executing node model.superstore_project.stg_users
[0m11:15:12.021531 [debug] [Thread-1 (]: Finished running node model.superstore_project.stg_orders
[0m11:15:12.025104 [debug] [Thread-2 (]: Finished running node model.superstore_project.stg_returns
[0m11:15:12.028092 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (execute): 11:15:12.027786 => 11:15:12.027801
[0m11:15:12.032055 [debug] [Thread-4 (]: Began running node model.superstore_project.product_performance
[0m11:15:12.032678 [debug] [Thread-1 (]: Began running node model.superstore_project.top_customers
[0m11:15:12.034618 [debug] [Thread-2 (]: Began running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:15:12.038499 [debug] [Thread-3 (]: Finished running node model.superstore_project.stg_users
[0m11:15:12.041751 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_project.product_performance'
[0m11:15:12.045144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_orders, now model.superstore_project.top_customers)
[0m11:15:12.048245 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_returns, now test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m11:15:12.051136 [debug] [Thread-3 (]: Began running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:15:12.053529 [debug] [Thread-4 (]: Began compiling node model.superstore_project.product_performance
[0m11:15:12.055925 [debug] [Thread-1 (]: Began compiling node model.superstore_project.top_customers
[0m11:15:12.058743 [debug] [Thread-2 (]: Began compiling node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:15:12.061728 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_users, now test.superstore_project.not_null_stg_orders_region.c7b18a6907)
[0m11:15:12.067438 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.product_performance"
[0m11:15:12.072525 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.top_customers"
[0m11:15:12.090951 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:15:12.092674 [debug] [Thread-3 (]: Began compiling node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:15:12.121694 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m11:15:12.136634 [debug] [Thread-4 (]: Timing info for model.superstore_project.product_performance (compile): 11:15:12.064202 => 11:15:12.136232
[0m11:15:12.138468 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (compile): 11:15:12.075421 => 11:15:12.137559
[0m11:15:12.143124 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (compile): 11:15:12.107986 => 11:15:12.141890
[0m11:15:12.146717 [debug] [Thread-4 (]: Began executing node model.superstore_project.product_performance
[0m11:15:12.147885 [debug] [Thread-1 (]: Timing info for model.superstore_project.top_customers (compile): 11:15:12.069962 => 11:15:12.147402
[0m11:15:12.149480 [debug] [Thread-2 (]: Began executing node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:15:12.154080 [debug] [Thread-3 (]: Began executing node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:15:12.158315 [debug] [Thread-4 (]: Timing info for model.superstore_project.product_performance (execute): 11:15:12.158105 => 11:15:12.158119
[0m11:15:12.161944 [debug] [Thread-1 (]: Began executing node model.superstore_project.top_customers
[0m11:15:12.167564 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (execute): 11:15:12.166518 => 11:15:12.166556
[0m11:15:12.172830 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (execute): 11:15:12.171998 => 11:15:12.172035
[0m11:15:12.182965 [debug] [Thread-4 (]: Finished running node model.superstore_project.product_performance
[0m11:15:12.193030 [debug] [Thread-1 (]: Timing info for model.superstore_project.top_customers (execute): 11:15:12.190950 => 11:15:12.191005
[0m11:15:12.204996 [debug] [Thread-2 (]: Finished running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:15:12.214275 [debug] [Thread-3 (]: Finished running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:15:12.219322 [debug] [Thread-4 (]: Began running node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:15:12.223500 [debug] [Thread-1 (]: Finished running node model.superstore_project.top_customers
[0m11:15:12.227975 [debug] [Thread-2 (]: Began running node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:15:12.236115 [debug] [Thread-3 (]: Began running node model.superstore_project.monthly_returns_trend
[0m11:15:12.241644 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_project.product_performance, now test.superstore_project.not_null_stg_orders_row_id.6258f0907f)
[0m11:15:12.245387 [debug] [Thread-1 (]: Began running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:15:12.251750 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64, now test.superstore_project.unique_stg_orders_row_id.71d19f9f6d)
[0m11:15:12.259216 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_region.c7b18a6907, now model.superstore_project.monthly_returns_trend)
[0m11:15:12.265796 [debug] [Thread-4 (]: Began compiling node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:15:12.270716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_project.top_customers, now test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e)
[0m11:15:12.276686 [debug] [Thread-2 (]: Began compiling node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:15:12.282090 [debug] [Thread-3 (]: Began compiling node model.superstore_project.monthly_returns_trend
[0m11:15:12.298562 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_row_id.6258f0907f"
[0m11:15:12.301805 [debug] [Thread-1 (]: Began compiling node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:15:12.314348 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_project.unique_stg_orders_row_id.71d19f9f6d"
[0m11:15:12.320853 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.monthly_returns_trend"
[0m11:15:12.334023 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m11:15:12.355092 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_orders_row_id.6258f0907f (compile): 11:15:12.287605 => 11:15:12.354255
[0m11:15:12.357190 [debug] [Thread-2 (]: Timing info for test.superstore_project.unique_stg_orders_row_id.71d19f9f6d (compile): 11:15:12.306298 => 11:15:12.356973
[0m11:15:12.359010 [debug] [Thread-4 (]: Began executing node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:15:12.359606 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (compile): 11:15:12.327642 => 11:15:12.359406
[0m11:15:12.365169 [debug] [Thread-3 (]: Timing info for model.superstore_project.monthly_returns_trend (compile): 11:15:12.316167 => 11:15:12.363771
[0m11:15:12.367156 [debug] [Thread-2 (]: Began executing node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:15:12.373349 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_orders_row_id.6258f0907f (execute): 11:15:12.372476 => 11:15:12.372515
[0m11:15:12.377981 [debug] [Thread-1 (]: Began executing node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:15:12.383308 [debug] [Thread-3 (]: Began executing node model.superstore_project.monthly_returns_trend
[0m11:15:12.388538 [debug] [Thread-2 (]: Timing info for test.superstore_project.unique_stg_orders_row_id.71d19f9f6d (execute): 11:15:12.387776 => 11:15:12.387810
[0m11:15:12.395380 [debug] [Thread-4 (]: Finished running node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:15:12.401101 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (execute): 11:15:12.400145 => 11:15:12.400185
[0m11:15:12.407546 [debug] [Thread-3 (]: Timing info for model.superstore_project.monthly_returns_trend (execute): 11:15:12.406657 => 11:15:12.406700
[0m11:15:12.412015 [debug] [Thread-2 (]: Finished running node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:15:12.416548 [debug] [Thread-4 (]: Began running node model.superstore_project.final_orders_with_returns
[0m11:15:12.422705 [debug] [Thread-1 (]: Finished running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:15:12.428261 [debug] [Thread-3 (]: Finished running node model.superstore_project.monthly_returns_trend
[0m11:15:12.433177 [debug] [Thread-2 (]: Began running node model.superstore_project.mart_orders_summary_by_region
[0m11:15:12.438810 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_row_id.6258f0907f, now model.superstore_project.final_orders_with_returns)
[0m11:15:12.443315 [debug] [Thread-1 (]: Began running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:15:12.452529 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_project.unique_stg_orders_row_id.71d19f9f6d, now model.superstore_project.mart_orders_summary_by_region)
[0m11:15:12.457205 [debug] [Thread-4 (]: Began compiling node model.superstore_project.final_orders_with_returns
[0m11:15:12.462475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e, now test.superstore_project.not_null_stg_users_region.97049f06a2)
[0m11:15:12.465318 [debug] [Thread-2 (]: Began compiling node model.superstore_project.mart_orders_summary_by_region
[0m11:15:12.471636 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.final_orders_with_returns"
[0m11:15:12.474580 [debug] [Thread-1 (]: Began compiling node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:15:12.479769 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.mart_orders_summary_by_region"
[0m11:15:12.488159 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m11:15:12.501103 [debug] [Thread-4 (]: Timing info for model.superstore_project.final_orders_with_returns (compile): 11:15:12.467364 => 11:15:12.500732
[0m11:15:12.502499 [debug] [Thread-2 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (compile): 11:15:12.476868 => 11:15:12.502129
[0m11:15:12.504424 [debug] [Thread-4 (]: Began executing node model.superstore_project.final_orders_with_returns
[0m11:15:12.506505 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (compile): 11:15:12.483654 => 11:15:12.506294
[0m11:15:12.506958 [debug] [Thread-2 (]: Began executing node model.superstore_project.mart_orders_summary_by_region
[0m11:15:12.510788 [debug] [Thread-4 (]: Timing info for model.superstore_project.final_orders_with_returns (execute): 11:15:12.510450 => 11:15:12.510471
[0m11:15:12.512827 [debug] [Thread-1 (]: Began executing node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:15:12.514933 [debug] [Thread-2 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (execute): 11:15:12.514742 => 11:15:12.514751
[0m11:15:12.517664 [debug] [Thread-4 (]: Finished running node model.superstore_project.final_orders_with_returns
[0m11:15:12.520139 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (execute): 11:15:12.519798 => 11:15:12.519813
[0m11:15:12.523012 [debug] [Thread-2 (]: Finished running node model.superstore_project.mart_orders_summary_by_region
[0m11:15:12.525743 [debug] [Thread-3 (]: Began running node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:15:12.527920 [debug] [Thread-1 (]: Finished running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:15:12.533289 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.monthly_returns_trend, now test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028)
[0m11:15:12.538783 [debug] [Thread-3 (]: Began compiling node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:15:12.624098 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028"
[0m11:15:12.667387 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028 (compile): 11:15:12.541713 => 11:15:12.666438
[0m11:15:12.674309 [debug] [Thread-3 (]: Began executing node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:15:12.678772 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028 (execute): 11:15:12.678227 => 11:15:12.678249
[0m11:15:12.686615 [debug] [Thread-3 (]: Finished running node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:15:12.699498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:12.707129 [debug] [MainThread]: Connection 'model.superstore_project.mart_orders_summary_by_region' was properly closed.
[0m11:15:12.713980 [debug] [MainThread]: Connection 'test.superstore_project.not_null_stg_users_region.97049f06a2' was properly closed.
[0m11:15:12.720868 [debug] [MainThread]: Connection 'test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028' was properly closed.
[0m11:15:12.727430 [debug] [MainThread]: Connection 'model.superstore_project.final_orders_with_returns' was properly closed.
[0m11:15:12.744443 [debug] [MainThread]: Command end result
[0m11:15:12.980343 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m11:15:12.982821 [info ] [MainThread]: Building catalog
[0m11:15:12.995364 [debug] [ThreadPool]: Acquiring new postgres connection 'postgres_metabase1.information_schema'
[0m11:15:13.019479 [debug] [ThreadPool]: Using postgres connection "postgres_metabase1.information_schema"
[0m11:15:13.023024 [debug] [ThreadPool]: On postgres_metabase1.information_schema: BEGIN
[0m11:15:13.026070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:13.042068 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:15:13.047002 [debug] [ThreadPool]: Using postgres connection "postgres_metabase1.information_schema"
[0m11:15:13.052050 [debug] [ThreadPool]: On postgres_metabase1.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "postgres_metabase1.information_schema"} */

    
    

    select
        'postgres_metabase1' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('_staging') and
           upper(tbl.relname) = upper('stg_returns')) or (upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('mart_orders_summary_by_region')) or (upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('top_customers')) or (upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('monthly_returns_trend')) or (upper(sch.nspname) = upper('_staging') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('product_performance')) or (upper(sch.nspname) = upper('_staging') and
           upper(tbl.relname) = upper('stg_users')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('managers')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('final_orders_with_returns')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('returns')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m11:15:13.065961 [debug] [ThreadPool]: SQL status: SELECT 108 in 0.0 seconds
[0m11:15:13.091538 [debug] [ThreadPool]: On postgres_metabase1.information_schema: ROLLBACK
[0m11:15:13.096767 [debug] [ThreadPool]: On postgres_metabase1.information_schema: Close
[0m11:15:13.222676 [info ] [MainThread]: Catalog written to /usr/app/target/catalog.json
[0m11:15:13.235796 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.1254144, "process_user_time": 2.946527, "process_kernel_time": 0.40879, "process_mem_max_rss": "104128", "process_in_blocks": "83816", "process_out_blocks": "0"}
[0m11:15:13.242858 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:15:13.242699 after 5.13 seconds
[0m11:15:13.246541 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:15:13.249271 [debug] [MainThread]: Connection 'postgres_metabase1.information_schema' was properly closed.
[0m11:15:13.251747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8725ad2740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c8725395570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c87221862c0>]}
[0m11:15:13.253938 [debug] [MainThread]: Flushing usage events
[0m11:15:16.288045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9a6856c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9a4a860e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9a4a86080>]}


============================== 11:15:16.303277 | a92af328-bc57-4cc2-a42e-f7ab8a589d65 ==============================
[0m11:15:16.303277 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:15:16.306879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:15:16.671774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a92af328-bc57-4cc2-a42e-f7ab8a589d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9a4a861d0>]}
[0m11:15:16.757080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a92af328-bc57-4cc2-a42e-f7ab8a589d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9a3039240>]}
[0m11:22:21.052560 [error] [MainThread]: Encountered an error:

[0m11:22:21.079081 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m11:22:21.086173 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 414.04617, "process_user_time": 2.093499, "process_kernel_time": 0.126368, "process_mem_max_rss": "95328", "process_in_blocks": "344", "command_success": false, "process_out_blocks": "0"}
[0m11:22:21.089022 [debug] [MainThread]: Command `dbt docs serve` failed at 11:22:21.088747 after 414.05 seconds
[0m11:22:21.092008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9a6856c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9a30395a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9a303a740>]}
[0m11:22:21.096831 [debug] [MainThread]: Flushing usage events
[0m11:22:57.214206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba93ff9f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba940776fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba93e258c10>]}


============================== 11:22:57.230587 | 40fc6b36-9104-42fd-b03f-b79b20ee6570 ==============================
[0m11:22:57.230587 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:22:57.235332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:22:57.758882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40fc6b36-9104-42fd-b03f-b79b20ee6570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba940776fb0>]}
[0m11:22:57.931353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40fc6b36-9104-42fd-b03f-b79b20ee6570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba93c9949d0>]}
[0m11:22:57.937652 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m11:22:57.975033 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:22:58.497270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:58.504169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:58.513991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40fc6b36-9104-42fd-b03f-b79b20ee6570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba93c5480d0>]}
[0m11:22:58.571142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40fc6b36-9104-42fd-b03f-b79b20ee6570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba93c711a20>]}
[0m11:22:58.576319 [info ] [MainThread]: Found 8 models, 7 tests, 3 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:22:58.579692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40fc6b36-9104-42fd-b03f-b79b20ee6570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba93c711ab0>]}
[0m11:22:58.585799 [info ] [MainThread]: 
[0m11:22:58.589158 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:22:58.594365 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1__analytics'
[0m11:22:58.596054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1__staging'
[0m11:22:58.611611 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__analytics"
[0m11:22:58.615335 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__staging"
[0m11:22:58.618558 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: BEGIN
[0m11:22:58.622392 [debug] [ThreadPool]: On list_postgres_metabase1__staging: BEGIN
[0m11:22:58.625607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:58.628050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:58.655986 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:22:58.656629 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:22:58.658999 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__staging"
[0m11:22:58.662266 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__analytics"
[0m11:22:58.665358 [debug] [ThreadPool]: On list_postgres_metabase1__staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1__staging"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m11:22:58.669395 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1__analytics"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m11:22:58.684835 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m11:22:58.685525 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:22:58.690181 [debug] [ThreadPool]: On list_postgres_metabase1__staging: ROLLBACK
[0m11:22:58.694348 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: ROLLBACK
[0m11:22:58.699556 [debug] [ThreadPool]: On list_postgres_metabase1__staging: Close
[0m11:22:58.702666 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: Close
[0m11:22:58.716807 [debug] [MainThread]: Using postgres connection "master"
[0m11:22:58.720598 [debug] [MainThread]: On master: BEGIN
[0m11:22:58.724335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:22:58.736935 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:22:58.740860 [debug] [MainThread]: Using postgres connection "master"
[0m11:22:58.744286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:22:58.762715 [debug] [MainThread]: SQL status: SELECT 47 in 0.0 seconds
[0m11:22:58.767124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40fc6b36-9104-42fd-b03f-b79b20ee6570', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba93c57f160>]}
[0m11:22:58.769706 [debug] [MainThread]: On master: ROLLBACK
[0m11:22:58.772184 [debug] [MainThread]: On master: Close
[0m11:22:58.776842 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:22:58.780622 [info ] [MainThread]: 
[0m11:22:58.794291 [debug] [Thread-1 (]: Began running node model.superstore_project.stg_orders
[0m11:22:58.795060 [debug] [Thread-2 (]: Began running node model.superstore_project.stg_returns
[0m11:22:58.795595 [debug] [Thread-3 (]: Began running node model.superstore_project.stg_users
[0m11:22:58.802240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1__analytics, now model.superstore_project.stg_orders)
[0m11:22:58.804987 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1__staging, now model.superstore_project.stg_returns)
[0m11:22:58.807578 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_project.stg_users'
[0m11:22:58.809260 [debug] [Thread-1 (]: Began compiling node model.superstore_project.stg_orders
[0m11:22:58.811232 [debug] [Thread-2 (]: Began compiling node model.superstore_project.stg_returns
[0m11:22:58.813677 [debug] [Thread-3 (]: Began compiling node model.superstore_project.stg_users
[0m11:22:58.824516 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.stg_orders"
[0m11:22:58.830404 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.stg_returns"
[0m11:22:58.837439 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.stg_users"
[0m11:22:58.859676 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (compile): 11:22:58.834581 => 11:22:58.859244
[0m11:22:58.865429 [debug] [Thread-3 (]: Began executing node model.superstore_project.stg_users
[0m11:22:58.866087 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (compile): 11:22:58.816122 => 11:22:58.865807
[0m11:22:58.871016 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (execute): 11:22:58.870725 => 11:22:58.870747
[0m11:22:58.872730 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (compile): 11:22:58.827412 => 11:22:58.872457
[0m11:22:58.875897 [debug] [Thread-1 (]: Began executing node model.superstore_project.stg_orders
[0m11:22:58.880000 [debug] [Thread-3 (]: Finished running node model.superstore_project.stg_users
[0m11:22:58.884823 [debug] [Thread-2 (]: Began executing node model.superstore_project.stg_returns
[0m11:22:58.887605 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (execute): 11:22:58.887340 => 11:22:58.887355
[0m11:22:58.891508 [debug] [Thread-4 (]: Began running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:22:58.893664 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (execute): 11:22:58.893391 => 11:22:58.893406
[0m11:22:58.897803 [debug] [Thread-1 (]: Finished running node model.superstore_project.stg_orders
[0m11:22:58.901061 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.superstore_project.not_null_stg_users_region.97049f06a2'
[0m11:22:58.904028 [debug] [Thread-2 (]: Finished running node model.superstore_project.stg_returns
[0m11:22:58.906127 [debug] [Thread-3 (]: Began running node model.superstore_project.product_performance
[0m11:22:58.906557 [debug] [Thread-1 (]: Began running node model.superstore_project.top_customers
[0m11:22:58.907591 [debug] [Thread-4 (]: Began compiling node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:22:58.910050 [debug] [Thread-2 (]: Began running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:22:58.911937 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_users, now model.superstore_project.product_performance)
[0m11:22:58.913873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_orders, now model.superstore_project.top_customers)
[0m11:22:58.928014 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m11:22:58.938838 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_returns, now test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m11:22:58.945709 [debug] [Thread-3 (]: Began compiling node model.superstore_project.product_performance
[0m11:22:58.952879 [debug] [Thread-1 (]: Began compiling node model.superstore_project.top_customers
[0m11:22:58.963412 [debug] [Thread-2 (]: Began compiling node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:22:58.970391 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.product_performance"
[0m11:22:58.979865 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.top_customers"
[0m11:22:58.987062 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:22:58.997376 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (compile): 11:22:58.915423 => 11:22:58.996986
[0m11:22:59.001642 [debug] [Thread-4 (]: Began executing node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:22:59.004906 [debug] [Thread-3 (]: Timing info for model.superstore_project.product_performance (compile): 11:22:58.967685 => 11:22:59.004615
[0m11:22:59.005478 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (execute): 11:22:59.005184 => 11:22:59.005199
[0m11:22:59.010936 [debug] [Thread-1 (]: Timing info for model.superstore_project.top_customers (compile): 11:22:58.975596 => 11:22:59.010622
[0m11:22:59.011419 [debug] [Thread-3 (]: Began executing node model.superstore_project.product_performance
[0m11:22:59.014811 [debug] [Thread-4 (]: Finished running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:22:59.017472 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (compile): 11:22:58.983306 => 11:22:59.017155
[0m11:22:59.017909 [debug] [Thread-1 (]: Began executing node model.superstore_project.top_customers
[0m11:22:59.020533 [debug] [Thread-3 (]: Timing info for model.superstore_project.product_performance (execute): 11:22:59.020292 => 11:22:59.020305
[0m11:22:59.022947 [debug] [Thread-4 (]: Began running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:22:59.025903 [debug] [Thread-2 (]: Began executing node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:22:59.028964 [debug] [Thread-1 (]: Timing info for model.superstore_project.top_customers (execute): 11:22:59.028739 => 11:22:59.028750
[0m11:22:59.032211 [debug] [Thread-3 (]: Finished running node model.superstore_project.product_performance
[0m11:22:59.034892 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_users_region.97049f06a2, now test.superstore_project.not_null_stg_orders_region.c7b18a6907)
[0m11:22:59.038068 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (execute): 11:22:59.037824 => 11:22:59.037836
[0m11:22:59.041310 [debug] [Thread-1 (]: Finished running node model.superstore_project.top_customers
[0m11:22:59.044019 [debug] [Thread-3 (]: Began running node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:22:59.046393 [debug] [Thread-4 (]: Began compiling node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:22:59.048977 [debug] [Thread-2 (]: Finished running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:22:59.050588 [debug] [Thread-1 (]: Began running node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:22:59.052127 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.product_performance, now test.superstore_project.not_null_stg_orders_row_id.6258f0907f)
[0m11:22:59.058143 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m11:22:59.059911 [debug] [Thread-2 (]: Began running node model.superstore_project.final_orders_with_returns
[0m11:22:59.062685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_project.top_customers, now test.superstore_project.unique_stg_orders_row_id.71d19f9f6d)
[0m11:22:59.064280 [debug] [Thread-3 (]: Began compiling node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:22:59.072357 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64, now model.superstore_project.final_orders_with_returns)
[0m11:22:59.073910 [debug] [Thread-1 (]: Began compiling node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:22:59.079506 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_row_id.6258f0907f"
[0m11:22:59.081419 [debug] [Thread-2 (]: Began compiling node model.superstore_project.final_orders_with_returns
[0m11:22:59.088189 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (compile): 11:22:59.054029 => 11:22:59.087892
[0m11:22:59.089645 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.unique_stg_orders_row_id.71d19f9f6d"
[0m11:22:59.094773 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.final_orders_with_returns"
[0m11:22:59.096164 [debug] [Thread-4 (]: Began executing node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:22:59.099326 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (execute): 11:22:59.099063 => 11:22:59.099079
[0m11:22:59.101411 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_orders_row_id.6258f0907f (compile): 11:22:59.075456 => 11:22:59.101099
[0m11:22:59.102377 [debug] [Thread-4 (]: Finished running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:22:59.103177 [debug] [Thread-1 (]: Timing info for test.superstore_project.unique_stg_orders_row_id.71d19f9f6d (compile): 11:22:59.082726 => 11:22:59.102921
[0m11:22:59.104758 [debug] [Thread-3 (]: Began executing node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:22:59.114939 [debug] [Thread-4 (]: Began running node model.superstore_project.mart_orders_summary_by_region
[0m11:22:59.115697 [debug] [Thread-2 (]: Timing info for model.superstore_project.final_orders_with_returns (compile): 11:22:59.091656 => 11:22:59.115399
[0m11:22:59.138293 [debug] [Thread-1 (]: Began executing node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:22:59.147497 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_orders_row_id.6258f0907f (execute): 11:22:59.147226 => 11:22:59.147242
[0m11:22:59.155688 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_region.c7b18a6907, now model.superstore_project.mart_orders_summary_by_region)
[0m11:22:59.164365 [debug] [Thread-2 (]: Began executing node model.superstore_project.final_orders_with_returns
[0m11:22:59.171164 [debug] [Thread-1 (]: Timing info for test.superstore_project.unique_stg_orders_row_id.71d19f9f6d (execute): 11:22:59.170911 => 11:22:59.170927
[0m11:22:59.182353 [debug] [Thread-3 (]: Finished running node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:22:59.184481 [debug] [Thread-4 (]: Began compiling node model.superstore_project.mart_orders_summary_by_region
[0m11:22:59.186281 [debug] [Thread-2 (]: Timing info for model.superstore_project.final_orders_with_returns (execute): 11:22:59.186049 => 11:22:59.186062
[0m11:22:59.188907 [debug] [Thread-1 (]: Finished running node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:22:59.191143 [debug] [Thread-3 (]: Began running node model.superstore_project.monthly_returns_trend
[0m11:22:59.196285 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.mart_orders_summary_by_region"
[0m11:22:59.201557 [debug] [Thread-2 (]: Finished running node model.superstore_project.final_orders_with_returns
[0m11:22:59.206885 [debug] [Thread-1 (]: Began running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:22:59.212072 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_row_id.6258f0907f, now model.superstore_project.monthly_returns_trend)
[0m11:22:59.218317 [debug] [Thread-2 (]: Began running node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:22:59.224206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_project.unique_stg_orders_row_id.71d19f9f6d, now test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e)
[0m11:22:59.228199 [debug] [Thread-3 (]: Began compiling node model.superstore_project.monthly_returns_trend
[0m11:22:59.231436 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.final_orders_with_returns, now test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028)
[0m11:22:59.234533 [debug] [Thread-1 (]: Began compiling node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:22:59.239665 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.monthly_returns_trend"
[0m11:22:59.243113 [debug] [Thread-2 (]: Began compiling node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:22:59.244205 [debug] [Thread-4 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (compile): 11:22:59.193643 => 11:22:59.243828
[0m11:22:59.253670 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m11:22:59.302256 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028"
[0m11:22:59.304789 [debug] [Thread-4 (]: Began executing node model.superstore_project.mart_orders_summary_by_region
[0m11:22:59.328598 [debug] [Thread-4 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (execute): 11:22:59.328229 => 11:22:59.328252
[0m11:22:59.336656 [debug] [Thread-4 (]: Finished running node model.superstore_project.mart_orders_summary_by_region
[0m11:22:59.341578 [debug] [Thread-3 (]: Timing info for model.superstore_project.monthly_returns_trend (compile): 11:22:59.236871 => 11:22:59.341237
[0m11:22:59.343153 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (compile): 11:22:59.246116 => 11:22:59.342895
[0m11:22:59.347892 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028 (compile): 11:22:59.257913 => 11:22:59.347601
[0m11:22:59.348374 [debug] [Thread-3 (]: Began executing node model.superstore_project.monthly_returns_trend
[0m11:22:59.359327 [debug] [Thread-1 (]: Began executing node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:22:59.369500 [debug] [Thread-2 (]: Began executing node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:22:59.373051 [debug] [Thread-3 (]: Timing info for model.superstore_project.monthly_returns_trend (execute): 11:22:59.372769 => 11:22:59.372784
[0m11:22:59.376070 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (execute): 11:22:59.375832 => 11:22:59.375845
[0m11:22:59.381612 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028 (execute): 11:22:59.381297 => 11:22:59.381337
[0m11:22:59.388738 [debug] [Thread-3 (]: Finished running node model.superstore_project.monthly_returns_trend
[0m11:22:59.393136 [debug] [Thread-1 (]: Finished running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:22:59.396667 [debug] [Thread-2 (]: Finished running node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:22:59.407443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:59.410256 [debug] [MainThread]: Connection 'test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e' was properly closed.
[0m11:22:59.413929 [debug] [MainThread]: Connection 'test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028' was properly closed.
[0m11:22:59.417676 [debug] [MainThread]: Connection 'model.superstore_project.monthly_returns_trend' was properly closed.
[0m11:22:59.421270 [debug] [MainThread]: Connection 'model.superstore_project.mart_orders_summary_by_region' was properly closed.
[0m11:22:59.426583 [debug] [MainThread]: Command end result
[0m11:22:59.548652 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m11:22:59.551708 [info ] [MainThread]: Building catalog
[0m11:22:59.556119 [debug] [ThreadPool]: Acquiring new postgres connection 'postgres_metabase1.information_schema'
[0m11:22:59.568176 [debug] [ThreadPool]: Using postgres connection "postgres_metabase1.information_schema"
[0m11:22:59.571124 [debug] [ThreadPool]: On postgres_metabase1.information_schema: BEGIN
[0m11:22:59.573812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:59.585391 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:22:59.588307 [debug] [ThreadPool]: Using postgres connection "postgres_metabase1.information_schema"
[0m11:22:59.591328 [debug] [ThreadPool]: On postgres_metabase1.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "postgres_metabase1.information_schema"} */

    
    

    select
        'postgres_metabase1' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('managers')) or (upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('mart_orders_summary_by_region')) or (upper(sch.nspname) = upper('_staging') and
           upper(tbl.relname) = upper('stg_users')) or (upper(sch.nspname) = upper('_staging') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('product_performance')) or (upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('final_orders_with_returns')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('monthly_returns_trend')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('returns')) or (upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('top_customers')) or (upper(sch.nspname) = upper('_staging') and
           upper(tbl.relname) = upper('stg_returns')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m11:22:59.614089 [debug] [ThreadPool]: SQL status: SELECT 108 in 0.0 seconds
[0m11:22:59.626381 [debug] [ThreadPool]: On postgres_metabase1.information_schema: ROLLBACK
[0m11:22:59.629924 [debug] [ThreadPool]: On postgres_metabase1.information_schema: Close
[0m11:22:59.695983 [info ] [MainThread]: Catalog written to /usr/app/target/catalog.json
[0m11:22:59.699274 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.5989995, "process_user_time": 3.996596, "process_kernel_time": 0.403402, "process_mem_max_rss": "104184", "process_in_blocks": "50992", "process_out_blocks": "664"}
[0m11:22:59.702480 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:22:59.702275 after 2.60 seconds
[0m11:22:59.705358 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:22:59.707867 [debug] [MainThread]: Connection 'postgres_metabase1.information_schema' was properly closed.
[0m11:22:59.710243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba93ff9f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba93e259090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba93c9949d0>]}
[0m11:22:59.713031 [debug] [MainThread]: Flushing usage events
[0m11:25:20.870359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac71ead6740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac71cd46170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac71cd46110>]}


============================== 11:25:20.876756 | 5ce86c0a-4006-4654-8643-08870bc676bb ==============================
[0m11:25:20.876756 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:25:20.878700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8080', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:25:21.110197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ce86c0a-4006-4654-8643-08870bc676bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac71cd46260>]}
[0m11:25:21.198000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ce86c0a-4006-4654-8643-08870bc676bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac71cd459f0>]}
[0m11:27:13.933332 [error] [MainThread]: Encountered an error:

[0m11:27:13.949347 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m11:27:13.958552 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 110.04523, "process_user_time": 2.021286, "process_kernel_time": 0.146198, "process_mem_max_rss": "95172", "process_in_blocks": "832", "command_success": false, "process_out_blocks": "0"}
[0m11:27:13.964350 [debug] [MainThread]: Command `dbt docs serve` failed at 11:27:13.964116 after 110.05 seconds
[0m11:27:13.967997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac71ead6740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac71b2f40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac71b2f6bf0>]}
[0m11:27:13.970395 [debug] [MainThread]: Flushing usage events
[0m11:56:46.546099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784271a78850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78426fcaa170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78426fcaa110>]}


============================== 11:56:46.553564 | e126f72e-ef1a-4a1b-8700-9312c49d57d5 ==============================
[0m11:56:46.553564 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:56:46.557702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/profiles', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:56:47.092315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e126f72e-ef1a-4a1b-8700-9312c49d57d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78426fdefee0>]}
[0m11:56:47.176444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e126f72e-ef1a-4a1b-8700-9312c49d57d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78426fcabeb0>]}
[0m11:56:47.184965 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m11:56:47.223015 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m11:56:47.740699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 7 files changed.
[0m11:56:47.742642 [debug] [MainThread]: Partial parsing: added file: superstore_project://models/exposures.yml
[0m11:56:47.744946 [debug] [MainThread]: Partial parsing: updated file: superstore_project://models/sources.yml
[0m11:56:47.746918 [debug] [MainThread]: Partial parsing: updated file: superstore_project://models/schema.yml
[0m11:56:47.748240 [debug] [MainThread]: Partial parsing: updated file: superstore_project://models/marts/final_orders_with_returns.sql
[0m11:56:47.749666 [debug] [MainThread]: Partial parsing: updated file: superstore_project://models/marts/product_performance.sql
[0m11:56:47.751017 [debug] [MainThread]: Partial parsing: updated file: superstore_project://models/marts/mart_orders_summary_by_region.sql
[0m11:56:47.752245 [debug] [MainThread]: Partial parsing: updated file: superstore_project://models/marts/monthly_returns_trend.sql
[0m11:56:47.753619 [debug] [MainThread]: Partial parsing: updated file: superstore_project://models/marts/top_customers.sql
[0m11:56:48.201253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e126f72e-ef1a-4a1b-8700-9312c49d57d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7842475828c0>]}
[0m11:56:48.248433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e126f72e-ef1a-4a1b-8700-9312c49d57d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78426e22d5d0>]}
[0m11:56:48.255302 [info ] [MainThread]: Found 8 models, 8 tests, 3 sources, 1 exposure, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:56:48.259362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e126f72e-ef1a-4a1b-8700-9312c49d57d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78426e22d660>]}
[0m11:56:48.266309 [info ] [MainThread]: 
[0m11:56:48.271175 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:56:48.277246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1__staging'
[0m11:56:48.278893 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1__analytics'
[0m11:56:48.305076 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__staging"
[0m11:56:48.306967 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__analytics"
[0m11:56:48.311914 [debug] [ThreadPool]: On list_postgres_metabase1__staging: BEGIN
[0m11:56:48.316940 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: BEGIN
[0m11:56:48.320066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:48.322795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:48.383641 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:56:48.385727 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:56:48.390019 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__analytics"
[0m11:56:48.392883 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__staging"
[0m11:56:48.396727 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1__analytics"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m11:56:48.399444 [debug] [ThreadPool]: On list_postgres_metabase1__staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1__staging"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m11:56:48.419062 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:56:48.422006 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m11:56:48.433793 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: ROLLBACK
[0m11:56:48.443925 [debug] [ThreadPool]: On list_postgres_metabase1__staging: ROLLBACK
[0m11:56:48.451224 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: Close
[0m11:56:48.455426 [debug] [ThreadPool]: On list_postgres_metabase1__staging: Close
[0m11:56:48.471915 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:48.473983 [debug] [MainThread]: On master: BEGIN
[0m11:56:48.475804 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:56:48.482619 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:56:48.484357 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:48.486278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:56:48.494054 [debug] [MainThread]: SQL status: SELECT 47 in 0.0 seconds
[0m11:56:48.497099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e126f72e-ef1a-4a1b-8700-9312c49d57d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78426e20bbe0>]}
[0m11:56:48.498712 [debug] [MainThread]: On master: ROLLBACK
[0m11:56:48.500376 [debug] [MainThread]: On master: Close
[0m11:56:48.502297 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:56:48.504314 [info ] [MainThread]: 
[0m11:56:48.510576 [debug] [Thread-1 (]: Began running node model.superstore_project.stg_orders
[0m11:56:48.511136 [debug] [Thread-2 (]: Began running node model.superstore_project.stg_returns
[0m11:56:48.511527 [debug] [Thread-3 (]: Began running node model.superstore_project.stg_users
[0m11:56:48.512923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1__staging, now model.superstore_project.stg_orders)
[0m11:56:48.515027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1__analytics, now model.superstore_project.stg_returns)
[0m11:56:48.517388 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_project.stg_users'
[0m11:56:48.519267 [debug] [Thread-1 (]: Began compiling node model.superstore_project.stg_orders
[0m11:56:48.521104 [debug] [Thread-2 (]: Began compiling node model.superstore_project.stg_returns
[0m11:56:48.522808 [debug] [Thread-3 (]: Began compiling node model.superstore_project.stg_users
[0m11:56:48.530615 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.stg_orders"
[0m11:56:48.533926 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.stg_returns"
[0m11:56:48.538452 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.stg_users"
[0m11:56:48.549085 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (compile): 11:56:48.524269 => 11:56:48.548819
[0m11:56:48.549916 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (compile): 11:56:48.535461 => 11:56:48.549672
[0m11:56:48.550734 [debug] [Thread-1 (]: Began executing node model.superstore_project.stg_orders
[0m11:56:48.552019 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (compile): 11:56:48.531851 => 11:56:48.551721
[0m11:56:48.552376 [debug] [Thread-3 (]: Began executing node model.superstore_project.stg_users
[0m11:56:48.553786 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (execute): 11:56:48.553569 => 11:56:48.553586
[0m11:56:48.554846 [debug] [Thread-2 (]: Began executing node model.superstore_project.stg_returns
[0m11:56:48.556236 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (execute): 11:56:48.555978 => 11:56:48.555988
[0m11:56:48.557960 [debug] [Thread-1 (]: Finished running node model.superstore_project.stg_orders
[0m11:56:48.559100 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (execute): 11:56:48.558884 => 11:56:48.558893
[0m11:56:48.560779 [debug] [Thread-3 (]: Finished running node model.superstore_project.stg_users
[0m11:56:48.562499 [debug] [Thread-4 (]: Began running node model.superstore_project.product_performance
[0m11:56:48.562862 [debug] [Thread-1 (]: Began running node model.superstore_project.top_customers
[0m11:56:48.564358 [debug] [Thread-2 (]: Finished running node model.superstore_project.stg_returns
[0m11:56:48.565662 [debug] [Thread-3 (]: Began running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:56:48.567275 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_project.product_performance'
[0m11:56:48.568730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_orders, now model.superstore_project.top_customers)
[0m11:56:48.570045 [debug] [Thread-2 (]: Began running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:56:48.571240 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_users, now test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m11:56:48.572470 [debug] [Thread-4 (]: Began compiling node model.superstore_project.product_performance
[0m11:56:48.573606 [debug] [Thread-1 (]: Began compiling node model.superstore_project.top_customers
[0m11:56:48.574890 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_returns, now test.superstore_project.not_null_stg_orders_region.c7b18a6907)
[0m11:56:48.576196 [debug] [Thread-3 (]: Began compiling node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:56:48.580193 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.product_performance"
[0m11:56:48.583913 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.top_customers"
[0m11:56:48.585196 [debug] [Thread-2 (]: Began compiling node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:56:48.593546 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m11:56:48.599985 [debug] [Thread-2 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_region.c7b18a6907"
[0m11:56:48.606337 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (compile): 11:56:48.586227 => 11:56:48.606059
[0m11:56:48.606851 [debug] [Thread-4 (]: Timing info for model.superstore_project.product_performance (compile): 11:56:48.577349 => 11:56:48.606597
[0m11:56:48.609355 [debug] [Thread-1 (]: Timing info for model.superstore_project.top_customers (compile): 11:56:48.581251 => 11:56:48.609116
[0m11:56:48.609742 [debug] [Thread-3 (]: Began executing node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:56:48.610942 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (compile): 11:56:48.596180 => 11:56:48.610709
[0m11:56:48.615051 [debug] [Thread-4 (]: Began executing node model.superstore_project.product_performance
[0m11:56:48.622093 [debug] [Thread-1 (]: Began executing node model.superstore_project.top_customers
[0m11:56:48.628767 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64 (execute): 11:56:48.628390 => 11:56:48.628420
[0m11:56:48.637587 [debug] [Thread-2 (]: Began executing node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:56:48.640558 [debug] [Thread-4 (]: Timing info for model.superstore_project.product_performance (execute): 11:56:48.640289 => 11:56:48.640305
[0m11:56:48.642786 [debug] [Thread-1 (]: Timing info for model.superstore_project.top_customers (execute): 11:56:48.642528 => 11:56:48.642540
[0m11:56:48.645304 [debug] [Thread-3 (]: Finished running node test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64
[0m11:56:48.647256 [debug] [Thread-2 (]: Timing info for test.superstore_project.not_null_stg_orders_region.c7b18a6907 (execute): 11:56:48.647044 => 11:56:48.647054
[0m11:56:48.650640 [debug] [Thread-4 (]: Finished running node model.superstore_project.product_performance
[0m11:56:48.654757 [debug] [Thread-1 (]: Finished running node model.superstore_project.top_customers
[0m11:56:48.656850 [debug] [Thread-3 (]: Began running node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:56:48.659184 [debug] [Thread-2 (]: Finished running node test.superstore_project.not_null_stg_orders_region.c7b18a6907
[0m11:56:48.660894 [debug] [Thread-4 (]: Began running node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:56:48.662564 [debug] [Thread-1 (]: Began running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:56:48.664493 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_order_id.81cfe2fe64, now test.superstore_project.not_null_stg_orders_row_id.6258f0907f)
[0m11:56:48.666231 [debug] [Thread-2 (]: Began running node model.superstore_project.final_orders_with_returns
[0m11:56:48.668786 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.superstore_project.product_performance, now test.superstore_project.unique_stg_orders_row_id.71d19f9f6d)
[0m11:56:48.670788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_project.top_customers, now test.superstore_project.not_null_stg_users_region.97049f06a2)
[0m11:56:48.672507 [debug] [Thread-3 (]: Began compiling node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:56:48.674343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_region.c7b18a6907, now model.superstore_project.final_orders_with_returns)
[0m11:56:48.675959 [debug] [Thread-4 (]: Began compiling node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:56:48.677718 [debug] [Thread-1 (]: Began compiling node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:56:48.682791 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_orders_row_id.6258f0907f"
[0m11:56:48.684930 [debug] [Thread-2 (]: Began compiling node model.superstore_project.final_orders_with_returns
[0m11:56:48.692044 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_project.unique_stg_orders_row_id.71d19f9f6d"
[0m11:56:48.697145 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_users_region.97049f06a2"
[0m11:56:48.705735 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.final_orders_with_returns"
[0m11:56:48.723558 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_orders_row_id.6258f0907f (compile): 11:56:48.679318 => 11:56:48.723322
[0m11:56:48.724045 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (compile): 11:56:48.693235 => 11:56:48.723760
[0m11:56:48.725829 [debug] [Thread-3 (]: Began executing node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:56:48.734435 [debug] [Thread-4 (]: Timing info for test.superstore_project.unique_stg_orders_row_id.71d19f9f6d (compile): 11:56:48.686460 => 11:56:48.734163
[0m11:56:48.736796 [debug] [Thread-1 (]: Began executing node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:56:48.743515 [debug] [Thread-2 (]: Timing info for model.superstore_project.final_orders_with_returns (compile): 11:56:48.702753 => 11:56:48.743290
[0m11:56:48.744063 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_stg_orders_row_id.6258f0907f (execute): 11:56:48.743765 => 11:56:48.743780
[0m11:56:48.767340 [debug] [Thread-4 (]: Began executing node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:56:48.769888 [debug] [Thread-1 (]: Timing info for test.superstore_project.not_null_stg_users_region.97049f06a2 (execute): 11:56:48.769529 => 11:56:48.769548
[0m11:56:48.773241 [debug] [Thread-2 (]: Began executing node model.superstore_project.final_orders_with_returns
[0m11:56:48.779787 [debug] [Thread-3 (]: Finished running node test.superstore_project.not_null_stg_orders_row_id.6258f0907f
[0m11:56:48.783803 [debug] [Thread-4 (]: Timing info for test.superstore_project.unique_stg_orders_row_id.71d19f9f6d (execute): 11:56:48.783433 => 11:56:48.783474
[0m11:56:48.787093 [debug] [Thread-1 (]: Finished running node test.superstore_project.not_null_stg_users_region.97049f06a2
[0m11:56:48.792279 [debug] [Thread-2 (]: Timing info for model.superstore_project.final_orders_with_returns (execute): 11:56:48.791289 => 11:56:48.791323
[0m11:56:48.797190 [debug] [Thread-3 (]: Began running node model.superstore_project.monthly_returns_trend
[0m11:56:48.807342 [debug] [Thread-4 (]: Finished running node test.superstore_project.unique_stg_orders_row_id.71d19f9f6d
[0m11:56:48.815611 [debug] [Thread-1 (]: Began running node test.superstore_project.accepted_values_stg_returns_status__Returned__Not_Returned.c79e20e435
[0m11:56:48.822886 [debug] [Thread-2 (]: Finished running node model.superstore_project.final_orders_with_returns
[0m11:56:48.828959 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_orders_row_id.6258f0907f, now model.superstore_project.monthly_returns_trend)
[0m11:56:48.834218 [debug] [Thread-4 (]: Began running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:56:48.838773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.superstore_project.not_null_stg_users_region.97049f06a2, now test.superstore_project.accepted_values_stg_returns_status__Returned__Not_Returned.c79e20e435)
[0m11:56:48.847020 [debug] [Thread-2 (]: Began running node model.superstore_project.mart_orders_summary_by_region
[0m11:56:48.849676 [debug] [Thread-3 (]: Began compiling node model.superstore_project.monthly_returns_trend
[0m11:56:48.854418 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.superstore_project.unique_stg_orders_row_id.71d19f9f6d, now test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e)
[0m11:56:48.856768 [debug] [Thread-1 (]: Began compiling node test.superstore_project.accepted_values_stg_returns_status__Returned__Not_Returned.c79e20e435
[0m11:56:48.859232 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.final_orders_with_returns, now model.superstore_project.mart_orders_summary_by_region)
[0m11:56:48.866916 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.monthly_returns_trend"
[0m11:56:48.869892 [debug] [Thread-4 (]: Began compiling node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:56:48.876383 [debug] [Thread-1 (]: Writing injected SQL for node "test.superstore_project.accepted_values_stg_returns_status__Returned__Not_Returned.c79e20e435"
[0m11:56:48.882247 [debug] [Thread-2 (]: Began compiling node model.superstore_project.mart_orders_summary_by_region
[0m11:56:48.894002 [debug] [Thread-4 (]: Writing injected SQL for node "test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e"
[0m11:56:48.905616 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.mart_orders_summary_by_region"
[0m11:56:48.922852 [debug] [Thread-3 (]: Timing info for model.superstore_project.monthly_returns_trend (compile): 11:56:48.862870 => 11:56:48.921974
[0m11:56:48.929916 [debug] [Thread-3 (]: Began executing node model.superstore_project.monthly_returns_trend
[0m11:56:48.932524 [debug] [Thread-1 (]: Timing info for test.superstore_project.accepted_values_stg_returns_status__Returned__Not_Returned.c79e20e435 (compile): 11:56:48.872218 => 11:56:48.932023
[0m11:56:48.937195 [debug] [Thread-3 (]: Timing info for model.superstore_project.monthly_returns_trend (execute): 11:56:48.936937 => 11:56:48.936953
[0m11:56:48.938500 [debug] [Thread-2 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (compile): 11:56:48.898564 => 11:56:48.938257
[0m11:56:48.942160 [debug] [Thread-1 (]: Began executing node test.superstore_project.accepted_values_stg_returns_status__Returned__Not_Returned.c79e20e435
[0m11:56:48.943759 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (compile): 11:56:48.889858 => 11:56:48.943561
[0m11:56:48.949896 [debug] [Thread-3 (]: Finished running node model.superstore_project.monthly_returns_trend
[0m11:56:48.953897 [debug] [Thread-2 (]: Began executing node model.superstore_project.mart_orders_summary_by_region
[0m11:56:48.957138 [debug] [Thread-1 (]: Timing info for test.superstore_project.accepted_values_stg_returns_status__Returned__Not_Returned.c79e20e435 (execute): 11:56:48.956888 => 11:56:48.956901
[0m11:56:48.960266 [debug] [Thread-4 (]: Began executing node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:56:48.964142 [debug] [Thread-3 (]: Began running node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:56:48.966932 [debug] [Thread-2 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (execute): 11:56:48.966572 => 11:56:48.966597
[0m11:56:48.972676 [debug] [Thread-1 (]: Finished running node test.superstore_project.accepted_values_stg_returns_status__Returned__Not_Returned.c79e20e435
[0m11:56:48.976069 [debug] [Thread-4 (]: Timing info for test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e (execute): 11:56:48.975767 => 11:56:48.975782
[0m11:56:48.978294 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.monthly_returns_trend, now test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028)
[0m11:56:48.983744 [debug] [Thread-2 (]: Finished running node model.superstore_project.mart_orders_summary_by_region
[0m11:56:48.992180 [debug] [Thread-4 (]: Finished running node test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e
[0m11:56:48.994425 [debug] [Thread-3 (]: Began compiling node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:56:49.006372 [debug] [Thread-3 (]: Writing injected SQL for node "test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028"
[0m11:56:49.032600 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028 (compile): 11:56:49.001705 => 11:56:49.032111
[0m11:56:49.035460 [debug] [Thread-3 (]: Began executing node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:56:49.038497 [debug] [Thread-3 (]: Timing info for test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028 (execute): 11:56:49.038265 => 11:56:49.038279
[0m11:56:49.042146 [debug] [Thread-3 (]: Finished running node test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028
[0m11:56:49.045374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:49.049974 [debug] [MainThread]: Connection 'test.superstore_project.accepted_values_stg_returns_status__Returned__Not_Returned.c79e20e435' was properly closed.
[0m11:56:49.056805 [debug] [MainThread]: Connection 'model.superstore_project.mart_orders_summary_by_region' was properly closed.
[0m11:56:49.064228 [debug] [MainThread]: Connection 'test.superstore_project.not_null_final_orders_with_returns_order_id.7b54452028' was properly closed.
[0m11:56:49.066017 [debug] [MainThread]: Connection 'test.superstore_project.not_null_stg_returns_order_id.d16a4eb67e' was properly closed.
[0m11:56:49.071786 [debug] [MainThread]: Command end result
[0m11:56:49.292326 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m11:56:49.296379 [info ] [MainThread]: Building catalog
[0m11:56:49.304885 [debug] [ThreadPool]: Acquiring new postgres connection 'postgres_metabase1.information_schema'
[0m11:56:49.321252 [debug] [ThreadPool]: Using postgres connection "postgres_metabase1.information_schema"
[0m11:56:49.324838 [debug] [ThreadPool]: On postgres_metabase1.information_schema: BEGIN
[0m11:56:49.327726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:49.338413 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:56:49.341240 [debug] [ThreadPool]: Using postgres connection "postgres_metabase1.information_schema"
[0m11:56:49.344890 [debug] [ThreadPool]: On postgres_metabase1.information_schema: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "postgres_metabase1.information_schema"} */

    
    

    select
        'postgres_metabase1' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('top_customers')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('monthly_returns_trend')) or (upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('mart_orders_summary_by_region')) or (upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('final_orders_with_returns')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('managers')) or (upper(sch.nspname) = upper('_staging') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('_analytics') and
           upper(tbl.relname) = upper('product_performance')) or (upper(sch.nspname) = upper('_staging') and
           upper(tbl.relname) = upper('stg_returns')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('returns')) or (upper(sch.nspname) = upper('_staging') and
           upper(tbl.relname) = upper('stg_users')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m11:56:49.354029 [debug] [ThreadPool]: SQL status: SELECT 108 in 0.0 seconds
[0m11:56:49.366316 [debug] [ThreadPool]: On postgres_metabase1.information_schema: ROLLBACK
[0m11:56:49.369053 [debug] [ThreadPool]: On postgres_metabase1.information_schema: Close
[0m11:56:49.431799 [info ] [MainThread]: Catalog written to /usr/app/target/catalog.json
[0m11:56:49.437205 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.1088176, "process_user_time": 2.903623, "process_kernel_time": 0.359885, "process_mem_max_rss": "110872", "process_in_blocks": "84232", "process_out_blocks": "0"}
[0m11:56:49.440144 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:56:49.439994 after 3.11 seconds
[0m11:56:49.443917 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:56:49.445749 [debug] [MainThread]: Connection 'postgres_metabase1.information_schema' was properly closed.
[0m11:56:49.447707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784271a78850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78424447b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78426fcabeb0>]}
[0m11:56:49.450320 [debug] [MainThread]: Flushing usage events
[0m11:56:52.952894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f95c1ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f93e4e080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f93e4e020>]}


============================== 11:56:52.956845 | c19a7462-39c4-40ea-8b2a-f22d28e82930 ==============================
[0m11:56:52.956845 [info ] [MainThread]: Running with dbt=1.7.4
[0m11:56:52.958679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:56:53.147194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c19a7462-39c4-40ea-8b2a-f22d28e82930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f93e4e170>]}
[0m11:56:53.232642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c19a7462-39c4-40ea-8b2a-f22d28e82930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f925fbb20>]}
[0m11:58:04.046741 [error] [MainThread]: Encountered an error:

[0m11:58:04.069633 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 90, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 75, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 197, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 244, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m11:58:04.077074 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 70.07696, "process_user_time": 1.907867, "process_kernel_time": 0.128801, "process_mem_max_rss": "95292", "process_in_blocks": "352", "command_success": false, "process_out_blocks": "0"}
[0m11:58:04.079656 [debug] [MainThread]: Command `dbt docs serve` failed at 11:58:04.079435 after 70.08 seconds
[0m11:58:04.082798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f95c1ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f925f8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704f925fa890>]}
[0m11:58:04.084692 [debug] [MainThread]: Flushing usage events
[0m12:33:41.244631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274f018850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274d2820e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274d282080>]}


============================== 12:33:41.248997 | 01c27b41-e383-43fe-bc42-afaae3d30607 ==============================
[0m12:33:41.248997 [info ] [MainThread]: Running with dbt=1.7.4
[0m12:33:41.251819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:33:41.726423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01c27b41-e383-43fe-bc42-afaae3d30607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274d2821d0>]}
[0m12:33:41.809205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01c27b41-e383-43fe-bc42-afaae3d30607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274b835240>]}
[0m12:33:41.815092 [info ] [MainThread]: Registered adapter: postgres=1.7.4
[0m12:33:41.834991 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m12:33:42.042063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:33:42.043394 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:33:42.049886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01c27b41-e383-43fe-bc42-afaae3d30607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274b6680d0>]}
[0m12:33:42.209020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01c27b41-e383-43fe-bc42-afaae3d30607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274b61e5f0>]}
[0m12:33:42.221011 [info ] [MainThread]: Found 8 models, 8 tests, 3 sources, 1 exposure, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:33:42.231899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01c27b41-e383-43fe-bc42-afaae3d30607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274b61e860>]}
[0m12:33:42.251722 [info ] [MainThread]: 
[0m12:33:42.264323 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:33:42.281298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m12:33:42.289860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_metabase1'
[0m12:33:42.373807 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m12:33:42.374649 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1"
[0m12:33:42.377563 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m12:33:42.383212 [debug] [ThreadPool]: On list_postgres_metabase1: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1"} */

    select distinct nspname from pg_namespace
  
[0m12:33:42.386300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:42.388629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:42.416854 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:33:42.417261 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m12:33:42.419899 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m12:33:42.422924 [debug] [ThreadPool]: On list_postgres_metabase1: Close
[0m12:33:42.428373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now list_postgres_metabase1__analytics)
[0m12:33:42.429275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres_metabase1, now list_postgres_metabase1__staging)
[0m12:33:42.435564 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__analytics"
[0m12:33:42.439247 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__staging"
[0m12:33:42.441061 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: BEGIN
[0m12:33:42.443195 [debug] [ThreadPool]: On list_postgres_metabase1__staging: BEGIN
[0m12:33:42.445509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:42.447767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:42.456523 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:33:42.457901 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:33:42.458601 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__analytics"
[0m12:33:42.460644 [debug] [ThreadPool]: Using postgres connection "list_postgres_metabase1__staging"
[0m12:33:42.463622 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1__analytics"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics'
  
[0m12:33:42.465878 [debug] [ThreadPool]: On list_postgres_metabase1__staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "list_postgres_metabase1__staging"} */
select
      'postgres_metabase1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_staging'
    union all
    select
      'postgres_metabase1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_staging'
    union all
    select
      'postgres_metabase1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_staging'
  
[0m12:33:42.471212 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:33:42.474008 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: ROLLBACK
[0m12:33:42.474316 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m12:33:42.477266 [debug] [ThreadPool]: On list_postgres_metabase1__analytics: Close
[0m12:33:42.480770 [debug] [ThreadPool]: On list_postgres_metabase1__staging: ROLLBACK
[0m12:33:42.487436 [debug] [ThreadPool]: On list_postgres_metabase1__staging: Close
[0m12:33:42.495773 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:42.499289 [debug] [MainThread]: On master: BEGIN
[0m12:33:42.501656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:33:42.513369 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:33:42.516185 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:42.519105 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:33:42.536988 [debug] [MainThread]: SQL status: SELECT 47 in 0.0 seconds
[0m12:33:42.543925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01c27b41-e383-43fe-bc42-afaae3d30607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274b6c4190>]}
[0m12:33:42.548226 [debug] [MainThread]: On master: ROLLBACK
[0m12:33:42.569573 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:42.578522 [debug] [MainThread]: On master: BEGIN
[0m12:33:42.590211 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:33:42.600415 [debug] [MainThread]: On master: COMMIT
[0m12:33:42.608678 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:42.618820 [debug] [MainThread]: On master: COMMIT
[0m12:33:42.628932 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:33:42.641401 [debug] [MainThread]: On master: Close
[0m12:33:42.650090 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:33:42.664041 [info ] [MainThread]: 
[0m12:33:42.685283 [debug] [Thread-1 (]: Began running node model.superstore_project.stg_orders
[0m12:33:42.686145 [debug] [Thread-2 (]: Began running node model.superstore_project.stg_returns
[0m12:33:42.687082 [debug] [Thread-3 (]: Began running node model.superstore_project.stg_users
[0m12:33:42.690325 [info ] [Thread-1 (]: 1 of 8 START sql view model _staging.stg_orders ................................ [RUN]
[0m12:33:42.693977 [info ] [Thread-2 (]: 2 of 8 START sql view model _staging.stg_returns ............................... [RUN]
[0m12:33:42.698531 [info ] [Thread-3 (]: 3 of 8 START sql view model _staging.stg_users ................................. [RUN]
[0m12:33:42.711017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1__staging, now model.superstore_project.stg_orders)
[0m12:33:42.715190 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_metabase1__analytics, now model.superstore_project.stg_returns)
[0m12:33:42.718642 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.superstore_project.stg_users'
[0m12:33:42.721312 [debug] [Thread-1 (]: Began compiling node model.superstore_project.stg_orders
[0m12:33:42.724498 [debug] [Thread-2 (]: Began compiling node model.superstore_project.stg_returns
[0m12:33:42.728072 [debug] [Thread-3 (]: Began compiling node model.superstore_project.stg_users
[0m12:33:42.740370 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.stg_orders"
[0m12:33:42.746098 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.stg_returns"
[0m12:33:42.752690 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.stg_users"
[0m12:33:42.769276 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (compile): 12:33:42.731372 => 12:33:42.768869
[0m12:33:42.771896 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (compile): 12:33:42.743080 => 12:33:42.771309
[0m12:33:42.772503 [debug] [Thread-1 (]: Began executing node model.superstore_project.stg_orders
[0m12:33:42.773956 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (compile): 12:33:42.749722 => 12:33:42.773597
[0m12:33:42.774986 [debug] [Thread-2 (]: Began executing node model.superstore_project.stg_returns
[0m12:33:42.800249 [debug] [Thread-3 (]: Began executing node model.superstore_project.stg_users
[0m12:33:42.807156 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.stg_orders"
[0m12:33:42.812652 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.stg_returns"
[0m12:33:42.848639 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.stg_users"
[0m12:33:42.855592 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m12:33:42.857119 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: BEGIN
[0m12:33:42.857658 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m12:33:42.858951 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:33:42.859880 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m12:33:42.860477 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: BEGIN
[0m12:33:42.862968 [debug] [Thread-3 (]: On model.superstore_project.stg_users: BEGIN
[0m12:33:42.864258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:42.865407 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:33:42.867260 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:33:42.869079 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m12:33:42.870147 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */

  create view "postgres_metabase1"."_staging"."stg_returns__dbt_tmp"
    
    
  as (
    WITH raw_returns AS (
    SELECT
        order_id,
        status
    FROM "postgres_metabase1"."raw"."returns"
)
SELECT *
FROM raw_returns
  );
[0m12:33:42.871936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:33:42.873048 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:33:42.873716 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m12:33:42.874932 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m12:33:42.876239 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */

  create view "postgres_metabase1"."_staging"."stg_orders__dbt_tmp"
    
    
  as (
    WITH raw_orders AS (
    SELECT
        row_id,
        order_id,
        order_date,
        ship_date,
        ship_mode,
        order_priority,
        product_container,
        customer_name,
        customer_segment,
        zip_code,
        state,
        city,
        region,
        product_category,
        product_subcategory,
        product_name,
        unit_price,
        quantity AS order_quantity,
        sales,
        profit,
        discount,
        shipping_cost,
        product_base_margin
    FROM "postgres_metabase1"."raw"."orders"
)
SELECT *
FROM raw_orders
  );
[0m12:33:42.877599 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */

  create view "postgres_metabase1"."_staging"."stg_users__dbt_tmp"
    
    
  as (
    WITH raw_users AS (
    SELECT
        region,
        manager
    FROM "postgres_metabase1"."raw"."managers"
)
SELECT *
FROM raw_users
  );
[0m12:33:42.902671 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:33:42.903565 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:33:42.904261 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:33:42.913928 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m12:33:42.918303 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m12:33:42.923885 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m12:33:42.925753 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
alter table "postgres_metabase1"."_staging"."stg_users" rename to "stg_users__dbt_backup"
[0m12:33:42.927563 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
alter table "postgres_metabase1"."_staging"."stg_returns" rename to "stg_returns__dbt_backup"
[0m12:33:42.929314 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
alter table "postgres_metabase1"."_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:33:42.931794 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:42.933177 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:42.934453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:42.938099 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m12:33:42.942452 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m12:33:42.946235 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m12:33:42.947413 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
alter table "postgres_metabase1"."_staging"."stg_users__dbt_tmp" rename to "stg_users"
[0m12:33:42.948784 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
alter table "postgres_metabase1"."_staging"."stg_returns__dbt_tmp" rename to "stg_returns"
[0m12:33:42.950054 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
alter table "postgres_metabase1"."_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:33:42.951736 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:42.952794 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:42.953907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:42.973692 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m12:33:42.975387 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m12:33:42.978168 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m12:33:42.979761 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m12:33:42.981182 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m12:33:42.982452 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m12:33:42.983778 [debug] [Thread-3 (]: On model.superstore_project.stg_users: COMMIT
[0m12:33:42.984899 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: COMMIT
[0m12:33:42.986199 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: COMMIT
[0m12:33:42.990376 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:33:42.991211 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:33:42.991576 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:33:42.998615 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."_staging"."stg_users__dbt_backup"
[0m12:33:43.001499 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."_staging"."stg_orders__dbt_backup"
[0m12:33:43.004313 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."_staging"."stg_returns__dbt_backup"
[0m12:33:43.009256 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.stg_users"
[0m12:33:43.010829 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.stg_orders"
[0m12:33:43.012543 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.stg_returns"
[0m12:33:43.013671 [debug] [Thread-3 (]: On model.superstore_project.stg_users: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_users"} */
drop view if exists "postgres_metabase1"."_staging"."stg_users__dbt_backup" cascade
[0m12:33:43.015098 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_orders"} */
drop view if exists "postgres_metabase1"."_staging"."stg_orders__dbt_backup" cascade
[0m12:33:43.016154 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.stg_returns"} */
drop view if exists "postgres_metabase1"."_staging"."stg_returns__dbt_backup" cascade
[0m12:33:43.019820 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:33:43.020692 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:33:43.022047 [debug] [Thread-3 (]: Timing info for model.superstore_project.stg_users (execute): 12:33:42.815381 => 12:33:43.021876
[0m12:33:43.022427 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:33:43.024347 [debug] [Thread-1 (]: Timing info for model.superstore_project.stg_orders (execute): 12:33:42.776867 => 12:33:43.024186
[0m12:33:43.025610 [debug] [Thread-3 (]: On model.superstore_project.stg_users: Close
[0m12:33:43.027870 [debug] [Thread-2 (]: Timing info for model.superstore_project.stg_returns (execute): 12:33:42.809423 => 12:33:43.027711
[0m12:33:43.029076 [debug] [Thread-1 (]: On model.superstore_project.stg_orders: Close
[0m12:33:43.031000 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c27b41-e383-43fe-bc42-afaae3d30607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274b57fa30>]}
[0m12:33:43.031944 [debug] [Thread-2 (]: On model.superstore_project.stg_returns: Close
[0m12:33:43.033573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c27b41-e383-43fe-bc42-afaae3d30607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274b54d330>]}
[0m12:33:43.034593 [info ] [Thread-3 (]: 3 of 8 OK created sql view model _staging.stg_users ............................ [[32mCREATE VIEW[0m in 0.31s]
[0m12:33:43.036582 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c27b41-e383-43fe-bc42-afaae3d30607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274b6a5e40>]}
[0m12:33:43.039763 [info ] [Thread-1 (]: 1 of 8 OK created sql view model _staging.stg_orders ........................... [[32mCREATE VIEW[0m in 0.32s]
[0m12:33:43.041275 [debug] [Thread-3 (]: Finished running node model.superstore_project.stg_users
[0m12:33:43.042637 [info ] [Thread-2 (]: 2 of 8 OK created sql view model _staging.stg_returns .......................... [[32mCREATE VIEW[0m in 0.32s]
[0m12:33:43.044251 [debug] [Thread-1 (]: Finished running node model.superstore_project.stg_orders
[0m12:33:43.046414 [debug] [Thread-2 (]: Finished running node model.superstore_project.stg_returns
[0m12:33:43.048389 [debug] [Thread-4 (]: Began running node model.superstore_project.product_performance
[0m12:33:43.048782 [debug] [Thread-3 (]: Began running node model.superstore_project.top_customers
[0m12:33:43.050013 [debug] [Thread-1 (]: Began running node model.superstore_project.final_orders_with_returns
[0m12:33:43.050351 [debug] [Thread-2 (]: Began running node model.superstore_project.monthly_returns_trend
[0m12:33:43.051409 [info ] [Thread-4 (]: 4 of 8 START sql table model _analytics.product_performance .................... [RUN]
[0m12:33:43.052832 [info ] [Thread-3 (]: 5 of 8 START sql table model _analytics.top_customers .......................... [RUN]
[0m12:33:43.054388 [info ] [Thread-1 (]: 6 of 8 START sql table model _analytics.final_orders_with_returns .............. [RUN]
[0m12:33:43.055772 [info ] [Thread-2 (]: 7 of 8 START sql table model _analytics.monthly_returns_trend .................. [RUN]
[0m12:33:43.057479 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.superstore_project.product_performance'
[0m12:33:43.059040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_users, now model.superstore_project.top_customers)
[0m12:33:43.060413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_orders, now model.superstore_project.final_orders_with_returns)
[0m12:33:43.062575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.stg_returns, now model.superstore_project.monthly_returns_trend)
[0m12:33:43.067179 [debug] [Thread-4 (]: Began compiling node model.superstore_project.product_performance
[0m12:33:43.068506 [debug] [Thread-3 (]: Began compiling node model.superstore_project.top_customers
[0m12:33:43.069827 [debug] [Thread-1 (]: Began compiling node model.superstore_project.final_orders_with_returns
[0m12:33:43.071152 [debug] [Thread-2 (]: Began compiling node model.superstore_project.monthly_returns_trend
[0m12:33:43.075619 [debug] [Thread-4 (]: Writing injected SQL for node "model.superstore_project.product_performance"
[0m12:33:43.079910 [debug] [Thread-3 (]: Writing injected SQL for node "model.superstore_project.top_customers"
[0m12:33:43.085315 [debug] [Thread-1 (]: Writing injected SQL for node "model.superstore_project.final_orders_with_returns"
[0m12:33:43.089955 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.monthly_returns_trend"
[0m12:33:43.102527 [debug] [Thread-4 (]: Timing info for model.superstore_project.product_performance (compile): 12:33:43.072286 => 12:33:43.102194
[0m12:33:43.104148 [debug] [Thread-4 (]: Began executing node model.superstore_project.product_performance
[0m12:33:43.104725 [debug] [Thread-3 (]: Timing info for model.superstore_project.top_customers (compile): 12:33:43.076928 => 12:33:43.104462
[0m12:33:43.105959 [debug] [Thread-1 (]: Timing info for model.superstore_project.final_orders_with_returns (compile): 12:33:43.082072 => 12:33:43.105711
[0m12:33:43.112180 [debug] [Thread-2 (]: Timing info for model.superstore_project.monthly_returns_trend (compile): 12:33:43.087085 => 12:33:43.111921
[0m12:33:43.127584 [debug] [Thread-4 (]: Writing runtime sql for node "model.superstore_project.product_performance"
[0m12:33:43.128743 [debug] [Thread-3 (]: Began executing node model.superstore_project.top_customers
[0m12:33:43.130040 [debug] [Thread-1 (]: Began executing node model.superstore_project.final_orders_with_returns
[0m12:33:43.131901 [debug] [Thread-2 (]: Began executing node model.superstore_project.monthly_returns_trend
[0m12:33:43.137381 [debug] [Thread-3 (]: Writing runtime sql for node "model.superstore_project.top_customers"
[0m12:33:43.141942 [debug] [Thread-1 (]: Writing runtime sql for node "model.superstore_project.final_orders_with_returns"
[0m12:33:43.147943 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.monthly_returns_trend"
[0m12:33:43.148430 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.product_performance"
[0m12:33:43.165883 [debug] [Thread-4 (]: On model.superstore_project.product_performance: BEGIN
[0m12:33:43.169386 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:33:43.180091 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m12:33:43.188203 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.top_customers"
[0m12:33:43.190203 [debug] [Thread-1 (]: On model.superstore_project.final_orders_with_returns: BEGIN
[0m12:33:43.198243 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:33:43.201362 [debug] [Thread-3 (]: On model.superstore_project.top_customers: BEGIN
[0m12:33:43.203251 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m12:33:43.207968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:43.216866 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.product_performance"
[0m12:33:43.221997 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:33:43.227966 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: BEGIN
[0m12:33:43.241045 [debug] [Thread-4 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */

  
    

  create  table "postgres_metabase1"."_analytics"."product_performance__dbt_tmp"
  
  
    as
  
  (
    

-- ============================================================================
-- Model: product_performance
--
-- Description:
--   Provides product-level performance metrics including sales,
--   profit, quantity sold, and margin.
--
--   This model is designed to support product and operations teams
--   in understanding which products drive revenue and profitability.
--
-- Grain:
--   One row per (product_name, product_category, product_subcategory)
--
-- Business Questions Answered:
--   - Which products generate the most sales?
--   - Which products are most profitable?
--   - How do margins vary across products?
--
-- Source Models:
--   - stg_orders
--
-- Notes:
--   - Metrics are aggregated across all historical orders
--   - This model is consumed directly by Metabase dashboards
--
-- ============================================================================

SELECT
    product_name,
    product_category,
    product_subcategory,
    SUM(order_quantity) AS total_quantity_sold,
    SUM(sales) AS total_sales,
    SUM(profit) AS total_profit,
    ROUND(AVG(product_base_margin), 4) AS avg_margin,
    COUNT(DISTINCT order_id) AS num_orders
FROM "postgres_metabase1"."_staging"."stg_orders"
GROUP BY 1, 2, 3
ORDER BY total_sales DESC
LIMIT 100
  );
  
[0m12:33:43.252918 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:33:43.256485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:33:43.263522 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:33:43.264668 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m12:33:43.270730 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.top_customers"
[0m12:33:43.275819 [debug] [Thread-1 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */

  
    

  create  table "postgres_metabase1"."_analytics"."final_orders_with_returns__dbt_tmp"
  
  
    as
  
  (
    

-- ============================================================================
-- Model: final_orders_with_returns
--
-- Description:
--   Core fact table combining order-level data with return status
--   and regional manager information.
--
--   This model serves as the foundation for downstream analytical marts
--   and is consumed directly by BI tools such as Metabase.
--
-- Grain:
--   One row per order line (row_id from stg_orders)
--
-- Business Questions Answered:
--   - Which orders were returned?
--   - How do returns vary by region and manager?
--   - How do returns impact sales and profit?
--
-- Source Models:
--   - stg_orders
--   - stg_returns
--   - stg_users
--
-- Notes:
--   - This is the primary fact table in the analytics layer
--   - Downstream marts depend on this model
--   - No filtering or aggregation is applied at this stage
--
-- ============================================================================

WITH orders_with_returns AS (

    SELECT
        o.*,
        r.status AS return_status,
        u.manager AS region_manager
    FROM "postgres_metabase1"."_staging"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."_staging"."stg_returns" r
        ON o.order_id = r.order_id
    LEFT JOIN "postgres_metabase1"."_staging"."stg_users" u
        ON o.region = u.region
)

SELECT *
FROM orders_with_returns
  );
  
[0m12:33:43.276924 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:33:43.280013 [debug] [Thread-3 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */

  
    

  create  table "postgres_metabase1"."_analytics"."top_customers__dbt_tmp"
  
  
    as
  
  (
    

-- ============================================================================
-- Model: top_customers
--
-- Description:
--   Identifies the highest-value customers based on total sales,
--   order frequency, and average profit.
--
--   This model is designed for executive and customer analytics use cases,
--   supporting decisions around customer retention, segmentation,
--   and revenue concentration.
--
-- Grain:
--   One row per customer
--
-- Business Questions Answered:
--   - Who are the top customers by total revenue?
--   - How many orders do top customers place?
--   - Which customer segments generate the most value?
--
-- Source Models:
--   - stg_orders
--
-- Notes:
--   - Customers are ranked by total sales
--   - Limited to the top 50 customers by revenue
--   - Consumed directly by Metabase dashboards
--
-- ============================================================================

SELECT
    customer_name,
    customer_segment,
    region,
    SUM(sales) AS total_sales,
    COUNT(DISTINCT order_id) AS num_orders,
    ROUND(AVG(profit), 2) AS avg_profit
FROM "postgres_metabase1"."_staging"."stg_orders"
GROUP BY 1, 2, 3
ORDER BY total_sales DESC
LIMIT 50
  );
  
[0m12:33:43.293119 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m12:33:43.302226 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */

  
    

  create  table "postgres_metabase1"."_analytics"."monthly_returns_trend__dbt_tmp"
  
  
    as
  
  (
    

-- ============================================================================
-- Model: monthly_returns_trend
--
-- Description:
--   Tracks monthly trends in order returns.
--   Used by executives and operations teams to monitor
--   product quality and return behavior over time.
--
-- Grain:
--   One row per month
--
-- Business Questions Answered:
--   - Are return rates increasing or decreasing over time?
--   - Are there seasonal patterns in returns?
--
-- Source Models:
--   - stg_orders
--   - stg_returns
--
-- ============================================================================

WITH orders_with_returns AS (
    SELECT
        o.order_id,
        o.order_date,
        r.status
    FROM "postgres_metabase1"."_staging"."stg_orders" o
    LEFT JOIN "postgres_metabase1"."_staging"."stg_returns" r
        ON o.order_id = r.order_id
),
returns_by_month AS (
    SELECT
        DATE_TRUNC('month', order_date) AS month,
        COUNT(*) FILTER (WHERE status = 'Returned') AS returned_orders,
        COUNT(*) AS total_orders,
        ROUND(
            COUNT(*) FILTER (WHERE status = 'Returned')::decimal
            / NULLIF(COUNT(*), 0),
            2
        ) AS return_rate
    FROM orders_with_returns
    GROUP BY 1
)

SELECT *
FROM returns_by_month
ORDER BY month
  );
  
[0m12:33:43.313792 [debug] [Thread-2 (]: SQL status: SELECT 48 in 0.0 seconds
[0m12:33:43.318313 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m12:33:43.318727 [debug] [Thread-4 (]: SQL status: SELECT 100 in 0.0 seconds
[0m12:33:43.320466 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.0 seconds
[0m12:33:43.320863 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */
alter table "postgres_metabase1"."_analytics"."monthly_returns_trend" rename to "monthly_returns_trend__dbt_backup"
[0m12:33:43.325471 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.product_performance"
[0m12:33:43.326778 [debug] [Thread-1 (]: SQL status: SELECT 8399 in 0.0 seconds
[0m12:33:43.330768 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.top_customers"
[0m12:33:43.333312 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:43.334721 [debug] [Thread-4 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */
alter table "postgres_metabase1"."_analytics"."product_performance" rename to "product_performance__dbt_backup"
[0m12:33:43.339018 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m12:33:43.342195 [debug] [Thread-3 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */
alter table "postgres_metabase1"."_analytics"."top_customers" rename to "top_customers__dbt_backup"
[0m12:33:43.347979 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m12:33:43.351621 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:43.353207 [debug] [Thread-1 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
alter table "postgres_metabase1"."_analytics"."final_orders_with_returns" rename to "final_orders_with_returns__dbt_backup"
[0m12:33:43.356269 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:43.357984 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */
alter table "postgres_metabase1"."_analytics"."monthly_returns_trend__dbt_tmp" rename to "monthly_returns_trend"
[0m12:33:43.365791 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.product_performance"
[0m12:33:43.368874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:43.375958 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.top_customers"
[0m12:33:43.388050 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:43.389996 [debug] [Thread-4 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */
alter table "postgres_metabase1"."_analytics"."product_performance__dbt_tmp" rename to "product_performance"
[0m12:33:43.401670 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m12:33:43.408643 [debug] [Thread-3 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */
alter table "postgres_metabase1"."_analytics"."top_customers__dbt_tmp" rename to "top_customers"
[0m12:33:43.427441 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: COMMIT
[0m12:33:43.429935 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:43.431286 [debug] [Thread-1 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
alter table "postgres_metabase1"."_analytics"."final_orders_with_returns__dbt_tmp" rename to "final_orders_with_returns"
[0m12:33:43.435940 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m12:33:43.437107 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:43.440984 [debug] [Thread-4 (]: On model.superstore_project.product_performance: COMMIT
[0m12:33:43.443308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:43.444736 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: COMMIT
[0m12:33:43.449142 [debug] [Thread-3 (]: On model.superstore_project.top_customers: COMMIT
[0m12:33:43.450632 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.product_performance"
[0m12:33:43.454252 [debug] [Thread-1 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m12:33:43.459176 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:33:43.459766 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.top_customers"
[0m12:33:43.461288 [debug] [Thread-4 (]: On model.superstore_project.product_performance: COMMIT
[0m12:33:43.462942 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m12:33:43.467406 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."_analytics"."monthly_returns_trend__dbt_backup"
[0m12:33:43.468968 [debug] [Thread-3 (]: On model.superstore_project.top_customers: COMMIT
[0m12:33:43.472898 [debug] [Thread-1 (]: On model.superstore_project.final_orders_with_returns: COMMIT
[0m12:33:43.473445 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:33:43.477566 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.monthly_returns_trend"
[0m12:33:43.479852 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:33:43.481177 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:33:43.484742 [debug] [Thread-4 (]: Applying DROP to: "postgres_metabase1"."_analytics"."product_performance__dbt_backup"
[0m12:33:43.487126 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.monthly_returns_trend"} */
drop table if exists "postgres_metabase1"."_analytics"."monthly_returns_trend__dbt_backup" cascade
[0m12:33:43.490940 [debug] [Thread-3 (]: Applying DROP to: "postgres_metabase1"."_analytics"."top_customers__dbt_backup"
[0m12:33:43.494568 [debug] [Thread-1 (]: Applying DROP to: "postgres_metabase1"."_analytics"."final_orders_with_returns__dbt_backup"
[0m12:33:43.497873 [debug] [Thread-4 (]: Using postgres connection "model.superstore_project.product_performance"
[0m12:33:43.503753 [debug] [Thread-3 (]: Using postgres connection "model.superstore_project.top_customers"
[0m12:33:43.504387 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:33:43.506935 [debug] [Thread-1 (]: Using postgres connection "model.superstore_project.final_orders_with_returns"
[0m12:33:43.510634 [debug] [Thread-4 (]: On model.superstore_project.product_performance: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.product_performance"} */
drop table if exists "postgres_metabase1"."_analytics"."product_performance__dbt_backup" cascade
[0m12:33:43.513835 [debug] [Thread-3 (]: On model.superstore_project.top_customers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.top_customers"} */
drop table if exists "postgres_metabase1"."_analytics"."top_customers__dbt_backup" cascade
[0m12:33:43.519619 [debug] [Thread-2 (]: Timing info for model.superstore_project.monthly_returns_trend (execute): 12:33:43.144783 => 12:33:43.519029
[0m12:33:43.522825 [debug] [Thread-1 (]: On model.superstore_project.final_orders_with_returns: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.final_orders_with_returns"} */
drop table if exists "postgres_metabase1"."_analytics"."final_orders_with_returns__dbt_backup" cascade
[0m12:33:43.530290 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:33:43.531523 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:33:43.532020 [debug] [Thread-2 (]: On model.superstore_project.monthly_returns_trend: Close
[0m12:33:43.539983 [debug] [Thread-4 (]: Timing info for model.superstore_project.product_performance (execute): 12:33:43.106736 => 12:33:43.539703
[0m12:33:43.540485 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:33:43.546294 [debug] [Thread-3 (]: Timing info for model.superstore_project.top_customers (execute): 12:33:43.133966 => 12:33:43.546049
[0m12:33:43.551858 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c27b41-e383-43fe-bc42-afaae3d30607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274b692b90>]}
[0m12:33:43.559796 [debug] [Thread-4 (]: On model.superstore_project.product_performance: Close
[0m12:33:43.576003 [debug] [Thread-1 (]: Timing info for model.superstore_project.final_orders_with_returns (execute): 12:33:43.138744 => 12:33:43.575417
[0m12:33:43.586007 [debug] [Thread-3 (]: On model.superstore_project.top_customers: Close
[0m12:33:43.596138 [info ] [Thread-2 (]: 7 of 8 OK created sql table model _analytics.monthly_returns_trend ............. [[32mSELECT 48[0m in 0.49s]
[0m12:33:43.602675 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c27b41-e383-43fe-bc42-afaae3d30607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274b5b10f0>]}
[0m12:33:43.609518 [debug] [Thread-1 (]: On model.superstore_project.final_orders_with_returns: Close
[0m12:33:43.618450 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c27b41-e383-43fe-bc42-afaae3d30607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274b544d30>]}
[0m12:33:43.626482 [debug] [Thread-2 (]: Finished running node model.superstore_project.monthly_returns_trend
[0m12:33:43.633608 [info ] [Thread-4 (]: 4 of 8 OK created sql table model _analytics.product_performance ............... [[32mSELECT 100[0m in 0.55s]
[0m12:33:43.640186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c27b41-e383-43fe-bc42-afaae3d30607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274b6d85b0>]}
[0m12:33:43.647755 [info ] [Thread-3 (]: 5 of 8 OK created sql table model _analytics.top_customers ..................... [[32mSELECT 50[0m in 0.56s]
[0m12:33:43.662063 [debug] [Thread-4 (]: Finished running node model.superstore_project.product_performance
[0m12:33:43.666881 [info ] [Thread-1 (]: 6 of 8 OK created sql table model _analytics.final_orders_with_returns ......... [[32mSELECT 8399[0m in 0.58s]
[0m12:33:43.671945 [debug] [Thread-3 (]: Finished running node model.superstore_project.top_customers
[0m12:33:43.677758 [debug] [Thread-1 (]: Finished running node model.superstore_project.final_orders_with_returns
[0m12:33:43.684803 [debug] [Thread-2 (]: Began running node model.superstore_project.mart_orders_summary_by_region
[0m12:33:43.688803 [info ] [Thread-2 (]: 8 of 8 START sql table model _analytics.mart_orders_summary_by_region .......... [RUN]
[0m12:33:43.693025 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.superstore_project.monthly_returns_trend, now model.superstore_project.mart_orders_summary_by_region)
[0m12:33:43.696866 [debug] [Thread-2 (]: Began compiling node model.superstore_project.mart_orders_summary_by_region
[0m12:33:43.702647 [debug] [Thread-2 (]: Writing injected SQL for node "model.superstore_project.mart_orders_summary_by_region"
[0m12:33:44.100775 [debug] [Thread-2 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (compile): 12:33:43.699287 => 12:33:44.100180
[0m12:33:44.104403 [debug] [Thread-2 (]: Began executing node model.superstore_project.mart_orders_summary_by_region
[0m12:33:44.118022 [debug] [Thread-2 (]: Writing runtime sql for node "model.superstore_project.mart_orders_summary_by_region"
[0m12:33:44.614103 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m12:33:44.622942 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: BEGIN
[0m12:33:44.632360 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:33:44.656187 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:33:44.661763 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m12:33:44.666518 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */

  
    

  create  table "postgres_metabase1"."_analytics"."mart_orders_summary_by_region__dbt_tmp"
  
  
    as
  
  (
    

-- ============================================================================
-- Model: mart_orders_summary_by_region
--
-- Description:
--   This model provides an aggregated view of sales, profitability, and
--   return behavior by sales region and regional manager.
--
--   It is designed for executive and management reporting and is used
--   directly by Metabase dashboards.
--
-- Grain:
--   One row per (region, region_manager)
--
-- Business Questions Answered:
--   - Which regions generate the most sales and profit?
--   - Which regions have the highest return rates?
--   - How do regional managers compare in performance?
--
-- Source Models:
--   - final_orders_with_returns
--
-- ============================================================================

WITH region_summary AS (

    SELECT
        region,
        region_manager,

        -- Order metrics
        COUNT(DISTINCT order_id) AS total_orders,
        COUNT(
            DISTINCT CASE
                WHEN return_status = 'Returned' THEN order_id
            END
        ) AS returned_orders,

        -- Return rate (%)
        ROUND(
            100.0
            * COUNT(
                DISTINCT CASE
                    WHEN return_status = 'Returned' THEN order_id
                END
            )
            / NULLIF(COUNT(DISTINCT order_id), 0),
            2
        ) AS return_rate_percent,

        -- Financial metrics
        SUM(sales) AS total_sales,
        SUM(profit) AS total_profit,

        -- Discount behavior
        ROUND(AVG(discount), 4) AS avg_discount

    FROM "postgres_metabase1"."_analytics"."final_orders_with_returns"

    GROUP BY
        region,
        region_manager
)

SELECT *
FROM region_summary
  );
  
[0m12:33:44.688643 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.0 seconds
[0m12:33:44.694162 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m12:33:44.697398 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
alter table "postgres_metabase1"."_analytics"."mart_orders_summary_by_region" rename to "mart_orders_summary_by_region__dbt_backup"
[0m12:33:44.700665 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:44.707458 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m12:33:44.711823 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
alter table "postgres_metabase1"."_analytics"."mart_orders_summary_by_region__dbt_tmp" rename to "mart_orders_summary_by_region"
[0m12:33:44.717701 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:33:44.724328 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m12:33:44.728640 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m12:33:44.732918 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: COMMIT
[0m12:33:44.742881 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:33:44.760153 [debug] [Thread-2 (]: Applying DROP to: "postgres_metabase1"."_analytics"."mart_orders_summary_by_region__dbt_backup"
[0m12:33:44.767635 [debug] [Thread-2 (]: Using postgres connection "model.superstore_project.mart_orders_summary_by_region"
[0m12:33:44.774025 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "postgres_profile", "target_name": "dev", "node_id": "model.superstore_project.mart_orders_summary_by_region"} */
drop table if exists "postgres_metabase1"."_analytics"."mart_orders_summary_by_region__dbt_backup" cascade
[0m12:33:44.787600 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:33:44.797610 [debug] [Thread-2 (]: Timing info for model.superstore_project.mart_orders_summary_by_region (execute): 12:33:44.108646 => 12:33:44.797076
[0m12:33:44.814737 [debug] [Thread-2 (]: On model.superstore_project.mart_orders_summary_by_region: Close
[0m12:33:44.829043 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c27b41-e383-43fe-bc42-afaae3d30607', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2748418220>]}
[0m12:33:44.845288 [info ] [Thread-2 (]: 8 of 8 OK created sql table model _analytics.mart_orders_summary_by_region ..... [[32mSELECT 4[0m in 1.14s]
[0m12:33:44.857881 [debug] [Thread-2 (]: Finished running node model.superstore_project.mart_orders_summary_by_region
[0m12:33:44.874941 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:44.879523 [debug] [MainThread]: On master: BEGIN
[0m12:33:44.883575 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:33:44.893287 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:33:44.896280 [debug] [MainThread]: On master: COMMIT
[0m12:33:44.898821 [debug] [MainThread]: Using postgres connection "master"
[0m12:33:44.901400 [debug] [MainThread]: On master: COMMIT
[0m12:33:44.904908 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:33:44.908004 [debug] [MainThread]: On master: Close
[0m12:33:44.912186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:44.915529 [debug] [MainThread]: Connection 'model.superstore_project.mart_orders_summary_by_region' was properly closed.
[0m12:33:44.919102 [debug] [MainThread]: Connection 'model.superstore_project.final_orders_with_returns' was properly closed.
[0m12:33:44.923181 [debug] [MainThread]: Connection 'model.superstore_project.top_customers' was properly closed.
[0m12:33:44.927727 [debug] [MainThread]: Connection 'model.superstore_project.product_performance' was properly closed.
[0m12:33:44.935169 [info ] [MainThread]: 
[0m12:33:44.941602 [info ] [MainThread]: Finished running 3 view models, 5 table models in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m12:33:44.955312 [debug] [MainThread]: Command end result
[0m12:33:45.015298 [info ] [MainThread]: 
[0m12:33:45.022105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:33:45.029914 [info ] [MainThread]: 
[0m12:33:45.032946 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:33:45.041802 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0829265, "process_user_time": 2.8865, "process_kernel_time": 0.414114, "process_mem_max_rss": "107168", "process_in_blocks": "80752", "process_out_blocks": "0"}
[0m12:33:45.047249 [debug] [MainThread]: Command `dbt run` succeeded at 12:33:45.047072 after 3.09 seconds
[0m12:33:45.051246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274f018850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274b835240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a274b531f60>]}
[0m12:33:45.053449 [debug] [MainThread]: Flushing usage events
