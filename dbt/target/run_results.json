{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.4", "generated_at": "2026-01-20T12:33:44.947960Z", "invocation_id": "01c27b41-e383-43fe-bc42-afaae3d30607", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T12:33:42.749722Z", "completed_at": "2026-01-20T12:33:42.773597Z"}, {"name": "execute", "started_at": "2026-01-20T12:33:42.815381Z", "completed_at": "2026-01-20T12:33:43.021876Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.31307363510131836, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.superstore_project.stg_users", "compiled": true, "compiled_code": "WITH raw_users AS (\n    SELECT\n        region,\n        manager\n    FROM \"postgres_metabase1\".\"raw\".\"managers\"\n)\nSELECT *\nFROM raw_users", "relation_name": "\"postgres_metabase1\".\"_staging\".\"stg_users\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T12:33:42.731372Z", "completed_at": "2026-01-20T12:33:42.768869Z"}, {"name": "execute", "started_at": "2026-01-20T12:33:42.776867Z", "completed_at": "2026-01-20T12:33:43.024186Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3243827819824219, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.superstore_project.stg_orders", "compiled": true, "compiled_code": "WITH raw_orders AS (\n    SELECT\n        row_id,\n        order_id,\n        order_date,\n        ship_date,\n        ship_mode,\n        order_priority,\n        product_container,\n        customer_name,\n        customer_segment,\n        zip_code,\n        state,\n        city,\n        region,\n        product_category,\n        product_subcategory,\n        product_name,\n        unit_price,\n        quantity AS order_quantity,\n        sales,\n        profit,\n        discount,\n        shipping_cost,\n        product_base_margin\n    FROM \"postgres_metabase1\".\"raw\".\"orders\"\n)\nSELECT *\nFROM raw_orders", "relation_name": "\"postgres_metabase1\".\"_staging\".\"stg_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T12:33:42.743080Z", "completed_at": "2026-01-20T12:33:42.771309Z"}, {"name": "execute", "started_at": "2026-01-20T12:33:42.809423Z", "completed_at": "2026-01-20T12:33:43.027711Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.32190752029418945, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.superstore_project.stg_returns", "compiled": true, "compiled_code": "WITH raw_returns AS (\n    SELECT\n        order_id,\n        status\n    FROM \"postgres_metabase1\".\"raw\".\"returns\"\n)\nSELECT *\nFROM raw_returns", "relation_name": "\"postgres_metabase1\".\"_staging\".\"stg_returns\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T12:33:43.087085Z", "completed_at": "2026-01-20T12:33:43.111921Z"}, {"name": "execute", "started_at": "2026-01-20T12:33:43.144783Z", "completed_at": "2026-01-20T12:33:43.519029Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4895153045654297, "adapter_response": {"_message": "SELECT 48", "code": "SELECT", "rows_affected": 48}, "message": "SELECT 48", "failures": null, "unique_id": "model.superstore_project.monthly_returns_trend", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- Model: monthly_returns_trend\n--\n-- Description:\n--   Tracks monthly trends in order returns.\n--   Used by executives and operations teams to monitor\n--   product quality and return behavior over time.\n--\n-- Grain:\n--   One row per month\n--\n-- Business Questions Answered:\n--   - Are return rates increasing or decreasing over time?\n--   - Are there seasonal patterns in returns?\n--\n-- Source Models:\n--   - stg_orders\n--   - stg_returns\n--\n-- ============================================================================\n\nWITH orders_with_returns AS (\n    SELECT\n        o.order_id,\n        o.order_date,\n        r.status\n    FROM \"postgres_metabase1\".\"_staging\".\"stg_orders\" o\n    LEFT JOIN \"postgres_metabase1\".\"_staging\".\"stg_returns\" r\n        ON o.order_id = r.order_id\n),\nreturns_by_month AS (\n    SELECT\n        DATE_TRUNC('month', order_date) AS month,\n        COUNT(*) FILTER (WHERE status = 'Returned') AS returned_orders,\n        COUNT(*) AS total_orders,\n        ROUND(\n            COUNT(*) FILTER (WHERE status = 'Returned')::decimal\n            / NULLIF(COUNT(*), 0),\n            2\n        ) AS return_rate\n    FROM orders_with_returns\n    GROUP BY 1\n)\n\nSELECT *\nFROM returns_by_month\nORDER BY month", "relation_name": "\"postgres_metabase1\".\"_analytics\".\"monthly_returns_trend\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T12:33:43.072286Z", "completed_at": "2026-01-20T12:33:43.102194Z"}, {"name": "execute", "started_at": "2026-01-20T12:33:43.106736Z", "completed_at": "2026-01-20T12:33:43.539703Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.5455491542816162, "adapter_response": {"_message": "SELECT 100", "code": "SELECT", "rows_affected": 100}, "message": "SELECT 100", "failures": null, "unique_id": "model.superstore_project.product_performance", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- Model: product_performance\n--\n-- Description:\n--   Provides product-level performance metrics including sales,\n--   profit, quantity sold, and margin.\n--\n--   This model is designed to support product and operations teams\n--   in understanding which products drive revenue and profitability.\n--\n-- Grain:\n--   One row per (product_name, product_category, product_subcategory)\n--\n-- Business Questions Answered:\n--   - Which products generate the most sales?\n--   - Which products are most profitable?\n--   - How do margins vary across products?\n--\n-- Source Models:\n--   - stg_orders\n--\n-- Notes:\n--   - Metrics are aggregated across all historical orders\n--   - This model is consumed directly by Metabase dashboards\n--\n-- ============================================================================\n\nSELECT\n    product_name,\n    product_category,\n    product_subcategory,\n    SUM(order_quantity) AS total_quantity_sold,\n    SUM(sales) AS total_sales,\n    SUM(profit) AS total_profit,\n    ROUND(AVG(product_base_margin), 4) AS avg_margin,\n    COUNT(DISTINCT order_id) AS num_orders\nFROM \"postgres_metabase1\".\"_staging\".\"stg_orders\"\nGROUP BY 1, 2, 3\nORDER BY total_sales DESC\nLIMIT 100", "relation_name": "\"postgres_metabase1\".\"_analytics\".\"product_performance\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T12:33:43.076928Z", "completed_at": "2026-01-20T12:33:43.104462Z"}, {"name": "execute", "started_at": "2026-01-20T12:33:43.133966Z", "completed_at": "2026-01-20T12:33:43.546049Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5592854022979736, "adapter_response": {"_message": "SELECT 50", "code": "SELECT", "rows_affected": 50}, "message": "SELECT 50", "failures": null, "unique_id": "model.superstore_project.top_customers", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- Model: top_customers\n--\n-- Description:\n--   Identifies the highest-value customers based on total sales,\n--   order frequency, and average profit.\n--\n--   This model is designed for executive and customer analytics use cases,\n--   supporting decisions around customer retention, segmentation,\n--   and revenue concentration.\n--\n-- Grain:\n--   One row per customer\n--\n-- Business Questions Answered:\n--   - Who are the top customers by total revenue?\n--   - How many orders do top customers place?\n--   - Which customer segments generate the most value?\n--\n-- Source Models:\n--   - stg_orders\n--\n-- Notes:\n--   - Customers are ranked by total sales\n--   - Limited to the top 50 customers by revenue\n--   - Consumed directly by Metabase dashboards\n--\n-- ============================================================================\n\nSELECT\n    customer_name,\n    customer_segment,\n    region,\n    SUM(sales) AS total_sales,\n    COUNT(DISTINCT order_id) AS num_orders,\n    ROUND(AVG(profit), 2) AS avg_profit\nFROM \"postgres_metabase1\".\"_staging\".\"stg_orders\"\nGROUP BY 1, 2, 3\nORDER BY total_sales DESC\nLIMIT 50", "relation_name": "\"postgres_metabase1\".\"_analytics\".\"top_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T12:33:43.082072Z", "completed_at": "2026-01-20T12:33:43.105711Z"}, {"name": "execute", "started_at": "2026-01-20T12:33:43.138744Z", "completed_at": "2026-01-20T12:33:43.575417Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5794100761413574, "adapter_response": {"_message": "SELECT 8399", "code": "SELECT", "rows_affected": 8399}, "message": "SELECT 8399", "failures": null, "unique_id": "model.superstore_project.final_orders_with_returns", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- Model: final_orders_with_returns\n--\n-- Description:\n--   Core fact table combining order-level data with return status\n--   and regional manager information.\n--\n--   This model serves as the foundation for downstream analytical marts\n--   and is consumed directly by BI tools such as Metabase.\n--\n-- Grain:\n--   One row per order line (row_id from stg_orders)\n--\n-- Business Questions Answered:\n--   - Which orders were returned?\n--   - How do returns vary by region and manager?\n--   - How do returns impact sales and profit?\n--\n-- Source Models:\n--   - stg_orders\n--   - stg_returns\n--   - stg_users\n--\n-- Notes:\n--   - This is the primary fact table in the analytics layer\n--   - Downstream marts depend on this model\n--   - No filtering or aggregation is applied at this stage\n--\n-- ============================================================================\n\nWITH orders_with_returns AS (\n\n    SELECT\n        o.*,\n        r.status AS return_status,\n        u.manager AS region_manager\n    FROM \"postgres_metabase1\".\"_staging\".\"stg_orders\" o\n    LEFT JOIN \"postgres_metabase1\".\"_staging\".\"stg_returns\" r\n        ON o.order_id = r.order_id\n    LEFT JOIN \"postgres_metabase1\".\"_staging\".\"stg_users\" u\n        ON o.region = u.region\n)\n\nSELECT *\nFROM orders_with_returns", "relation_name": "\"postgres_metabase1\".\"_analytics\".\"final_orders_with_returns\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T12:33:43.699287Z", "completed_at": "2026-01-20T12:33:44.100180Z"}, {"name": "execute", "started_at": "2026-01-20T12:33:44.108646Z", "completed_at": "2026-01-20T12:33:44.797076Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.1356568336486816, "adapter_response": {"_message": "SELECT 4", "code": "SELECT", "rows_affected": 4}, "message": "SELECT 4", "failures": null, "unique_id": "model.superstore_project.mart_orders_summary_by_region", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- Model: mart_orders_summary_by_region\n--\n-- Description:\n--   This model provides an aggregated view of sales, profitability, and\n--   return behavior by sales region and regional manager.\n--\n--   It is designed for executive and management reporting and is used\n--   directly by Metabase dashboards.\n--\n-- Grain:\n--   One row per (region, region_manager)\n--\n-- Business Questions Answered:\n--   - Which regions generate the most sales and profit?\n--   - Which regions have the highest return rates?\n--   - How do regional managers compare in performance?\n--\n-- Source Models:\n--   - final_orders_with_returns\n--\n-- ============================================================================\n\nWITH region_summary AS (\n\n    SELECT\n        region,\n        region_manager,\n\n        -- Order metrics\n        COUNT(DISTINCT order_id) AS total_orders,\n        COUNT(\n            DISTINCT CASE\n                WHEN return_status = 'Returned' THEN order_id\n            END\n        ) AS returned_orders,\n\n        -- Return rate (%)\n        ROUND(\n            100.0\n            * COUNT(\n                DISTINCT CASE\n                    WHEN return_status = 'Returned' THEN order_id\n                END\n            )\n            / NULLIF(COUNT(DISTINCT order_id), 0),\n            2\n        ) AS return_rate_percent,\n\n        -- Financial metrics\n        SUM(sales) AS total_sales,\n        SUM(profit) AS total_profit,\n\n        -- Discount behavior\n        ROUND(AVG(discount), 4) AS avg_discount\n\n    FROM \"postgres_metabase1\".\"_analytics\".\"final_orders_with_returns\"\n\n    GROUP BY\n        region,\n        region_manager\n)\n\nSELECT *\nFROM region_summary", "relation_name": "\"postgres_metabase1\".\"_analytics\".\"mart_orders_summary_by_region\""}], "elapsed_time": 2.672927141189575, "args": {"log_level": "info", "send_anonymous_usage_stats": true, "quiet": false, "log_level_file": "debug", "write_json": true, "exclude": [], "vars": {}, "show_resource_report": false, "print": true, "warn_error_options": {"include": [], "exclude": []}, "use_colors_file": true, "populate_cache": true, "cache_selected_only": false, "introspect": true, "which": "run", "log_format_file": "debug", "log_path": "/usr/app/logs", "select": [], "use_colors": true, "partial_parse_file_diff": true, "enable_legacy_logger": false, "log_format": "default", "project_dir": "/usr/app", "favor_state": false, "static_parser": true, "version_check": true, "invocation_command": "dbt run", "log_file_max_bytes": 10485760, "profiles_dir": "/usr/app/profiles", "printer_width": 80, "indirect_selection": "eager", "strict_mode": false, "defer": false, "partial_parse": true, "macro_debugging": false}}